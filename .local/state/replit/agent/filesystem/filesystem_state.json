{"file_contents":{"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Project Architecture Summary\n\n## Overview\n\nThis is a full-stack construction takeoff application that allows users to upload building blueprints and automatically extract material quantities using AI. The app provides a web interface for managing construction projects, viewing drawings, and generating detailed takeoff reports for cost estimation.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **React SPA**: Built with React and TypeScript using Vite as the build tool\n- **UI Framework**: shadcn/ui components with Radix UI primitives and Tailwind CSS\n- **State Management**: TanStack Query for server state management\n- **Routing**: wouter for client-side routing\n- **Styling**: Tailwind CSS with custom CSS variables for theming\n\n### Backend Architecture\n- **Node.js/Express**: RESTful API server with TypeScript\n- **Development Server**: Vite middleware integration for development\n- **File Upload**: Multer for handling PDF and image uploads (up to 50MB)\n- **Storage**: PostgreSQL database with Drizzle ORM for persistent data storage\n\n### Database Design\n- **Database**: PostgreSQL with Neon Database serverless hosting\n- **ORM**: Drizzle ORM configured for PostgreSQL with proper relations\n- **Schema**: Well-defined tables for projects, drawings, takeoffs, and material costs\n- **Relations**: Explicit foreign key relationships between tables\n- **Migrations**: Managed through Drizzle Kit (`npm run db:push`)\n\n## Key Components\n\n### Core Entities\n1. **Projects**: Construction projects with basic metadata\n2. **Drawings**: Uploaded blueprint files (PDF, PNG, JPG) with processing status\n3. **Takeoffs**: Extracted material quantities from drawings\n4. **Material Costs**: Cost database for different construction materials\n\n### Frontend Components\n- **Dashboard**: Main application interface with project overview\n- **Project Sidebar**: Project and drawing navigation\n- **Drawing Viewer**: Interactive blueprint display with zoom/pan capabilities\n- **Takeoff Panel**: Material quantity results and cost calculations\n- **Upload Zone**: Drag-and-drop file upload with validation\n\n### API Endpoints\n- `/api/projects` - Project CRUD operations\n- `/api/projects/:id/drawings` - Drawing management\n- `/api/drawings/:id/takeoffs` - Takeoff data\n- `/api/material-costs` - Cost database access\n\n## Data Flow\n\n1. **Project Creation**: Users create construction projects\n2. **Drawing Upload**: Blueprint files uploaded and stored\n3. **AI Processing**: (Placeholder) Drawings processed to extract elements\n4. **Takeoff Generation**: Material quantities calculated and stored\n5. **Cost Calculation**: Quantities multiplied by material costs for estimates\n\n## External Dependencies\n\n### Frontend Libraries\n- React ecosystem (React, ReactDOM)\n- TanStack Query for data fetching\n- Radix UI for accessible components\n- Tailwind CSS for styling\n- date-fns for date manipulation\n\n### Backend Libraries\n- Express.js web framework\n- Drizzle ORM and Drizzle Kit\n- Multer for file uploads\n- Neon Database serverless PostgreSQL driver\n\n### Development Tools\n- Vite for build tooling and development server\n- TypeScript for type safety\n- ESBuild for production builds\n\n## Deployment Strategy\n\n### Build Process\n- Frontend: Vite builds React app to `dist/public`\n- Backend: ESBuild bundles server code to `dist/index.js`\n- Single artifact deployment with static file serving\n\n### Environment Configuration\n- PostgreSQL database via `DATABASE_URL` environment variable\n- Neon Database for serverless PostgreSQL hosting\n- File uploads stored in local `uploads` directory\n\n### Production Considerations\n- Express serves built React app in production\n- Database migrations handled through Drizzle Kit\n- File storage currently local (scalability consideration)\n\n### Recent Changes (August 2025)\n- **Fixed Drawing Viewer Display (September 1, 2025)**: Corrected drawing viewer to show actual uploaded floor plans instead of placeholder images, enabling users to view their uploaded blueprints properly\n- **Custom Logo Integration (August 26, 2025)**: Updated application branding with custom EstimAgent calculator-style logo, replaced generic icon with professional calculator design that reflects the application's estimation focus\n- **Database Integration**: Successfully migrated from in-memory storage to PostgreSQL with Drizzle ORM\n- **Navigation System**: Implemented functional navigation between Dashboard, Projects, and Reports pages\n- **Project Detail Pages**: Added individual project view/edit functionality with comprehensive project management\n- **Persistent Storage**: All project data, drawings, takeoffs, and material costs now persist in the database\n- **Settings Page**: Added comprehensive settings interface for user preferences, notifications, AI configuration, and security\n- **Sample Data**: Automatic initialization of sample construction data on first run\n- **Calculator Tool Removal**: Removed the calculator widget from the navigation header to improve UI spacing\n- **Takeoff Type Selection**: Added comprehensive takeoff type selector allowing users to choose specific building elements (doors, windows, flooring, walls, electrical, plumbing, HVAC, structural) for AI analysis\n- **Selective AI Analysis**: Implemented backend API for running takeoff analysis on specific element types rather than all elements at once\n- **Centered Navigation**: Moved main navigation items (Dashboard - Projects - Reports) to center of header for better visual balance\n- **Prominent AI Takeoff Button**: Added bright purple \"Run AI Takeoff\" button in dashboard toolbar for clear user workflow\n- **Enhanced Project Management**: Added \"Create Project\" buttons to both dashboard and projects pages for easier project creation\n- **Improved User Experience**: Clear visual hierarchy with separated project info section and drawing tools section in dashboard\n- **Streamlined Interface**: Removed header notifications and user profile elements for cleaner design\n- **Vertical Takeoff Selector**: Replaced left sidebar with vertical takeoff element selector and settings button\n- **AI Chat Widget**: Added floating AI assistant widget in top-right corner for construction questions\n- **Real-time Analysis Panel**: Replaced right panel with live progress tracking and detailed takeoff results\n- **Automatic File Processing**: Files now automatically process and start AI analysis when dropped in the floor plan area\n- **Default Element Selection**: System auto-selects common takeoff types (doors, windows, flooring, electrical) for immediate analysis\n- **Project Navigation Fix**: Resolved project detail navigation by making entire project cards clickable with proper event handling\n- **Comprehensive Project Detail Page**: Completed tabbed interface with Overview, Takeoffs, Drawings, and Saved Analyses sections\n- **Data Manipulation Features**: Added inline takeoff editing, analysis saving/deleting, CSV export, and cost calculations\n- **Database Schema Completion**: Successfully migrated all tables including savedAnalyses, takeoffs, and materialCosts with proper relations\n- **Project Deletion Fix**: Resolved critical bug where DELETE API responses (204 No Content) caused JSON parsing errors in frontend; implemented proper empty response handling\n- **Integrated Pricing Management**: Moved pricing and SKU management directly into project workflow rather than separate manager page\n- **Project-Level Pricing & SKUs**: Added Pricing and SKUs tabs to project detail pages for contextual management\n- **Comprehensive Catalog System**: Built complete trade classes, product SKUs, project pricing, and estimate templates database schema with full CRUD operations\n- **Sample Catalog Data**: Auto-initialized 8 trade classes (General Construction, Electrical, Plumbing, HVAC, Flooring, Windows & Doors, Roofing, Insulation) and 16 product SKUs with realistic pricing\n- **Workflow Integration**: Pricing and catalog management now accessible within project context instead of separate application\n- **Granular Takeoff Editing**: Enhanced manual control for quantities, costs, measurements (area/length) with visual indicators for AI vs manual values\n- **Batch Operations**: Added batch selection and editing capabilities for multiple takeoffs with efficient API endpoints\n- **Manual Override Tracking**: System tracks original AI values vs manual edits, allowing users to reset to AI suggestions or see change history\n- **Quick Quantity Adjustments**: Added +/- buttons for rapid quantity changes directly in takeoff list view\n- **Enhanced Visual Feedback**: Color-coded fields and badges show modified values, verified status, and AI detection indicators\n- **Professional PDF Reporting**: Complete PDF report generation system with company branding, executive summaries, detailed cost breakdowns, and comparison reports\n- **Advanced CSV Export**: Enhanced CSV exports with material/labor cost separation, original vs modified values, and comprehensive project metrics\n- **Visual Analytics Dashboard**: Interactive cost breakdown charts, progress tracking, and project quality metrics with Chart.js visualizations\n- **Progress Photo Documentation**: Photo upload and annotation system for project progress tracking with tagging and location metadata\n- **Multi-Format Report Generation**: Executive summaries for stakeholders, detailed cost reports for contractors, and comparison reports for change orders\n- **AI-Powered Cost Intelligence Backend (August 16, 2025)**: Implemented comprehensive intelligent cost analysis engine with project efficiency scoring, cost savings opportunity detection, and industry benchmark comparison. Backend provides actionable insights including efficiency ratings, cost category analysis, savings recommendations, and performance ranking against industry standards. System analyzes cost distribution, identifies optimization opportunities, and generates smart recommendations for bulk purchasing, material substitution, and value engineering.\n- **Advanced Risk Assessment & Predictive Analytics (August 17, 2025)**: Extended AI backend with sophisticated risk assessment capabilities analyzing cost overruns, budget concentration, market volatility, and quality risks. Added predictive cost modeling with 6-month trend forecasting including inflation factors, material volatility, and seasonal variations. System provides risk scores (low/medium/high/critical), probability assessments, mitigation strategies, and confidence-rated monthly projections for strategic planning and budget management.\n\n### Current Limitations\n- Local file storage (not suitable for distributed deployment)\n- AI processing logic not implemented (placeholder functions)\n- No authentication/authorization system\n\nThe architecture now provides persistent data storage with PostgreSQL while maintaining clear separation of concerns and preparation for production deployment (cloud storage, actual AI integration).","size_bytes":10993},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2627},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2066},"server/routes.ts":{"content":"import type { Express, Request } from \"express\";\nimport express from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { \n  insertProjectSchema, \n  insertDrawingSchema, \n  insertTakeoffSchema, \n  insertSavedAnalysisSchema,\n  insertTradeClassSchema,\n  insertProductSkuSchema,\n  insertProjectPricingSchema,\n  insertEstimateTemplateSchema,\n  insertRegionalCostDatabaseSchema,\n  insertSupplierSchema,\n  insertMaterialPricingSchema,\n  insertChangeOrderSchema,\n  insertProfitMarginSettingsSchema,\n  insertCostHistorySchema,\n  insertCostEscalationSchema\n} from \"@shared/schema\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\n\ninterface MulterRequest extends Request {\n  file?: Express.Multer.File;\n}\n\n// Configure multer for file uploads\nconst uploadDir = path.join(process.cwd(), \"uploads\");\nif (!fs.existsSync(uploadDir)) {\n  fs.mkdirSync(uploadDir, { recursive: true });\n}\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: uploadDir,\n    filename: (req, file, cb) => {\n      const uniqueId = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n      const ext = path.extname(file.originalname) || '.jpg'; // Default to .jpg if no extension\n      cb(null, uniqueId + ext);\n    }\n  }),\n  limits: {\n    fileSize: 50 * 1024 * 1024, // 50MB limit\n  },\n  fileFilter: (req: any, file: any, cb: any) => {\n    const allowedTypes = ['application/pdf', 'image/png', 'image/jpeg', 'image/jpg'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only PDF, PNG, and JPG files are allowed.'));\n    }\n  },\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Serve uploaded files with proper headers\n  app.use('/uploads', express.static(uploadDir, {\n    setHeaders: (res, path) => {\n      // Set proper content type based on file content\n      if (path.includes('pdf')) {\n        res.setHeader('Content-Type', 'application/pdf');\n      } else {\n        res.setHeader('Content-Type', 'image/jpeg'); // Default for images\n      }\n    }\n  }));\n  \n  // General file upload endpoint\n  app.post(\"/api/upload\", upload.single('file'), async (req: MulterRequest, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ message: \"No file uploaded\" });\n      }\n\n      const fileUrl = `/uploads/${req.file.filename}`;\n      res.json({ \n        fileUrl,\n        filename: req.file.originalname,\n        mimetype: req.file.mimetype,\n        size: req.file.size\n      });\n    } catch (error) {\n      console.error(\"File upload error:\", error);\n      res.status(500).json({ message: \"Failed to upload file\" });\n    }\n  });\n\n  // Projects routes\n  app.get(\"/api/projects\", async (req, res) => {\n    try {\n      const projects = await storage.getProjects();\n      res.json(projects);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch projects\" });\n    }\n  });\n\n  app.get(\"/api/projects/:id\", async (req, res) => {\n    try {\n      const project = await storage.getProject(req.params.id);\n      if (!project) {\n        return res.status(404).json({ message: \"Project not found\" });\n      }\n      res.json(project);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch project\" });\n    }\n  });\n\n  app.post(\"/api/projects\", async (req, res) => {\n    try {\n      const projectData = insertProjectSchema.parse(req.body);\n      const project = await storage.createProject(projectData);\n      res.status(201).json(project);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid project data\" });\n    }\n  });\n\n  app.patch(\"/api/projects/:id\", async (req, res) => {\n    try {\n      const updateData = insertProjectSchema.partial().parse(req.body);\n      const project = await storage.updateProject(req.params.id, updateData);\n      if (!project) {\n        return res.status(404).json({ message: \"Project not found\" });\n      }\n      res.json(project);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid project data\" });\n    }\n  });\n\n  app.delete(\"/api/projects/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteProject(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Project not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete project\" });\n    }\n  });\n\n  // Drawings routes\n  app.get(\"/api/projects/:projectId/drawings\", async (req, res) => {\n    try {\n      const drawings = await storage.getDrawingsByProject(req.params.projectId);\n      res.json(drawings);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch drawings\" });\n    }\n  });\n\n  app.get(\"/api/drawings/:id\", async (req, res) => {\n    try {\n      const drawing = await storage.getDrawing(req.params.id);\n      if (!drawing) {\n        return res.status(404).json({ message: \"Drawing not found\" });\n      }\n      res.json(drawing);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch drawing\" });\n    }\n  });\n\n  app.post(\"/api/projects/:projectId/drawings\", async (req, res) => {\n    try {\n      const drawingData = insertDrawingSchema.parse({\n        ...req.body,\n        projectId: req.params.projectId\n      });\n      const drawing = await storage.createDrawing(drawingData);\n      res.status(201).json(drawing);\n    } catch (error) {\n      console.error(\"Drawing creation error:\", error);\n      res.status(400).json({ message: \"Invalid drawing data\" });\n    }\n  });\n\n  app.post(\"/api/projects/:projectId/drawings/upload\", upload.single('file'), async (req: MulterRequest, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ message: \"No file uploaded\" });\n      }\n\n      const fileUrl = `/uploads/${req.file.filename}`;\n      const drawingData = {\n        projectId: req.params.projectId,\n        name: req.body.name || req.file.originalname,\n        filename: req.file.originalname,\n        fileUrl,\n        fileType: req.file.mimetype,\n        status: \"pending\",\n        scale: req.body.scale || \"1/4\\\" = 1'\",\n        aiProcessed: false,\n      };\n\n      const drawing = await storage.createDrawing(drawingData);\n      \n      // Simulate AI processing\n      setTimeout(async () => {\n        await storage.updateDrawing(drawing.id, {\n          status: \"processing\",\n        });\n        \n        // Simulate processing delay and then complete\n        setTimeout(async () => {\n          await storage.updateDrawing(drawing.id, {\n            status: \"complete\",\n            aiProcessed: true,\n          });\n          \n          // Generate mock takeoff data\n          await generateMockTakeoffs(drawing.id);\n        }, 5000); // 5 second processing simulation\n      }, 1000);\n\n      res.status(201).json(drawing);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to upload file\" });\n    }\n  });\n\n  // Takeoffs routes\n  app.get(\"/api/drawings/:drawingId/takeoffs\", async (req, res) => {\n    try {\n      const takeoffs = await storage.getTakeoffsByDrawing(req.params.drawingId);\n      res.json(takeoffs);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch takeoffs\" });\n    }\n  });\n\n  app.post(\"/api/takeoffs\", async (req, res) => {\n    try {\n      const takeoffData = insertTakeoffSchema.parse(req.body);\n      const takeoff = await storage.createTakeoff(takeoffData);\n      res.status(201).json(takeoff);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid takeoff data\" });\n    }\n  });\n\n  app.patch(\"/api/takeoffs/:id\", async (req, res) => {\n    try {\n      const takeoffData = insertTakeoffSchema.partial().parse(req.body);\n      const takeoff = await storage.updateTakeoff(req.params.id, takeoffData);\n      if (!takeoff) {\n        return res.status(404).json({ message: \"Takeoff not found\" });\n      }\n      res.json(takeoff);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid takeoff data\" });\n    }\n  });\n\n  app.delete(\"/api/takeoffs/:id\", async (req, res) => {\n    try {\n      const deleted = await storage.deleteTakeoff(req.params.id);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Takeoff not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete takeoff\" });\n    }\n  });\n\n  // Batch update takeoffs\n  app.patch(\"/api/takeoffs/batch\", async (req, res) => {\n    try {\n      const { takeoffIds, updates } = req.body;\n      if (!Array.isArray(takeoffIds) || !updates) {\n        return res.status(400).json({ message: \"Invalid batch update data\" });\n      }\n\n      const results = [];\n      for (const takeoffId of takeoffIds) {\n        const takeoff = await storage.updateTakeoff(takeoffId, updates);\n        if (takeoff) {\n          results.push(takeoff);\n        }\n      }\n      \n      res.json({ updatedCount: results.length, takeoffs: results });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to batch update takeoffs\" });\n    }\n  });\n\n  // Project-specific routes\n  app.get(\"/api/projects/:id/drawings\", async (req, res) => {\n    try {\n      const drawings = await storage.getDrawingsByProject(req.params.id);\n      res.json(drawings);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch project drawings\" });\n    }\n  });\n\n  app.get(\"/api/projects/:id/takeoffs\", async (req, res) => {\n    try {\n      const drawings = await storage.getDrawingsByProject(req.params.id);\n      let allTakeoffs: any[] = [];\n      for (const drawing of drawings) {\n        const takeoffs = await storage.getTakeoffsByDrawing(drawing.id);\n        allTakeoffs = allTakeoffs.concat(takeoffs);\n      }\n      res.json(allTakeoffs);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch project takeoffs\" });\n    }\n  });\n\n  app.get(\"/api/projects/:id/saved-analyses\", async (req, res) => {\n    try {\n      const analyses = await storage.getSavedAnalysesByProject(req.params.id);\n      res.json(analyses);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch saved analyses\" });\n    }\n  });\n\n  app.post(\"/api/projects/:id/save-analysis\", async (req, res) => {\n    try {\n      const analysisData = insertSavedAnalysisSchema.parse({\n        ...req.body,\n        projectId: req.params.id\n      });\n      const analysis = await storage.createSavedAnalysis(analysisData);\n      res.status(201).json(analysis);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid analysis data\" });\n    }\n  });\n\n  // Saved analysis routes\n  app.get(\"/api/saved-analyses/:id\", async (req, res) => {\n    try {\n      const analysis = await storage.getSavedAnalysis(req.params.id);\n      if (!analysis) {\n        return res.status(404).json({ message: \"Analysis not found\" });\n      }\n      res.json(analysis);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch analysis\" });\n    }\n  });\n\n  app.patch(\"/api/saved-analyses/:id\", async (req, res) => {\n    try {\n      const updateData = insertSavedAnalysisSchema.partial().parse(req.body);\n      const analysis = await storage.updateSavedAnalysis(req.params.id, updateData);\n      if (!analysis) {\n        return res.status(404).json({ message: \"Analysis not found\" });\n      }\n      res.json(analysis);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid analysis data\" });\n    }\n  });\n\n  app.delete(\"/api/saved-analyses/:id\", async (req, res) => {\n    try {\n      const deleted = await storage.deleteSavedAnalysis(req.params.id);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Analysis not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete analysis\" });\n    }\n  });\n\n  // Material costs routes\n  app.get(\"/api/material-costs\", async (req, res) => {\n    try {\n      const { category } = req.query;\n      const costs = category \n        ? await storage.getMaterialCostsByCategory(category as string)\n        : await storage.getMaterialCosts();\n      res.json(costs);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch material costs\" });\n    }\n  });\n\n  // AI Processing simulation\n  app.post(\"/api/drawings/:id/process\", async (req, res) => {\n    try {\n      const drawing = await storage.getDrawing(req.params.id);\n      if (!drawing) {\n        return res.status(404).json({ message: \"Drawing not found\" });\n      }\n\n      await storage.updateDrawing(req.params.id, {\n        status: \"processing\",\n      });\n\n      // Simulate AI processing\n      setTimeout(async () => {\n        await storage.updateDrawing(req.params.id, {\n          status: \"complete\",\n          aiProcessed: true,\n        });\n        \n        await generateMockTakeoffs(req.params.id);\n      }, 3000);\n\n      res.json({ message: \"AI processing started\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to start AI processing\" });\n    }\n  });\n\n  // Run selective takeoff\n  app.post(\"/api/drawings/:id/run-takeoff\", async (req, res) => {\n    try {\n      const drawing = await storage.getDrawing(req.params.id);\n      if (!drawing) {\n        return res.status(404).json({ message: \"Drawing not found\" });\n      }\n\n      const { elementTypes } = req.body;\n      if (!elementTypes || !Array.isArray(elementTypes)) {\n        return res.status(400).json({ message: \"elementTypes array is required\" });\n      }\n\n      await storage.updateDrawing(req.params.id, {\n        status: \"processing\",\n      });\n\n      // Simulate AI processing with selective takeoffs\n      setTimeout(async () => {\n        await storage.updateDrawing(req.params.id, {\n          status: \"complete\",\n          aiProcessed: true,\n        });\n        \n        await generateSelectiveMockTakeoffs(req.params.id, elementTypes);\n      }, 2000);\n\n      res.json({ message: \"Selective takeoff analysis started\", elementTypes });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to start takeoff analysis\" });\n    }\n  });\n\n  // Enhanced LLM-powered takeoff analysis\n  app.post(\"/api/drawings/:id/run-llm-takeoff\", async (req, res) => {\n    try {\n      const drawing = await storage.getDrawing(req.params.id);\n      if (!drawing) {\n        return res.status(404).json({ message: \"Drawing not found\" });\n      }\n\n      const { elementTypes, llmModel, enhancedAnalysis } = req.body;\n      if (!elementTypes || !Array.isArray(elementTypes)) {\n        return res.status(400).json({ message: \"elementTypes array is required\" });\n      }\n\n      await storage.updateDrawing(req.params.id, {\n        status: \"processing\",\n        aiProcessed: false,\n      });\n\n      // Simulate enhanced LLM processing\n      setTimeout(async () => {\n        await storage.updateDrawing(req.params.id, {\n          status: \"complete\",\n          aiProcessed: true,\n        });\n        \n        // Generate more detailed takeoffs with LLM processing\n        await generateEnhancedLLMTakeoffs(req.params.id, elementTypes);\n      }, 5000); // Longer processing time for LLM\n\n      res.json({ \n        message: \"LLM takeoff analysis started\", \n        elementTypes,\n        llmModel: llmModel || \"floorplan-analyzer-v2\",\n        estimatedTime: \"3-5 minutes\",\n        elementsProcessed: elementTypes.length * Math.floor(Math.random() * 5 + 3),\n        averageConfidence: Math.random() * 0.2 + 0.85\n      });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to start LLM analysis\" });\n    }\n  });\n\n  // Reprocess individual takeoff with enhanced accuracy\n  app.post(\"/api/takeoffs/:id/reprocess\", async (req, res) => {\n    try {\n      const { useAdvancedLLM, recalculateCosts } = req.body;\n      \n      // Simulate reprocessing with enhanced accuracy\n      setTimeout(async () => {\n        // In a real implementation, this would:\n        // 1. Re-analyze the specific element with advanced LLM\n        // 2. Update coordinates and dimensions\n        // 3. Recalculate costs with current material prices\n        // 4. Improve confidence scores\n      }, 2000);\n\n      res.json({ \n        message: \"Takeoff reprocessing started\",\n        useAdvancedLLM,\n        recalculateCosts,\n        estimatedTime: \"30-60 seconds\"\n      });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to reprocess takeoff\" });\n    }\n  });\n\n  // Trade Classes routes\n  app.get(\"/api/trade-classes\", async (req, res) => {\n    try {\n      const tradeClasses = await storage.getTradeClasses();\n      res.json(tradeClasses);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch trade classes\" });\n    }\n  });\n\n  app.get(\"/api/trade-classes/:id\", async (req, res) => {\n    try {\n      const tradeClass = await storage.getTradeClass(req.params.id);\n      if (!tradeClass) {\n        return res.status(404).json({ message: \"Trade class not found\" });\n      }\n      res.json(tradeClass);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch trade class\" });\n    }\n  });\n\n  app.post(\"/api/trade-classes\", async (req, res) => {\n    try {\n      const tradeClassData = insertTradeClassSchema.parse(req.body);\n      const tradeClass = await storage.createTradeClass(tradeClassData);\n      res.status(201).json(tradeClass);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid trade class data\" });\n    }\n  });\n\n  app.patch(\"/api/trade-classes/:id\", async (req, res) => {\n    try {\n      const updateData = insertTradeClassSchema.partial().parse(req.body);\n      const tradeClass = await storage.updateTradeClass(req.params.id, updateData);\n      if (!tradeClass) {\n        return res.status(404).json({ message: \"Trade class not found\" });\n      }\n      res.json(tradeClass);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid trade class data\" });\n    }\n  });\n\n  app.delete(\"/api/trade-classes/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteTradeClass(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Trade class not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete trade class\" });\n    }\n  });\n\n  // Product SKUs routes\n  app.get(\"/api/product-skus\", async (req, res) => {\n    try {\n      const { trade_class_id, search } = req.query;\n      \n      if (search) {\n        const skus = await storage.searchProductSkus(search as string, trade_class_id as string);\n        res.json(skus);\n      } else if (trade_class_id) {\n        const skus = await storage.getProductSkusByTradeClass(trade_class_id as string);\n        res.json(skus);\n      } else {\n        const skus = await storage.getProductSkus();\n        res.json(skus);\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch product SKUs\" });\n    }\n  });\n\n  app.get(\"/api/product-skus/:id\", async (req, res) => {\n    try {\n      const sku = await storage.getProductSku(req.params.id);\n      if (!sku) {\n        return res.status(404).json({ message: \"Product SKU not found\" });\n      }\n      res.json(sku);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch product SKU\" });\n    }\n  });\n\n  app.post(\"/api/product-skus\", async (req, res) => {\n    try {\n      const skuData = insertProductSkuSchema.parse(req.body);\n      const sku = await storage.createProductSku(skuData);\n      res.status(201).json(sku);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid product SKU data\" });\n    }\n  });\n\n  app.patch(\"/api/product-skus/:id\", async (req, res) => {\n    try {\n      const updateData = insertProductSkuSchema.partial().parse(req.body);\n      const sku = await storage.updateProductSku(req.params.id, updateData);\n      if (!sku) {\n        return res.status(404).json({ message: \"Product SKU not found\" });\n      }\n      res.json(sku);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid product SKU data\" });\n    }\n  });\n\n  app.delete(\"/api/product-skus/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteProductSku(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Product SKU not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete product SKU\" });\n    }\n  });\n\n  // Project Pricing routes\n  app.get(\"/api/projects/:projectId/pricing\", async (req, res) => {\n    try {\n      const pricing = await storage.getProjectPricing(req.params.projectId);\n      res.json(pricing);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch project pricing\" });\n    }\n  });\n\n  app.post(\"/api/projects/:projectId/pricing\", async (req, res) => {\n    try {\n      const pricingData = insertProjectPricingSchema.parse({\n        ...req.body,\n        projectId: req.params.projectId\n      });\n      const pricing = await storage.createProjectPricing(pricingData);\n      res.status(201).json(pricing);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid project pricing data\" });\n    }\n  });\n\n  app.patch(\"/api/project-pricing/:id\", async (req, res) => {\n    try {\n      const updateData = insertProjectPricingSchema.partial().parse(req.body);\n      const pricing = await storage.updateProjectPricing(req.params.id, updateData);\n      if (!pricing) {\n        return res.status(404).json({ message: \"Project pricing item not found\" });\n      }\n      res.json(pricing);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid project pricing data\" });\n    }\n  });\n\n  app.delete(\"/api/project-pricing/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteProjectPricing(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Project pricing item not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete project pricing item\" });\n    }\n  });\n\n  // Estimate Templates routes\n  app.get(\"/api/estimate-templates\", async (req, res) => {\n    try {\n      const { trade_class_id } = req.query;\n      \n      if (trade_class_id) {\n        const templates = await storage.getEstimateTemplatesByTradeClass(trade_class_id as string);\n        res.json(templates);\n      } else {\n        const templates = await storage.getEstimateTemplates();\n        res.json(templates);\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch estimate templates\" });\n    }\n  });\n\n  app.get(\"/api/estimate-templates/:id\", async (req, res) => {\n    try {\n      const template = await storage.getEstimateTemplate(req.params.id);\n      if (!template) {\n        return res.status(404).json({ message: \"Estimate template not found\" });\n      }\n      res.json(template);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch estimate template\" });\n    }\n  });\n\n  app.post(\"/api/estimate-templates\", async (req, res) => {\n    try {\n      const templateData = insertEstimateTemplateSchema.parse(req.body);\n      const template = await storage.createEstimateTemplate(templateData);\n      res.status(201).json(template);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid estimate template data\" });\n    }\n  });\n\n  app.patch(\"/api/estimate-templates/:id\", async (req, res) => {\n    try {\n      const updateData = insertEstimateTemplateSchema.partial().parse(req.body);\n      const template = await storage.updateEstimateTemplate(req.params.id, updateData);\n      if (!template) {\n        return res.status(404).json({ message: \"Estimate template not found\" });\n      }\n      res.json(template);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid estimate template data\" });\n    }\n  });\n\n  app.delete(\"/api/estimate-templates/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteEstimateTemplate(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Estimate template not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete estimate template\" });\n    }\n  });\n\n\n\n  // Regional Cost Database routes\n  app.get(\"/api/regional-costs\", async (req, res) => {\n    try {\n      const { region, state, zipCode } = req.query;\n      let regionalCosts;\n      \n      if (region || state || zipCode) {\n        regionalCosts = await storage.getRegionalCostDataByLocation(\n          region as string,\n          state as string, \n          zipCode as string\n        );\n      } else {\n        regionalCosts = await storage.getRegionalCostData();\n      }\n      \n      res.json(regionalCosts);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch regional cost data\" });\n    }\n  });\n\n  app.post(\"/api/regional-costs\", async (req, res) => {\n    try {\n      const validatedData = insertRegionalCostDatabaseSchema.parse(req.body);\n      const regionalCost = await storage.createRegionalCostData(validatedData);\n      res.status(201).json(regionalCost);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid regional cost data\" });\n    }\n  });\n\n  // Supplier Management routes\n  app.get(\"/api/suppliers\", async (req, res) => {\n    try {\n      const { specialty } = req.query;\n      let suppliers;\n      \n      if (specialty) {\n        suppliers = await storage.getSuppliersBySpecialty(specialty as string);\n      } else {\n        suppliers = await storage.getSuppliers();\n      }\n      \n      res.json(suppliers);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch suppliers\" });\n    }\n  });\n\n  app.post(\"/api/suppliers\", async (req, res) => {\n    try {\n      const validatedData = insertSupplierSchema.parse(req.body);\n      const supplier = await storage.createSupplier(validatedData);\n      res.status(201).json(supplier);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid supplier data\" });\n    }\n  });\n\n  // Material Pricing routes\n  app.get(\"/api/material-pricing\", async (req, res) => {\n    try {\n      const { skuId, supplierId } = req.query;\n      let pricing;\n      \n      if (skuId) {\n        pricing = await storage.getMaterialPricingBySku(skuId as string);\n      } else if (supplierId) {\n        pricing = await storage.getMaterialPricingBySupplier(supplierId as string);\n      } else {\n        pricing = await storage.getMaterialPricing();\n      }\n      \n      res.json(pricing);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch material pricing\" });\n    }\n  });\n\n  app.post(\"/api/material-pricing\", async (req, res) => {\n    try {\n      const validatedData = insertMaterialPricingSchema.parse(req.body);\n      const pricing = await storage.createMaterialPricing(validatedData);\n      res.status(201).json(pricing);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid material pricing data\" });\n    }\n  });\n\n  // Change Order routes\n  app.get(\"/api/change-orders\", async (req, res) => {\n    try {\n      const { projectId } = req.query;\n      let changeOrders;\n      \n      if (projectId) {\n        changeOrders = await storage.getChangeOrdersByProject(projectId as string);\n      } else {\n        changeOrders = await storage.getChangeOrders();\n      }\n      \n      res.json(changeOrders);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch change orders\" });\n    }\n  });\n\n  app.post(\"/api/change-orders\", async (req, res) => {\n    try {\n      const validatedData = insertChangeOrderSchema.parse(req.body);\n      const changeOrder = await storage.createChangeOrder(validatedData);\n      res.status(201).json(changeOrder);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid change order data\" });\n    }\n  });\n\n  // Profit Margin Settings routes\n  app.get(\"/api/profit-margins\", async (req, res) => {\n    try {\n      const { scope, scopeId } = req.query;\n      let settings;\n      \n      if (scope) {\n        settings = await storage.getProfitMarginSettingsByScope(scope as string, scopeId as string);\n      } else {\n        settings = await storage.getProfitMarginSettings();\n      }\n      \n      res.json(settings);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch profit margin settings\" });\n    }\n  });\n\n  app.post(\"/api/profit-margins\", async (req, res) => {\n    try {\n      const validatedData = insertProfitMarginSettingsSchema.parse(req.body);\n      const settings = await storage.createProfitMarginSettings(validatedData);\n      res.status(201).json(settings);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid profit margin settings\" });\n    }\n  });\n\n  // Cost History routes\n  app.get(\"/api/cost-history\", async (req, res) => {\n    try {\n      const { skuId, days } = req.query;\n      let history;\n      \n      if (skuId && days) {\n        history = await storage.getCostTrend(skuId as string, parseInt(days as string));\n      } else if (skuId) {\n        history = await storage.getCostHistoryBySku(skuId as string);\n      } else {\n        history = await storage.getCostHistory();\n      }\n      \n      res.json(history);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch cost history\" });\n    }\n  });\n\n  app.post(\"/api/cost-history\", async (req, res) => {\n    try {\n      const validatedData = insertCostHistorySchema.parse(req.body);\n      const history = await storage.createCostHistory(validatedData);\n      res.status(201).json(history);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid cost history data\" });\n    }\n  });\n\n  // Cost Escalation routes\n  app.get(\"/api/cost-escalation\", async (req, res) => {\n    try {\n      const { projectId, activeOnly } = req.query;\n      let escalation;\n      \n      if (projectId && activeOnly === 'true') {\n        escalation = await storage.getActiveCostEscalation(projectId as string);\n      } else if (projectId) {\n        escalation = await storage.getCostEscalationByProject(projectId as string);\n      } else {\n        escalation = await storage.getCostEscalation();\n      }\n      \n      res.json(escalation);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch cost escalation\" });\n    }\n  });\n\n  app.post(\"/api/cost-escalation\", async (req, res) => {\n    try {\n      const validatedData = insertCostEscalationSchema.parse(req.body);\n      const escalation = await storage.createCostEscalation(validatedData);\n      res.status(201).json(escalation);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid cost escalation data\" });\n    }\n  });\n\n  // Smart Cost Analysis API Routes\n  app.get(\"/api/projects/:projectId/cost-analysis\", async (req, res) => {\n    try {\n      const { projectId } = req.params;\n      const analysis = await storage.analyzeProjectCostEfficiency(projectId);\n      res.json(analysis);\n    } catch (error) {\n      console.error(\"Error analyzing project costs:\", error);\n      res.status(500).json({ message: \"Failed to analyze project costs\" });\n    }\n  });\n\n  app.get(\"/api/projects/:projectId/cost-savings\", async (req, res) => {\n    try {\n      const { projectId } = req.params;\n      const savings = await storage.findCostSavingOpportunities(projectId);\n      res.json(savings);\n    } catch (error) {\n      console.error(\"Error finding cost savings:\", error);\n      res.status(500).json({ message: \"Failed to find cost savings opportunities\" });\n    }\n  });\n\n  app.get(\"/api/projects/:projectId/cost-benchmark\", async (req, res) => {\n    try {\n      const { projectId } = req.params;\n      const benchmark = await storage.generateCostBenchmarkReport(projectId);\n      res.json(benchmark);\n    } catch (error) {\n      console.error(\"Error generating cost benchmark:\", error);\n      res.status(500).json({ message: \"Failed to generate cost benchmark report\" });\n    }\n  });\n\n  app.get(\"/api/projects/:projectId/risk-assessment\", async (req, res) => {\n    try {\n      const { projectId } = req.params;\n      const riskAssessment = await storage.generateProjectRiskAssessment(projectId);\n      res.json(riskAssessment);\n    } catch (error) {\n      console.error(\"Error generating risk assessment:\", error);\n      res.status(500).json({ message: \"Failed to generate risk assessment\" });\n    }\n  });\n\n  app.get(\"/api/projects/:projectId/cost-trends\", async (req, res) => {\n    try {\n      const { projectId } = req.params;\n      const months = parseInt(req.query.months as string) || 6;\n      const trends = await storage.predictProjectCostTrends(projectId, months);\n      res.json(trends);\n    } catch (error) {\n      console.error(\"Error predicting cost trends:\", error);\n      res.status(500).json({ message: \"Failed to predict cost trends\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n\n// Helper function to generate selective mock takeoff data\nasync function generateEnhancedLLMTakeoffs(drawingId: string, elementTypes: string[]) {\n  // Enhanced LLM-based takeoff generation with higher accuracy and detail\n  const enhancedTakeoffData: Record<string, any[]> = {\n    doors: [\n      {\n        elementType: \"doors\",\n        elementName: \"Entry Door - 36\\\" x 80\\\" Mahogany\",\n        itemType: \"Entry Door\",\n        quantity: 1,\n        width: 36,\n        height: 80,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 850,\n        totalCost: 850,\n        coordinates: { x: 120, y: 150, confidence: 0.94 },\n      },\n      {\n        elementType: \"doors\",\n        elementName: \"Interior Door - 32\\\" x 80\\\" Hollow Core\",\n        itemType: \"Interior Door\",\n        quantity: 4,\n        width: 32,\n        height: 80,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 285,\n        totalCost: 1140,\n        coordinates: { x: 200, y: 250, confidence: 0.91 },\n      }\n    ],\n    windows: [\n      {\n        elementType: \"windows\",\n        elementName: \"Double Hung Window - 48\\\" x 60\\\" Vinyl\",\n        itemType: \"Double Hung Window\",\n        quantity: 6,\n        width: 48,\n        height: 60,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 485,\n        totalCost: 2910,\n        coordinates: { x: 300, y: 100, confidence: 0.89 },\n      },\n      {\n        elementType: \"windows\",\n        elementName: \"Picture Window - 72\\\" x 48\\\" Fixed\",\n        itemType: \"Picture Window\",\n        quantity: 2,\n        width: 72,\n        height: 48,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 720,\n        totalCost: 1440,\n        coordinates: { x: 350, y: 120, confidence: 0.93 },\n      }\n    ],\n    flooring: [\n      {\n        elementType: \"flooring\",\n        elementName: \"Oak Hardwood Flooring - 3/4\\\" Solid\",\n        itemType: \"Hardwood\",\n        quantity: 2100,\n        area: 2100,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 16.5,\n        totalCost: 34650,\n        coordinates: { x: 400, y: 300, confidence: 0.96 },\n      },\n      {\n        elementType: \"flooring\",\n        elementName: \"Porcelain Tile - 12\\\"x24\\\" Rectified\",\n        itemType: \"Tile\",\n        quantity: 850,\n        area: 850,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 14.25,\n        totalCost: 12112.5,\n        coordinates: { x: 450, y: 350, confidence: 0.92 },\n      }\n    ],\n    walls: [\n      {\n        elementType: \"walls\",\n        elementName: \"Interior Walls - 1/2\\\" Drywall\",\n        itemType: \"Drywall\",\n        quantity: 2640,\n        area: 2640,\n        length: 264,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 4.25,\n        totalCost: 11220,\n        coordinates: { x: 100, y: 500, confidence: 0.88 },\n      }\n    ],\n    electrical: [\n      {\n        elementType: \"electrical\",\n        elementName: \"GFCI Outlets - 20A Residential\",\n        itemType: \"GFCI Outlet\",\n        quantity: 18,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 95,\n        totalCost: 1710,\n        coordinates: { x: 150, y: 400, confidence: 0.87 },\n      },\n      {\n        elementType: \"electrical\",\n        elementName: \"LED Recessed Lights - 6\\\" IC Rated\",\n        itemType: \"Recessed Light\",\n        quantity: 22,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 125,\n        totalCost: 2750,\n        coordinates: { x: 250, y: 200, confidence: 0.90 },\n      }\n    ],\n    plumbing: [\n      {\n        elementType: \"plumbing\",\n        elementName: \"Kitchen Sink - Undermount Stainless\",\n        itemType: \"Kitchen Sink\",\n        quantity: 1,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 485,\n        totalCost: 485,\n        coordinates: { x: 180, y: 320, confidence: 0.95 },\n      },\n      {\n        elementType: \"plumbing\",\n        elementName: \"Bathroom Vanity Sink - Ceramic\",\n        itemType: \"Vanity Sink\",\n        quantity: 3,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 285,\n        totalCost: 855,\n        coordinates: { x: 220, y: 380, confidence: 0.88 },\n      }\n    ],\n    hvac: [\n      {\n        elementType: \"hvac\",\n        elementName: \"Central Air Return - 20\\\"x25\\\"\",\n        itemType: \"Air Return\",\n        quantity: 3,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 145,\n        totalCost: 435,\n        coordinates: { x: 160, y: 280, confidence: 0.86 },\n      }\n    ],\n    structural: [\n      {\n        elementType: \"structural\",\n        elementName: \"Load Bearing Beam - LVL 11-7/8\\\"\",\n        itemType: \"LVL Beam\",\n        quantity: 4,\n        length: 16,\n        unit: \"linear ft\",\n        detectedByAi: true,\n        costPerUnit: 28.5,\n        totalCost: 1824,\n        coordinates: { x: 300, y: 450, confidence: 0.91 },\n      }\n    ]\n  };\n\n  // Create takeoffs for requested element types\n  for (const elementType of elementTypes) {\n    if (enhancedTakeoffData[elementType]) {\n      for (const takeoffData of enhancedTakeoffData[elementType]) {\n        await storage.createTakeoff({\n          drawingId,\n          ...takeoffData,\n        });\n      }\n    }\n  }\n}\n\nasync function generateSelectiveMockTakeoffs(drawingId: string, elementTypes: string[]) {\n  const takeoffTemplates = {\n    doors: [\n      {\n        elementType: \"doors\",\n        elementName: \"Interior Door - 36\\\" x 80\\\"\",\n        itemType: \"Interior Door\",\n        quantity: 5,\n        width: 36,\n        height: 80,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 330,\n        totalCost: 1650,\n        coordinates: { x: 100, y: 150 },\n      },\n      {\n        elementType: \"doors\",\n        elementName: \"Interior Door - 32\\\" x 80\\\"\",\n        itemType: \"Interior Door\",\n        quantity: 2,\n        width: 32,\n        height: 80,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 310,\n        totalCost: 620,\n        coordinates: { x: 200, y: 250 },\n      }\n    ],\n    windows: [\n      {\n        elementType: \"windows\",\n        elementName: \"Double Hung Window - 48\\\" x 60\\\"\",\n        itemType: \"Double Hung Window\",\n        quantity: 8,\n        width: 48,\n        height: 60,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 550,\n        totalCost: 4400,\n        coordinates: { x: 300, y: 100 },\n      }\n    ],\n    flooring: [\n      {\n        elementType: \"flooring\",\n        elementName: \"Hardwood Flooring\",\n        itemType: \"Hardwood\",\n        quantity: 1845,\n        area: 1845,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 14.5,\n        totalCost: 26752.5,\n        coordinates: { x: 400, y: 300 },\n      },\n      {\n        elementType: \"flooring\",\n        elementName: \"Ceramic Tile\",\n        itemType: \"Tile\",\n        quantity: 632,\n        area: 632,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 12.0,\n        totalCost: 7584,\n        coordinates: { x: 450, y: 350 },\n      }\n    ],\n    walls: [\n      {\n        elementType: \"walls\",\n        elementName: \"Interior Walls\",\n        itemType: \"Drywall\",\n        quantity: 2400,\n        area: 2400,\n        length: 240,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 3.5,\n        totalCost: 8400,\n        coordinates: { x: 100, y: 500 },\n      }\n    ],\n    electrical: [\n      {\n        elementType: \"electrical\",\n        elementName: \"Electrical Outlets\",\n        itemType: \"Outlet\",\n        quantity: 24,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 85,\n        totalCost: 2040,\n        coordinates: { x: 150, y: 400 },\n      },\n      {\n        elementType: \"electrical\",\n        elementName: \"Light Fixtures\",\n        itemType: \"Light Fixture\",\n        quantity: 16,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 150,\n        totalCost: 2400,\n        coordinates: { x: 250, y: 200 },\n      }\n    ],\n    plumbing: [\n      {\n        elementType: \"plumbing\",\n        elementName: \"Plumbing Fixtures\",\n        itemType: \"Fixture\",\n        quantity: 8,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 250,\n        totalCost: 2000,\n        coordinates: { x: 500, y: 300 },\n      }\n    ],\n    hvac: [\n      {\n        elementType: \"hvac\",\n        elementName: \"HVAC System\",\n        itemType: \"System\",\n        quantity: 1,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 8500,\n        totalCost: 8500,\n        coordinates: { x: 400, y: 50 },\n      }\n    ],\n    structural: [\n      {\n        elementType: \"structural\",\n        elementName: \"Support Beams\",\n        itemType: \"Beam\",\n        quantity: 12,\n        length: 20,\n        unit: \"linear ft\",\n        detectedByAi: true,\n        costPerUnit: 45,\n        totalCost: 10800,\n        coordinates: { x: 300, y: 600 },\n      }\n    ]\n  };\n\n  const takeoffsToCreate = [];\n  for (const elementType of elementTypes) {\n    const templates = takeoffTemplates[elementType as keyof typeof takeoffTemplates];\n    if (templates) {\n      takeoffsToCreate.push(...templates.map(template => ({\n        ...template,\n        drawingId\n      })));\n    }\n  }\n\n  for (const takeoff of takeoffsToCreate) {\n    await storage.createTakeoff(takeoff);\n  }\n}\n\n// Helper function to generate mock takeoff data\nasync function generateMockTakeoffs(drawingId: string) {\n  const mockTakeoffs = [\n    {\n      drawingId,\n      elementType: \"doors\",\n      elementName: \"Interior Door (36\\\")\",\n      itemType: \"Interior Door\",\n      quantity: 5,\n      unit: \"each\",\n      detectedByAi: true,\n      costPerUnit: 330,\n      totalCost: 1650,\n      coordinates: { x: 100, y: 150 },\n    },\n    {\n      drawingId,\n      elementType: \"doors\",\n      elementName: \"Interior Door (32\\\")\",\n      itemType: \"Interior Door\",\n      quantity: 2,\n      unit: \"each\",\n      detectedByAi: true,\n      costPerUnit: 310,\n      totalCost: 620,\n      coordinates: { x: 200, y: 250 },\n    },\n    {\n      drawingId,\n      elementType: \"windows\",\n      elementName: \"Double Hung Window (3'x4')\",\n      itemType: \"Double Hung Window\",\n      quantity: 8,\n      unit: \"each\",\n      detectedByAi: true,\n      costPerUnit: 550,\n      totalCost: 4400,\n      coordinates: { x: 300, y: 100 },\n    },\n    {\n      drawingId,\n      elementType: \"flooring\",\n      elementName: \"Hardwood\",\n      itemType: \"Hardwood Flooring\",\n      area: 1845,\n      unit: \"sq ft\",\n      detectedByAi: true,\n      costPerUnit: 14.5,\n      totalCost: 26752.5,\n      coordinates: { x: 400, y: 300 },\n    },\n    {\n      drawingId,\n      elementType: \"flooring\",\n      elementName: \"Tile\",\n      itemType: \"Ceramic Tile\",\n      area: 632,\n      unit: \"sq ft\",\n      detectedByAi: true,\n      costPerUnit: 12.0,\n      totalCost: 7584,\n      coordinates: { x: 450, y: 350 },\n    },\n    {\n      drawingId,\n      elementType: \"electrical\",\n      elementName: \"Outlets\",\n      itemType: \"Electrical Outlet\",\n      quantity: 24,\n      unit: \"each\",\n      detectedByAi: true,\n      costPerUnit: 85,\n      totalCost: 2040,\n      coordinates: { x: 150, y: 400 },\n    },\n    {\n      drawingId,\n      elementType: \"electrical\",\n      elementName: \"Light Fixtures\",\n      itemType: \"Light Fixture\",\n      quantity: 16,\n      unit: \"each\",\n      detectedByAi: true,\n      costPerUnit: 150,\n      totalCost: 2400,\n      coordinates: { x: 250, y: 200 },\n    },\n  ];\n\n  for (const takeoff of mockTakeoffs) {\n    await storage.createTakeoff(takeoff);\n  }\n}\n","size_bytes":44474},"server/storage.ts":{"content":"import { eq, sql } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport { \n  projects, \n  drawings, \n  takeoffs, \n  materialCosts,\n  savedAnalyses,\n  tradeClasses,\n  productSkus,\n  projectPricing,\n  estimateTemplates,\n  regionalCostDatabase,\n  suppliers,\n  materialPricing,\n  changeOrders,\n  profitMarginSettings,\n  costHistory,\n  costEscalation\n} from \"@shared/schema\";\nimport { \n  type Project, type InsertProject, \n  type Drawing, type InsertDrawing, \n  type Takeoff, type InsertTakeoff, \n  type MaterialCost, type InsertMaterialCost, \n  type SavedAnalysis, type InsertSavedAnalysis,\n  type TradeClass, type InsertTradeClass,\n  type ProductSku, type InsertProductSku,\n  type ProjectPricing, type InsertProjectPricing,\n  type EstimateTemplate, type InsertEstimateTemplate,\n  type RegionalCostDatabase, type InsertRegionalCostDatabase,\n  type Supplier, type InsertSupplier,\n  type MaterialPricing, type InsertMaterialPricing,\n  type ChangeOrder, type InsertChangeOrder,\n  type ProfitMarginSettings, type InsertProfitMarginSettings,\n  type CostHistory, type InsertCostHistory,\n  type CostEscalation, type InsertCostEscalation\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // Projects\n  getProject(id: string): Promise<Project | undefined>;\n  getProjects(): Promise<Project[]>;\n  createProject(project: InsertProject): Promise<Project>;\n  updateProject(id: string, project: Partial<InsertProject>): Promise<Project | undefined>;\n  deleteProject(id: string): Promise<boolean>;\n  \n  // Drawings\n  getDrawing(id: string): Promise<Drawing | undefined>;\n  getDrawingsByProject(projectId: string): Promise<Drawing[]>;\n  createDrawing(drawing: InsertDrawing): Promise<Drawing>;\n  updateDrawing(id: string, drawing: Partial<InsertDrawing>): Promise<Drawing | undefined>;\n  \n  // Takeoffs\n  getTakeoff(id: string): Promise<Takeoff | undefined>;\n  getTakeoffsByDrawing(drawingId: string): Promise<Takeoff[]>;\n  createTakeoff(takeoff: InsertTakeoff): Promise<Takeoff>;\n  updateTakeoff(id: string, takeoff: Partial<InsertTakeoff>): Promise<Takeoff | undefined>;\n  deleteTakeoff(id: string): Promise<boolean>;\n  \n  // Material Costs\n  getMaterialCosts(): Promise<MaterialCost[]>;\n  getMaterialCostsByCategory(category: string): Promise<MaterialCost[]>;\n  createMaterialCost(cost: InsertMaterialCost): Promise<MaterialCost>;\n  \n  // Saved Analyses\n  getSavedAnalysis(id: string): Promise<SavedAnalysis | undefined>;\n  getSavedAnalysesByProject(projectId: string): Promise<SavedAnalysis[]>;\n  createSavedAnalysis(analysis: InsertSavedAnalysis): Promise<SavedAnalysis>;\n  updateSavedAnalysis(id: string, analysis: Partial<InsertSavedAnalysis>): Promise<SavedAnalysis | undefined>;\n  deleteSavedAnalysis(id: string): Promise<boolean>;\n\n  // Trade Classes\n  getTradeClasses(): Promise<TradeClass[]>;\n  getTradeClass(id: string): Promise<TradeClass | undefined>;\n  createTradeClass(tradeClass: InsertTradeClass): Promise<TradeClass>;\n  updateTradeClass(id: string, tradeClass: Partial<InsertTradeClass>): Promise<TradeClass | undefined>;\n  deleteTradeClass(id: string): Promise<boolean>;\n\n  // Product SKUs\n  getProductSkus(): Promise<ProductSku[]>;\n  getProductSkusByTradeClass(tradeClassId: string): Promise<ProductSku[]>;\n  getProductSku(id: string): Promise<ProductSku | undefined>;\n  searchProductSkus(query: string, tradeClassId?: string): Promise<ProductSku[]>;\n  createProductSku(sku: InsertProductSku): Promise<ProductSku>;\n  updateProductSku(id: string, sku: Partial<InsertProductSku>): Promise<ProductSku | undefined>;\n  deleteProductSku(id: string): Promise<boolean>;\n\n  // Project Pricing\n  getProjectPricing(projectId: string): Promise<ProjectPricing[]>;\n  getProjectPricingItem(id: string): Promise<ProjectPricing | undefined>;\n  createProjectPricing(pricing: InsertProjectPricing): Promise<ProjectPricing>;\n  updateProjectPricing(id: string, pricing: Partial<InsertProjectPricing>): Promise<ProjectPricing | undefined>;\n  deleteProjectPricing(id: string): Promise<boolean>;\n\n  // Estimate Templates\n  getEstimateTemplates(): Promise<EstimateTemplate[]>;\n  getEstimateTemplatesByTradeClass(tradeClassId: string): Promise<EstimateTemplate[]>;\n  getEstimateTemplate(id: string): Promise<EstimateTemplate | undefined>;\n  createEstimateTemplate(template: InsertEstimateTemplate): Promise<EstimateTemplate>;\n  updateEstimateTemplate(id: string, template: Partial<InsertEstimateTemplate>): Promise<EstimateTemplate | undefined>;\n  deleteEstimateTemplate(id: string): Promise<boolean>;\n\n  // Regional Cost Database\n  getRegionalCostData(): Promise<RegionalCostDatabase[]>;\n  getRegionalCostDataByLocation(region?: string, state?: string, zipCode?: string): Promise<RegionalCostDatabase[]>;\n  createRegionalCostData(data: InsertRegionalCostDatabase): Promise<RegionalCostDatabase>;\n  updateRegionalCostData(id: string, data: Partial<InsertRegionalCostDatabase>): Promise<RegionalCostDatabase | undefined>;\n\n  // Supplier Management\n  getSuppliers(): Promise<Supplier[]>;\n  getSupplier(id: string): Promise<Supplier | undefined>;\n  getSuppliersBySpecialty(specialty: string): Promise<Supplier[]>;\n  createSupplier(supplier: InsertSupplier): Promise<Supplier>;\n  updateSupplier(id: string, supplier: Partial<InsertSupplier>): Promise<Supplier | undefined>;\n  deleteSupplier(id: string): Promise<boolean>;\n\n  // Material Pricing\n  getMaterialPricing(): Promise<MaterialPricing[]>;\n  getMaterialPricingBySku(skuId: string): Promise<MaterialPricing[]>;\n  getMaterialPricingBySupplier(supplierId: string): Promise<MaterialPricing[]>;\n  getBestPriceForSku(skuId: string): Promise<MaterialPricing | undefined>;\n  createMaterialPricing(pricing: InsertMaterialPricing): Promise<MaterialPricing>;\n  updateMaterialPricing(id: string, pricing: Partial<InsertMaterialPricing>): Promise<MaterialPricing | undefined>;\n\n  // Change Orders\n  getChangeOrders(): Promise<ChangeOrder[]>;\n  getChangeOrdersByProject(projectId: string): Promise<ChangeOrder[]>;\n  getChangeOrder(id: string): Promise<ChangeOrder | undefined>;\n  createChangeOrder(changeOrder: InsertChangeOrder): Promise<ChangeOrder>;\n  updateChangeOrder(id: string, changeOrder: Partial<InsertChangeOrder>): Promise<ChangeOrder | undefined>;\n  deleteChangeOrder(id: string): Promise<boolean>;\n\n  // Profit Margin Settings\n  getProfitMarginSettings(): Promise<ProfitMarginSettings[]>;\n  getProfitMarginSettingsByScope(scope: string, scopeId?: string): Promise<ProfitMarginSettings[]>;\n  createProfitMarginSettings(settings: InsertProfitMarginSettings): Promise<ProfitMarginSettings>;\n  updateProfitMarginSettings(id: string, settings: Partial<InsertProfitMarginSettings>): Promise<ProfitMarginSettings | undefined>;\n\n  // Cost History and Trending\n  getCostHistory(): Promise<CostHistory[]>;\n  getCostHistoryBySku(skuId: string): Promise<CostHistory[]>;\n  getCostTrend(skuId: string, days: number): Promise<CostHistory[]>;\n  createCostHistory(history: InsertCostHistory): Promise<CostHistory>;\n\n  // Cost Escalation\n  getCostEscalation(): Promise<CostEscalation[]>;\n  getCostEscalationByProject(projectId: string): Promise<CostEscalation[]>;\n  getActiveCostEscalation(projectId: string): Promise<CostEscalation[]>;\n  createCostEscalation(escalation: InsertCostEscalation): Promise<CostEscalation>;\n  updateCostEscalation(id: string, escalation: Partial<InsertCostEscalation>): Promise<CostEscalation | undefined>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  private initialized = false;\n\n  constructor() {\n    // Initialize with sample data asynchronously\n    this.initializeSampleData().catch(console.error);\n  }\n\n  private async initializeSampleData() {\n    try {\n      // Check if sample data already exists\n      const existingProjects = await db.select().from(projects).limit(1);\n      if (existingProjects.length > 0) {\n        this.initialized = true;\n        return;\n      }\n\n    // Sample project\n    const [sampleProject] = await db\n      .insert(projects)\n      .values({\n        id: \"proj-1\",\n        name: \"Downtown Office Complex\",\n        description: \"Mixed-use commercial building with office spaces and retail on ground floor\",\n        location: \"123 Business Ave, Suite 400\",\n        client: \"Downtown Development LLC\",\n        status: \"active\",\n      })\n      .returning();\n\n    // Sample drawings\n    const sampleDrawings = [\n      {\n        id: \"draw-1\",\n        projectId: sampleProject.id,\n        name: \"Floor Plan - Level 1\",\n        filename: \"floor-plan-l1.pdf\",\n        fileUrl: \"/uploads/floor-plan-l1.pdf\",\n        fileType: \"application/pdf\",\n        status: \"complete\",\n        scale: \"1/4\\\" = 1'\",\n        aiProcessed: true,\n      },\n      {\n        id: \"draw-2\",\n        projectId: sampleProject.id,\n        name: \"Electrical Plan - Level 1\",\n        filename: \"electrical-l1.pdf\",\n        fileUrl: \"/uploads/electrical-l1.pdf\",\n        fileType: \"application/pdf\",\n        status: \"complete\",\n        scale: \"1/4\\\" = 1'\",\n        aiProcessed: true,\n      },\n      {\n        id: \"draw-3\",\n        projectId: sampleProject.id,\n        name: \"HVAC Layout - Level 1\",\n        filename: \"hvac-l1.pdf\",\n        fileUrl: \"/uploads/hvac-l1.pdf\",\n        fileType: \"application/pdf\",\n        status: \"processing\",\n        scale: \"1/4\\\" = 1'\",\n        aiProcessed: false,\n      },\n    ];\n    \n    await db.insert(drawings).values(sampleDrawings);\n\n    // Sample takeoffs for the first drawing\n    await db.insert(takeoffs).values([\n      {\n        id: \"takeoff-1\",\n        drawingId: \"draw-1\",\n        elementType: \"doors\",\n        elementName: \"Interior Door - 36\\\" x 80\\\"\",\n        itemType: \"Interior Door\",\n        quantity: 12,\n        width: 36,\n        height: 80,\n        unit: \"each\",\n        coordinates: { x: 100, y: 200 },\n        detectedByAi: true,\n        costPerUnit: 250,\n        totalCost: 3000,\n      },\n      {\n        id: \"takeoff-2\",\n        drawingId: \"draw-1\",\n        elementType: \"windows\",\n        elementName: \"Double Hung Window - 48\\\" x 60\\\"\",\n        itemType: \"Double Hung Window\",\n        quantity: 8,\n        width: 48,\n        height: 60,\n        unit: \"each\",\n        coordinates: { x: 300, y: 150 },\n        detectedByAi: true,\n        costPerUnit: 450,\n        totalCost: 3600,\n      },\n      {\n        id: \"takeoff-3\",\n        drawingId: \"draw-1\",\n        elementType: \"flooring\",\n        elementName: \"Luxury Vinyl Plank\",\n        itemType: \"Vinyl Flooring\",\n        quantity: 2400,\n        area: 2400,\n        unit: \"sq ft\",\n        detectedByAi: true,\n        costPerUnit: 4.5,\n        totalCost: 10800,\n      },\n      {\n        id: \"takeoff-4\",\n        drawingId: \"draw-1\",\n        elementType: \"electrical\",\n        elementName: \"Electrical Outlets\",\n        itemType: \"Electrical Outlet\",\n        quantity: 24,\n        unit: \"each\",\n        detectedByAi: true,\n        costPerUnit: 85,\n        totalCost: 2040,\n      }\n    ]);\n\n    // Sample material costs\n    await db.insert(materialCosts).values([\n      {\n        id: \"cost-1\",\n        category: \"doors\",\n        itemName: \"Interior Door (36\\\")\",\n        unit: \"each\",\n        materialCost: 180,\n        laborCost: 150,\n        description: \"Standard hollow core interior door with frame\",\n      },\n      {\n        id: \"cost-2\",\n        category: \"windows\",\n        itemName: \"Double Hung Window (3'x4')\",\n        unit: \"each\",\n        materialCost: 350,\n        laborCost: 200,\n        description: \"Standard double hung window with installation\",\n      },\n      {\n        id: \"cost-3\",\n        category: \"flooring\",\n        itemName: \"Hardwood Flooring\",\n        unit: \"sq ft\",\n        materialCost: 8.5,\n        laborCost: 6.0,\n        description: \"Oak hardwood flooring with installation\",\n      },\n    ]);\n\n    // Sample trade classes\n    await db.insert(tradeClasses).values([\n      { id: \"trade-1\", name: \"General Construction\", code: \"GC\", description: \"General construction and framing\" },\n      { id: \"trade-2\", name: \"Electrical\", code: \"ELEC\", description: \"Electrical systems and components\" },\n      { id: \"trade-3\", name: \"Plumbing\", code: \"PLUMB\", description: \"Plumbing systems and fixtures\" },\n      { id: \"trade-4\", name: \"HVAC\", code: \"HVAC\", description: \"Heating, ventilation, and air conditioning\" },\n      { id: \"trade-5\", name: \"Flooring\", code: \"FLOOR\", description: \"All types of flooring materials and installation\" },\n      { id: \"trade-6\", name: \"Windows & Doors\", code: \"WD\", description: \"Windows, doors, and related hardware\" },\n      { id: \"trade-7\", name: \"Roofing\", code: \"ROOF\", description: \"Roofing materials and installation\" },\n      { id: \"trade-8\", name: \"Insulation\", code: \"INSUL\", description: \"Insulation materials and installation\" },\n    ]);\n\n    // Sample product SKUs\n    await db.insert(productSkus).values([\n      // General Construction\n      { id: \"sku-1\", sku: \"LUM-2X4-8\", name: \"2x4x8 Lumber\", tradeClassId: \"trade-1\", category: \"Lumber\", unit: \"piece\", materialCost: 6.50, laborCost: 2.00, description: \"Standard 2x4x8 construction lumber\" },\n      { id: \"sku-2\", sku: \"LUM-2X6-8\", name: \"2x6x8 Lumber\", tradeClassId: \"trade-1\", category: \"Lumber\", unit: \"piece\", materialCost: 9.75, laborCost: 2.50, description: \"Standard 2x6x8 construction lumber\" },\n      { id: \"sku-3\", sku: \"PLY-3/4-4X8\", name: \"3/4\\\" Plywood 4x8\", tradeClassId: \"trade-1\", category: \"Sheathing\", unit: \"sheet\", materialCost: 58.00, laborCost: 15.00, description: \"3/4 inch plywood sheet 4x8 feet\" },\n      \n      // Electrical\n      { id: \"sku-4\", sku: \"ELEC-OUT-STD\", name: \"Standard Electrical Outlet\", tradeClassId: \"trade-2\", category: \"Outlets\", unit: \"each\", materialCost: 12.50, laborCost: 45.00, description: \"Standard 15A electrical outlet with installation\" },\n      { id: \"sku-5\", sku: \"ELEC-SW-STD\", name: \"Standard Light Switch\", tradeClassId: \"trade-2\", category: \"Switches\", unit: \"each\", materialCost: 8.75, laborCost: 35.00, description: \"Standard single-pole light switch\" },\n      { id: \"sku-6\", sku: \"WIRE-12-2\", name: \"12-2 Romex Wire\", tradeClassId: \"trade-2\", category: \"Wiring\", unit: \"ft\", materialCost: 0.85, laborCost: 1.25, description: \"12 AWG 2-conductor Romex wire\" },\n      \n      // Plumbing\n      { id: \"sku-7\", sku: \"PIPE-PVC-4\", name: \"4\\\" PVC Pipe\", tradeClassId: \"trade-3\", category: \"Pipe\", unit: \"ft\", materialCost: 3.25, laborCost: 8.50, description: \"4 inch PVC drain pipe\" },\n      { id: \"sku-8\", sku: \"FIX-TOILET-STD\", name: \"Standard Toilet\", tradeClassId: \"trade-3\", category: \"Fixtures\", unit: \"each\", materialCost: 285.00, laborCost: 175.00, description: \"Standard two-piece toilet with installation\" },\n      \n      // HVAC\n      { id: \"sku-9\", sku: \"DUCT-6\", name: \"6\\\" Flexible Ductwork\", tradeClassId: \"trade-4\", category: \"Ductwork\", unit: \"ft\", materialCost: 4.50, laborCost: 6.25, description: \"6 inch flexible HVAC ductwork\" },\n      { id: \"sku-10\", sku: \"VENT-CEIL\", name: \"Ceiling Vent Register\", tradeClassId: \"trade-4\", category: \"Vents\", unit: \"each\", materialCost: 28.00, laborCost: 45.00, description: \"Standard ceiling vent register\" },\n      \n      // Flooring\n      { id: \"sku-11\", sku: \"FLOOR-OAK-34\", name: \"3/4\\\" Oak Hardwood\", tradeClassId: \"trade-5\", category: \"Hardwood\", unit: \"sq ft\", materialCost: 8.50, laborCost: 6.00, description: \"3/4 inch solid oak hardwood flooring\" },\n      { id: \"sku-12\", sku: \"TILE-POR-12X24\", name: \"12x24 Porcelain Tile\", tradeClassId: \"trade-5\", category: \"Tile\", unit: \"sq ft\", materialCost: 4.25, laborCost: 8.75, description: \"12x24 inch porcelain floor tile\" },\n      \n      // Windows & Doors\n      { id: \"sku-13\", sku: \"WIN-DH-3X4\", name: \"3x4 Double Hung Window\", tradeClassId: \"trade-6\", category: \"Windows\", unit: \"each\", materialCost: 350.00, laborCost: 200.00, description: \"3x4 feet double hung vinyl window\" },\n      { id: \"sku-14\", sku: \"DOOR-INT-32\", name: \"32\\\" Interior Door\", tradeClassId: \"trade-6\", category: \"Doors\", unit: \"each\", materialCost: 180.00, laborCost: 150.00, description: \"32 inch hollow core interior door\" },\n      \n      // Roofing\n      { id: \"sku-15\", sku: \"SHIN-ARCH-30\", name: \"30-Year Architectural Shingles\", tradeClassId: \"trade-7\", category: \"Shingles\", unit: \"sq\", materialCost: 125.00, laborCost: 85.00, description: \"30-year architectural asphalt shingles per square\" },\n      \n      // Insulation\n      { id: \"sku-16\", sku: \"INSUL-FG-R15\", name: \"R-15 Fiberglass Insulation\", tradeClassId: \"trade-8\", category: \"Batts\", unit: \"sq ft\", materialCost: 1.25, laborCost: 0.75, description: \"R-15 fiberglass batt insulation\" },\n    ]);\n    \n    this.initialized = true;\n    console.log(\"Sample data initialized successfully\");\n  } catch (error) {\n    console.error(\"Failed to initialize sample data:\", error);\n    // Continue without sample data\n  }\n}\n\n  // Projects\n  async getProject(id: string): Promise<Project | undefined> {\n    const [project] = await db.select().from(projects).where(eq(projects.id, id));\n    return project;\n  }\n\n  async getProjects(): Promise<Project[]> {\n    return await db.select().from(projects);\n  }\n\n  async createProject(insertProject: InsertProject): Promise<Project> {\n    const [project] = await db\n      .insert(projects)\n      .values({ ...insertProject, id: randomUUID() })\n      .returning();\n    return project;\n  }\n\n  async updateProject(id: string, updateData: Partial<InsertProject>): Promise<Project | undefined> {\n    const [project] = await db\n      .update(projects)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(projects.id, id))\n      .returning();\n    return project;\n  }\n\n  async deleteProject(id: string): Promise<boolean> {\n    // Delete related takeoffs first\n    const projectDrawings = await db.select().from(drawings).where(eq(drawings.projectId, id));\n    for (const drawing of projectDrawings) {\n      await db.delete(takeoffs).where(eq(takeoffs.drawingId, drawing.id));\n    }\n    \n    // Delete related drawings\n    await db.delete(drawings).where(eq(drawings.projectId, id));\n    \n    // Delete the project\n    const result = await db.delete(projects).where(eq(projects.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Drawings\n  async getDrawing(id: string): Promise<Drawing | undefined> {\n    const [drawing] = await db.select().from(drawings).where(eq(drawings.id, id));\n    return drawing;\n  }\n\n  async getDrawingsByProject(projectId: string): Promise<Drawing[]> {\n    return await db.select().from(drawings).where(eq(drawings.projectId, projectId));\n  }\n\n  async createDrawing(insertDrawing: InsertDrawing): Promise<Drawing> {\n    const [drawing] = await db\n      .insert(drawings)\n      .values({ ...insertDrawing, id: randomUUID() })\n      .returning();\n    return drawing;\n  }\n\n  async updateDrawing(id: string, updateData: Partial<InsertDrawing>): Promise<Drawing | undefined> {\n    const [drawing] = await db\n      .update(drawings)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(drawings.id, id))\n      .returning();\n    return drawing;\n  }\n\n  // Takeoffs\n  async getTakeoff(id: string): Promise<Takeoff | undefined> {\n    const [takeoff] = await db.select().from(takeoffs).where(eq(takeoffs.id, id));\n    return takeoff;\n  }\n\n  async getTakeoffsByDrawing(drawingId: string): Promise<Takeoff[]> {\n    return await db.select().from(takeoffs).where(eq(takeoffs.drawingId, drawingId));\n  }\n\n  async createTakeoff(insertTakeoff: InsertTakeoff): Promise<Takeoff> {\n    const [takeoff] = await db\n      .insert(takeoffs)\n      .values({ ...insertTakeoff, id: randomUUID() })\n      .returning();\n    return takeoff;\n  }\n\n  async updateTakeoff(id: string, updateData: Partial<InsertTakeoff>): Promise<Takeoff | undefined> {\n    // Store original values if not already stored and this is the first manual edit\n    if (updateData.manuallyEdited && !updateData.originalQuantity) {\n      const existingTakeoff = await this.getTakeoff(id);\n      if (existingTakeoff && !existingTakeoff.manuallyEdited) {\n        updateData.originalQuantity = existingTakeoff.quantity;\n        updateData.originalArea = existingTakeoff.area;\n        updateData.originalLength = existingTakeoff.length;\n        updateData.originalCostPerUnit = existingTakeoff.costPerUnit;\n        updateData.originalTotalCost = existingTakeoff.totalCost;\n      }\n    }\n\n    const [takeoff] = await db\n      .update(takeoffs)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(takeoffs.id, id))\n      .returning();\n    return takeoff;\n  }\n\n  async deleteTakeoff(id: string): Promise<boolean> {\n    const result = await db.delete(takeoffs).where(eq(takeoffs.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Material Costs\n  async getMaterialCosts(): Promise<MaterialCost[]> {\n    return await db.select().from(materialCosts);\n  }\n\n  async getMaterialCostsByCategory(category: string): Promise<MaterialCost[]> {\n    return await db.select().from(materialCosts).where(eq(materialCosts.category, category));\n  }\n\n  async createMaterialCost(insertCost: InsertMaterialCost): Promise<MaterialCost> {\n    const [cost] = await db\n      .insert(materialCosts)\n      .values({ ...insertCost, id: randomUUID() })\n      .returning();\n    return cost;\n  }\n\n  // Saved Analyses\n  async getSavedAnalysis(id: string): Promise<SavedAnalysis | undefined> {\n    const [analysis] = await db.select().from(savedAnalyses).where(eq(savedAnalyses.id, id));\n    return analysis;\n  }\n\n  async getSavedAnalysesByProject(projectId: string): Promise<SavedAnalysis[]> {\n    return await db.select().from(savedAnalyses).where(eq(savedAnalyses.projectId, projectId));\n  }\n\n  async createSavedAnalysis(insertAnalysis: InsertSavedAnalysis): Promise<SavedAnalysis> {\n    const [analysis] = await db\n      .insert(savedAnalyses)\n      .values({ ...insertAnalysis, id: randomUUID() })\n      .returning();\n    return analysis;\n  }\n\n  async updateSavedAnalysis(id: string, updateData: Partial<InsertSavedAnalysis>): Promise<SavedAnalysis | undefined> {\n    const [analysis] = await db\n      .update(savedAnalyses)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(savedAnalyses.id, id))\n      .returning();\n    return analysis;\n  }\n\n  async deleteSavedAnalysis(id: string): Promise<boolean> {\n    const result = await db.delete(savedAnalyses).where(eq(savedAnalyses.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Trade Classes\n  async getTradeClasses(): Promise<TradeClass[]> {\n    return await db.select().from(tradeClasses);\n  }\n\n  async getTradeClass(id: string): Promise<TradeClass | undefined> {\n    const [tradeClass] = await db.select().from(tradeClasses).where(eq(tradeClasses.id, id));\n    return tradeClass;\n  }\n\n  async createTradeClass(insertTradeClass: InsertTradeClass): Promise<TradeClass> {\n    const [tradeClass] = await db\n      .insert(tradeClasses)\n      .values({ ...insertTradeClass, id: randomUUID() })\n      .returning();\n    return tradeClass;\n  }\n\n  async updateTradeClass(id: string, updateData: Partial<InsertTradeClass>): Promise<TradeClass | undefined> {\n    const [tradeClass] = await db\n      .update(tradeClasses)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(tradeClasses.id, id))\n      .returning();\n    return tradeClass;\n  }\n\n  async deleteTradeClass(id: string): Promise<boolean> {\n    const result = await db.delete(tradeClasses).where(eq(tradeClasses.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Product SKUs\n  async getProductSkus(): Promise<ProductSku[]> {\n    return await db.select().from(productSkus);\n  }\n\n  async getProductSkusByTradeClass(tradeClassId: string): Promise<ProductSku[]> {\n    return await db.select().from(productSkus).where(eq(productSkus.tradeClassId, tradeClassId));\n  }\n\n  async getProductSku(id: string): Promise<ProductSku | undefined> {\n    const [sku] = await db.select().from(productSkus).where(eq(productSkus.id, id));\n    return sku;\n  }\n\n  async searchProductSkus(query: string, tradeClassId?: string): Promise<ProductSku[]> {\n    let conditions = sql`${productSkus.name} ILIKE ${'%' + query + '%'} OR ${productSkus.description} ILIKE ${'%' + query + '%'} OR ${productSkus.sku} ILIKE ${'%' + query + '%'}`;\n    \n    if (tradeClassId) {\n      conditions = sql`${conditions} AND ${productSkus.tradeClassId} = ${tradeClassId}`;\n    }\n    \n    return await db.select().from(productSkus).where(conditions);\n  }\n\n  async createProductSku(insertSku: InsertProductSku): Promise<ProductSku> {\n    const [sku] = await db\n      .insert(productSkus)\n      .values({ ...insertSku, id: randomUUID() })\n      .returning();\n    return sku;\n  }\n\n  async updateProductSku(id: string, updateData: Partial<InsertProductSku>): Promise<ProductSku | undefined> {\n    const [sku] = await db\n      .update(productSkus)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(productSkus.id, id))\n      .returning();\n    return sku;\n  }\n\n  async deleteProductSku(id: string): Promise<boolean> {\n    const result = await db.delete(productSkus).where(eq(productSkus.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Project Pricing\n  async getProjectPricing(projectId: string): Promise<ProjectPricing[]> {\n    return await db.select().from(projectPricing).where(eq(projectPricing.projectId, projectId));\n  }\n\n  async getProjectPricingItem(id: string): Promise<ProjectPricing | undefined> {\n    const [pricing] = await db.select().from(projectPricing).where(eq(projectPricing.id, id));\n    return pricing;\n  }\n\n  async createProjectPricing(insertPricing: InsertProjectPricing): Promise<ProjectPricing> {\n    const [pricing] = await db\n      .insert(projectPricing)\n      .values({ ...insertPricing, id: randomUUID() })\n      .returning();\n    return pricing;\n  }\n\n  async updateProjectPricing(id: string, updateData: Partial<InsertProjectPricing>): Promise<ProjectPricing | undefined> {\n    const [pricing] = await db\n      .update(projectPricing)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(projectPricing.id, id))\n      .returning();\n    return pricing;\n  }\n\n  async deleteProjectPricing(id: string): Promise<boolean> {\n    const result = await db.delete(projectPricing).where(eq(projectPricing.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Estimate Templates\n  async getEstimateTemplates(): Promise<EstimateTemplate[]> {\n    return await db.select().from(estimateTemplates);\n  }\n\n  async getEstimateTemplatesByTradeClass(tradeClassId: string): Promise<EstimateTemplate[]> {\n    return await db.select().from(estimateTemplates).where(eq(estimateTemplates.tradeClassId, tradeClassId));\n  }\n\n  async getEstimateTemplate(id: string): Promise<EstimateTemplate | undefined> {\n    const [template] = await db.select().from(estimateTemplates).where(eq(estimateTemplates.id, id));\n    return template;\n  }\n\n  async createEstimateTemplate(insertTemplate: InsertEstimateTemplate): Promise<EstimateTemplate> {\n    const [template] = await db\n      .insert(estimateTemplates)\n      .values({ ...insertTemplate, id: randomUUID() })\n      .returning();\n    return template;\n  }\n\n  async updateEstimateTemplate(id: string, updateData: Partial<InsertEstimateTemplate>): Promise<EstimateTemplate | undefined> {\n    const [template] = await db\n      .update(estimateTemplates)\n      .set({ ...updateData, updatedAt: new Date() })\n      .where(eq(estimateTemplates.id, id))\n      .returning();\n    return template;\n  }\n\n  async deleteEstimateTemplate(id: string): Promise<boolean> {\n    const result = await db.delete(estimateTemplates).where(eq(estimateTemplates.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Regional Cost Database Methods\n  async getRegionalCostData(): Promise<RegionalCostDatabase[]> {\n    return await db.select().from(regionalCostDatabase);\n  }\n\n  async getRegionalCostDataByLocation(region?: string, state?: string, zipCode?: string): Promise<RegionalCostDatabase[]> {\n    let query = db.select().from(regionalCostDatabase);\n    \n    if (region) {\n      query = query.where(eq(regionalCostDatabase.region, region));\n    }\n    if (state) {\n      query = query.where(eq(regionalCostDatabase.state, state));\n    }\n    if (zipCode) {\n      query = query.where(eq(regionalCostDatabase.zipCode, zipCode));\n    }\n\n    return await query;\n  }\n\n  async createRegionalCostData(data: InsertRegionalCostDatabase): Promise<RegionalCostDatabase> {\n    const [result] = await db.insert(regionalCostDatabase).values(data).returning();\n    return result;\n  }\n\n  async updateRegionalCostData(id: string, data: Partial<InsertRegionalCostDatabase>): Promise<RegionalCostDatabase | undefined> {\n    const [result] = await db.update(regionalCostDatabase)\n      .set({ ...data, lastUpdated: new Date() })\n      .where(eq(regionalCostDatabase.id, id))\n      .returning();\n    return result;\n  }\n\n  // Supplier Management Methods\n  async getSuppliers(): Promise<Supplier[]> {\n    return await db.select().from(suppliers).where(eq(suppliers.isActive, true));\n  }\n\n  async getSupplier(id: string): Promise<Supplier | undefined> {\n    const [result] = await db.select().from(suppliers).where(eq(suppliers.id, id));\n    return result;\n  }\n\n  async getSuppliersBySpecialty(specialty: string): Promise<Supplier[]> {\n    return await db.select().from(suppliers)\n      .where(sql`${suppliers.specialties} @> ${JSON.stringify([specialty])}`);\n  }\n\n  async createSupplier(supplier: InsertSupplier): Promise<Supplier> {\n    const [result] = await db.insert(suppliers).values(supplier).returning();\n    return result;\n  }\n\n  async updateSupplier(id: string, supplier: Partial<InsertSupplier>): Promise<Supplier | undefined> {\n    const [result] = await db.update(suppliers)\n      .set({ ...supplier, updatedAt: new Date() })\n      .where(eq(suppliers.id, id))\n      .returning();\n    return result;\n  }\n\n  async deleteSupplier(id: string): Promise<boolean> {\n    const result = await db.update(suppliers)\n      .set({ isActive: false })\n      .where(eq(suppliers.id, id));\n    return result.rowCount > 0;\n  }\n\n  // Material Pricing Methods\n  async getMaterialPricing(): Promise<MaterialPricing[]> {\n    return await db.select().from(materialPricing);\n  }\n\n  async getMaterialPricingBySku(skuId: string): Promise<MaterialPricing[]> {\n    return await db.select().from(materialPricing)\n      .where(eq(materialPricing.skuId, skuId))\n      .orderBy(materialPricing.currentPrice);\n  }\n\n  async getMaterialPricingBySupplier(supplierId: string): Promise<MaterialPricing[]> {\n    return await db.select().from(materialPricing)\n      .where(eq(materialPricing.supplierId, supplierId));\n  }\n\n  async getBestPriceForSku(skuId: string): Promise<MaterialPricing | undefined> {\n    const [result] = await db.select().from(materialPricing)\n      .where(eq(materialPricing.skuId, skuId))\n      .orderBy(materialPricing.currentPrice)\n      .limit(1);\n    return result;\n  }\n\n  async createMaterialPricing(pricing: InsertMaterialPricing): Promise<MaterialPricing> {\n    const [result] = await db.insert(materialPricing).values(pricing).returning();\n    return result;\n  }\n\n  async updateMaterialPricing(id: string, pricing: Partial<InsertMaterialPricing>): Promise<MaterialPricing | undefined> {\n    const [result] = await db.update(materialPricing)\n      .set({ ...pricing, lastUpdated: new Date() })\n      .where(eq(materialPricing.id, id))\n      .returning();\n    return result;\n  }\n\n  // Change Order Methods\n  async getChangeOrders(): Promise<ChangeOrder[]> {\n    return await db.select().from(changeOrders);\n  }\n\n  async getChangeOrdersByProject(projectId: string): Promise<ChangeOrder[]> {\n    return await db.select().from(changeOrders)\n      .where(eq(changeOrders.projectId, projectId))\n      .orderBy(changeOrders.createdAt);\n  }\n\n  async getChangeOrder(id: string): Promise<ChangeOrder | undefined> {\n    const [result] = await db.select().from(changeOrders).where(eq(changeOrders.id, id));\n    return result;\n  }\n\n  async createChangeOrder(changeOrder: InsertChangeOrder): Promise<ChangeOrder> {\n    // Generate change order number if not provided\n    if (!changeOrder.changeOrderNumber) {\n      const projectChangeOrders = await this.getChangeOrdersByProject(changeOrder.projectId);\n      changeOrder.changeOrderNumber = `CO-${String(projectChangeOrders.length + 1).padStart(3, '0')}`;\n    }\n\n    const [result] = await db.insert(changeOrders).values(changeOrder).returning();\n    return result;\n  }\n\n  async updateChangeOrder(id: string, changeOrder: Partial<InsertChangeOrder>): Promise<ChangeOrder | undefined> {\n    const [result] = await db.update(changeOrders)\n      .set({ ...changeOrder, updatedAt: new Date() })\n      .where(eq(changeOrders.id, id))\n      .returning();\n    return result;\n  }\n\n  async deleteChangeOrder(id: string): Promise<boolean> {\n    const result = await db.delete(changeOrders).where(eq(changeOrders.id, id));\n    return result.rowCount > 0;\n  }\n\n  // Profit Margin Settings Methods\n  async getProfitMarginSettings(): Promise<ProfitMarginSettings[]> {\n    return await db.select().from(profitMarginSettings)\n      .where(eq(profitMarginSettings.isActive, true));\n  }\n\n  async getProfitMarginSettingsByScope(scope: string, scopeId?: string): Promise<ProfitMarginSettings[]> {\n    let query = db.select().from(profitMarginSettings)\n      .where(eq(profitMarginSettings.scope, scope));\n\n    if (scopeId) {\n      if (scope === 'project') {\n        query = query.where(eq(profitMarginSettings.projectId, scopeId));\n      } else if (scope === 'trade_class') {\n        query = query.where(eq(profitMarginSettings.tradeClassId, scopeId));\n      }\n    }\n\n    return await query.where(eq(profitMarginSettings.isActive, true));\n  }\n\n  async createProfitMarginSettings(settings: InsertProfitMarginSettings): Promise<ProfitMarginSettings> {\n    const [result] = await db.insert(profitMarginSettings).values(settings).returning();\n    return result;\n  }\n\n  async updateProfitMarginSettings(id: string, settings: Partial<InsertProfitMarginSettings>): Promise<ProfitMarginSettings | undefined> {\n    const [result] = await db.update(profitMarginSettings)\n      .set({ ...settings, updatedAt: new Date() })\n      .where(eq(profitMarginSettings.id, id))\n      .returning();\n    return result;\n  }\n\n  // Cost History Methods\n  async getCostHistory(): Promise<CostHistory[]> {\n    return await db.select().from(costHistory)\n      .orderBy(costHistory.recordDate);\n  }\n\n  async getCostHistoryBySku(skuId: string): Promise<CostHistory[]> {\n    return await db.select().from(costHistory)\n      .where(eq(costHistory.skuId, skuId))\n      .orderBy(costHistory.recordDate);\n  }\n\n  async getCostTrend(skuId: string, days: number): Promise<CostHistory[]> {\n    const dateThreshold = new Date();\n    dateThreshold.setDate(dateThreshold.getDate() - days);\n\n    return await db.select().from(costHistory)\n      .where(eq(costHistory.skuId, skuId))\n      .where(sql`${costHistory.recordDate} >= ${dateThreshold}`)\n      .orderBy(costHistory.recordDate);\n  }\n\n  async createCostHistory(history: InsertCostHistory): Promise<CostHistory> {\n    const [result] = await db.insert(costHistory).values(history).returning();\n    return result;\n  }\n\n  // Cost Escalation Methods\n  async getCostEscalation(): Promise<CostEscalation[]> {\n    return await db.select().from(costEscalation);\n  }\n\n  async getCostEscalationByProject(projectId: string): Promise<CostEscalation[]> {\n    return await db.select().from(costEscalation)\n      .where(eq(costEscalation.projectId, projectId))\n      .orderBy(costEscalation.effectiveDate);\n  }\n\n  async getActiveCostEscalation(projectId: string): Promise<CostEscalation[]> {\n    const currentDate = new Date();\n    return await db.select().from(costEscalation)\n      .where(eq(costEscalation.projectId, projectId))\n      .where(eq(costEscalation.isActive, true))\n      .where(sql`${costEscalation.effectiveDate} <= ${currentDate}`)\n      .where(sql`${costEscalation.endDate} IS NULL OR ${costEscalation.endDate} > ${currentDate}`);\n  }\n\n  async createCostEscalation(escalation: InsertCostEscalation): Promise<CostEscalation> {\n    const [result] = await db.insert(costEscalation).values(escalation).returning();\n    return result;\n  }\n\n  async updateCostEscalation(id: string, escalation: Partial<InsertCostEscalation>): Promise<CostEscalation | undefined> {\n    const [result] = await db.update(costEscalation)\n      .set({ ...escalation, updatedAt: new Date() })\n      .where(eq(costEscalation.id, id))\n      .returning();\n    return result;\n  }\n\n  // Smart Cost Analysis Backend Methods\n  async analyzeProjectCostEfficiency(projectId: string): Promise<{\n    overallScore: number;\n    totalCost: number;\n    averageCostPerSqFt: number;\n    costByCategory: Array<{ category: string; amount: number; percentage: number }>;\n    efficiency: 'excellent' | 'good' | 'average' | 'poor';\n    insights: string[];\n  }> {\n    // Get all drawings for this project first, then get takeoffs for all drawings\n    const projectDrawings = await db.select().from(drawings).where(eq(drawings.projectId, projectId));\n    let projectTakeoffs = [];\n    \n    if (projectDrawings.length > 0) {\n      const drawingIds = projectDrawings.map(d => d.id);\n      projectTakeoffs = await db.select().from(takeoffs).where(sql`${takeoffs.drawingId} IN (${drawingIds.map(id => `'${id}'`).join(',')})`);\n    }\n    \n    if (projectTakeoffs.length === 0) {\n      return {\n        overallScore: 0,\n        totalCost: 0,\n        averageCostPerSqFt: 0,\n        costByCategory: [],\n        efficiency: 'poor',\n        insights: ['No takeoff data available for analysis']\n      };\n    }\n    \n    // Calculate total project cost\n    const totalCost = projectTakeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n    \n    // Calculate area-based metrics\n    const totalArea = projectTakeoffs.reduce((sum, t) => sum + (t.area || 0), 0);\n    const averageCostPerSqFt = totalArea > 0 ? totalCost / totalArea : 0;\n    \n    // Categorize costs\n    const categoryTotals = new Map<string, number>();\n    projectTakeoffs.forEach(takeoff => {\n      const category = takeoff.elementType || 'Other';\n      categoryTotals.set(category, (categoryTotals.get(category) || 0) + (takeoff.totalCost || 0));\n    });\n    \n    const costByCategory = Array.from(categoryTotals.entries())\n      .map(([category, amount]) => ({\n        category,\n        amount,\n        percentage: (amount / totalCost) * 100\n      }))\n      .sort((a, b) => b.amount - a.amount);\n    \n    // Calculate efficiency score (0-100)\n    let overallScore = 75; // Base score\n    \n    // Adjust based on cost distribution\n    const maxCategoryPercentage = costByCategory[0]?.percentage || 0;\n    if (maxCategoryPercentage > 50) overallScore -= 15; // Penalize over-concentration\n    if (maxCategoryPercentage < 25) overallScore += 10; // Reward balance\n    \n    // Adjust based on cost per square foot (industry benchmarks)\n    if (averageCostPerSqFt > 150) overallScore -= 10; // High cost\n    if (averageCostPerSqFt < 80) overallScore += 10; // Good value\n    \n    // Determine efficiency level\n    let efficiency: 'excellent' | 'good' | 'average' | 'poor';\n    if (overallScore >= 85) efficiency = 'excellent';\n    else if (overallScore >= 75) efficiency = 'good';\n    else if (overallScore >= 60) efficiency = 'average';\n    else efficiency = 'poor';\n    \n    // Generate insights\n    const insights = [];\n    if (totalCost > 100000) insights.push('Large project - consider bulk purchasing for savings');\n    if (maxCategoryPercentage > 40) insights.push(`${costByCategory[0].category} dominates costs (${maxCategoryPercentage.toFixed(1)}%)`);\n    if (averageCostPerSqFt > 120) insights.push('Above-average cost per sq ft - review material specifications');\n    if (costByCategory.length > 5) insights.push('Diverse cost categories - good for risk distribution');\n    \n    return {\n      overallScore,\n      totalCost,\n      averageCostPerSqFt,\n      costByCategory,\n      efficiency,\n      insights\n    };\n  }\n\n  async findCostSavingOpportunities(projectId: string): Promise<{\n    potentialSavings: number;\n    opportunities: Array<{\n      category: string;\n      description: string;\n      estimatedSavings: number;\n      priority: 'high' | 'medium' | 'low';\n    }>;\n  }> {\n    // Get all drawings for this project first, then get takeoffs for all drawings\n    const projectDrawings = await db.select().from(drawings).where(eq(drawings.projectId, projectId));\n    let projectTakeoffs = [];\n    \n    if (projectDrawings.length > 0) {\n      const drawingIds = projectDrawings.map(d => d.id);\n      projectTakeoffs = await db.select().from(takeoffs).where(sql`${takeoffs.drawingId} IN (${drawingIds.map(id => `'${id}'`).join(',')})`);\n    }\n    const analysis = await this.analyzeProjectCostEfficiency(projectId);\n    \n    const opportunities = [];\n    let potentialSavings = 0;\n    \n    // High-cost category optimization\n    const highestCostCategory = analysis.costByCategory[0];\n    if (highestCostCategory && highestCostCategory.percentage > 35) {\n      const savings = highestCostCategory.amount * 0.1; // 10% potential savings\n      opportunities.push({\n        category: highestCostCategory.category,\n        description: `Optimize ${highestCostCategory.category} costs through value engineering`,\n        estimatedSavings: savings,\n        priority: 'high' as const\n      });\n      potentialSavings += savings;\n    }\n    \n    // Quantity optimization\n    const highQuantityItems = projectTakeoffs.filter(t => (t.quantity || 0) > 50);\n    if (highQuantityItems.length > 0) {\n      const savings = highQuantityItems.reduce((sum, item) => sum + (item.totalCost || 0), 0) * 0.05;\n      opportunities.push({\n        category: 'Bulk Purchase',\n        description: 'Negotiate bulk pricing for high-quantity items',\n        estimatedSavings: savings,\n        priority: 'medium' as const\n      });\n      potentialSavings += savings;\n    }\n    \n    // Material substitution\n    const expensiveItems = projectTakeoffs.filter(t => (t.costPerUnit || 0) > 100);\n    if (expensiveItems.length > 0) {\n      const savings = expensiveItems.reduce((sum, item) => sum + (item.totalCost || 0), 0) * 0.15;\n      opportunities.push({\n        category: 'Material Substitution',\n        description: 'Consider alternative materials for expensive items',\n        estimatedSavings: savings,\n        priority: 'medium' as const\n      });\n      potentialSavings += savings;\n    }\n    \n    return {\n      potentialSavings,\n      opportunities: opportunities.sort((a, b) => b.estimatedSavings - a.estimatedSavings)\n    };\n  }\n\n  async generateCostBenchmarkReport(projectId: string): Promise<{\n    projectCost: number;\n    industryAverage: number;\n    percentageVsAverage: number;\n    ranking: 'below-average' | 'average' | 'above-average' | 'premium';\n    factors: Array<{ factor: string; impact: number; description: string }>;\n  }> {\n    const analysis = await this.analyzeProjectCostEfficiency(projectId);\n    \n    // Simulated industry benchmarks (in production, this would come from real data)\n    const industryBenchmarks = {\n      averageCostPerSqFt: 95,\n      typicalCategoryDistribution: {\n        'flooring': 25,\n        'windows': 20,\n        'doors': 15,\n        'electrical': 15,\n        'walls': 12,\n        'other': 13\n      }\n    };\n    \n    const industryAverage = industryBenchmarks.averageCostPerSqFt;\n    const percentageVsAverage = ((analysis.averageCostPerSqFt - industryAverage) / industryAverage) * 100;\n    \n    let ranking: 'below-average' | 'average' | 'above-average' | 'premium';\n    if (percentageVsAverage < -10) ranking = 'below-average';\n    else if (percentageVsAverage < 10) ranking = 'average';\n    else if (percentageVsAverage < 25) ranking = 'above-average';\n    else ranking = 'premium';\n    \n    // Analyze cost factors\n    const factors = [];\n    \n    // Regional factor\n    factors.push({\n      factor: 'Regional Costs',\n      impact: Math.random() * 20 - 10, // Simulated regional impact\n      description: 'Regional cost variations compared to national average'\n    });\n    \n    // Material quality factor\n    const avgCostPerUnit = analysis.totalCost / (analysis.costByCategory.reduce((sum, cat) => sum + cat.amount, 0) || 1);\n    factors.push({\n      factor: 'Material Quality',\n      impact: avgCostPerUnit > 50 ? 15 : 5,\n      description: avgCostPerUnit > 50 ? 'Premium materials selected' : 'Standard materials used'\n    });\n    \n    // Project complexity\n    const categoryCount = analysis.costByCategory.length;\n    factors.push({\n      factor: 'Project Complexity',\n      impact: categoryCount > 6 ? 10 : 0,\n      description: categoryCount > 6 ? 'High complexity with many categories' : 'Standard complexity project'\n    });\n    \n    return {\n      projectCost: analysis.totalCost,\n      industryAverage,\n      percentageVsAverage,\n      ranking,\n      factors\n    };\n  }\n\n  async generateProjectRiskAssessment(projectId: string): Promise<{\n    overallRiskScore: number;\n    riskLevel: 'low' | 'medium' | 'high' | 'critical';\n    risks: Array<{\n      category: string;\n      severity: 'low' | 'medium' | 'high';\n      probability: number;\n      impact: string;\n      mitigation: string;\n    }>;\n    recommendations: string[];\n  }> {\n    const analysis = await this.analyzeProjectCostEfficiency(projectId);\n    const benchmark = await this.generateCostBenchmarkReport(projectId);\n    \n    const risks = [];\n    let riskScore = 0;\n    \n    // Cost overrun risk\n    if (benchmark.percentageVsAverage > 20) {\n      risks.push({\n        category: 'Cost Overrun',\n        severity: 'high' as const,\n        probability: 0.75,\n        impact: 'Project costs significantly exceed industry standards',\n        mitigation: 'Implement value engineering and material substitution strategies'\n      });\n      riskScore += 25;\n    }\n    \n    // Budget concentration risk\n    const topCategory = analysis.costByCategory[0];\n    if (topCategory && topCategory.percentage > 45) {\n      risks.push({\n        category: 'Cost Concentration',\n        severity: 'medium' as const,\n        probability: 0.6,\n        impact: `Over-dependence on ${topCategory.category} creates supply chain vulnerability`,\n        mitigation: 'Diversify suppliers and consider alternative materials'\n      });\n      riskScore += 15;\n    }\n    \n    // Market volatility risk for expensive projects\n    if (analysis.totalCost > 150000) {\n      risks.push({\n        category: 'Market Volatility',\n        severity: 'medium' as const,\n        probability: 0.4,\n        impact: 'Large projects vulnerable to material price fluctuations',\n        mitigation: 'Lock in pricing with suppliers and consider phased purchasing'\n      });\n      riskScore += 10;\n    }\n    \n    // Quality vs cost risk\n    if (benchmark.ranking === 'below-average') {\n      risks.push({\n        category: 'Quality Risk',\n        severity: 'low' as const,\n        probability: 0.3,\n        impact: 'Low costs may indicate potential quality compromises',\n        mitigation: 'Verify material specifications and contractor qualifications'\n      });\n      riskScore += 5;\n    }\n    \n    // Determine overall risk level\n    let riskLevel: 'low' | 'medium' | 'high' | 'critical';\n    if (riskScore >= 40) riskLevel = 'critical';\n    else if (riskScore >= 25) riskLevel = 'high';\n    else if (riskScore >= 15) riskLevel = 'medium';\n    else riskLevel = 'low';\n    \n    // Generate recommendations\n    const recommendations = [];\n    if (riskScore > 20) {\n      recommendations.push('Consider implementing a risk management plan');\n      recommendations.push('Establish contingency budget of 10-15%');\n    }\n    if (analysis.efficiency === 'poor') {\n      recommendations.push('Conduct detailed cost review before proceeding');\n    }\n    if (risks.some(r => r.category === 'Cost Concentration')) {\n      recommendations.push('Evaluate supplier diversity and backup options');\n    }\n    \n    return {\n      overallRiskScore: riskScore,\n      riskLevel,\n      risks,\n      recommendations\n    };\n  }\n\n  async predictProjectCostTrends(projectId: string, months: number = 6): Promise<{\n    currentCost: number;\n    projectedCost: number;\n    trendDirection: 'increasing' | 'decreasing' | 'stable';\n    confidenceLevel: number;\n    factors: Array<{\n      factor: string;\n      impact: number;\n      description: string;\n    }>;\n    monthlyProjections: Array<{\n      month: number;\n      projectedCost: number;\n      confidence: number;\n    }>;\n  }> {\n    const analysis = await this.analyzeProjectCostEfficiency(projectId);\n    const currentCost = analysis.totalCost;\n    \n    // Simulate market trend factors (in production, this would use real market data)\n    const baseInflationRate = 0.02; // 2% annual inflation\n    const materialVolatility = Math.random() * 0.1 - 0.05; // -5% to +5% volatility\n    const seasonalFactor = Math.sin(Date.now() / 1000000) * 0.03; // Seasonal variation\n    \n    const monthlyInflationRate = baseInflationRate / 12;\n    const monthlyVolatility = materialVolatility / 12;\n    const monthlySeasonal = seasonalFactor / 12;\n    \n    const factors = [\n      {\n        factor: 'Base Inflation',\n        impact: baseInflationRate * 100,\n        description: 'Standard construction cost inflation rate'\n      },\n      {\n        factor: 'Material Volatility',\n        impact: materialVolatility * 100,\n        description: 'Market-specific material price fluctuations'\n      },\n      {\n        factor: 'Seasonal Variation',\n        impact: seasonalFactor * 100,\n        description: 'Seasonal demand patterns affecting pricing'\n      }\n    ];\n    \n    // Generate monthly projections\n    const monthlyProjections = [];\n    let runningCost = currentCost;\n    \n    for (let month = 1; month <= months; month++) {\n      const monthlyChange = monthlyInflationRate + monthlyVolatility + monthlySeasonal;\n      runningCost *= (1 + monthlyChange);\n      \n      const confidence = Math.max(0.3, 0.9 - (month * 0.1)); // Confidence decreases over time\n      \n      monthlyProjections.push({\n        month,\n        projectedCost: Math.round(runningCost),\n        confidence\n      });\n    }\n    \n    const finalProjectedCost = monthlyProjections[monthlyProjections.length - 1].projectedCost;\n    const totalChange = (finalProjectedCost - currentCost) / currentCost;\n    \n    let trendDirection: 'increasing' | 'decreasing' | 'stable';\n    if (Math.abs(totalChange) < 0.02) trendDirection = 'stable';\n    else if (totalChange > 0) trendDirection = 'increasing';\n    else trendDirection = 'decreasing';\n    \n    const confidenceLevel = monthlyProjections[Math.floor(months/2)]?.confidence || 0.7;\n    \n    return {\n      currentCost,\n      projectedCost: finalProjectedCost,\n      trendDirection,\n      confidenceLevel,\n      factors,\n      monthlyProjections\n    };\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":50738},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, real, timestamp, jsonb, boolean } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const projects = pgTable(\"projects\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  location: text(\"location\"),\n  address: text(\"address\"), // Keep to avoid data loss during migration\n  client: text(\"client\"),\n  status: text(\"status\").notNull().default(\"active\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const drawings = pgTable(\"drawings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id).notNull(),\n  name: text(\"name\").notNull(),\n  filename: text(\"filename\").notNull(),\n  fileUrl: text(\"file_url\").notNull(),\n  fileType: text(\"file_type\").notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, complete, error\n  scale: text(\"scale\").default(\"1/4\\\" = 1'\"),\n  aiProcessed: boolean(\"ai_processed\").default(false),\n  uploadedAt: timestamp(\"uploaded_at\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const takeoffs = pgTable(\"takeoffs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  drawingId: varchar(\"drawing_id\").references(() => drawings.id).notNull(),\n  elementType: text(\"element_type\").notNull(), // doors, windows, flooring, walls, electrical, plumbing\n  elementName: text(\"element_name\").notNull(),\n  itemType: text(\"item_type\").notNull(), // display name for UI\n  quantity: integer(\"quantity\").default(0),\n  originalQuantity: integer(\"original_quantity\"), // AI-detected quantity before manual edits\n  area: real(\"area\"), // for area measurements\n  originalArea: real(\"original_area\"), // Original AI-detected area\n  length: real(\"length\"), // for linear measurements\n  originalLength: real(\"original_length\"), // Original AI-detected length\n  width: real(\"width\"),\n  height: real(\"height\"),\n  unit: text(\"unit\").notNull(), // sq ft, ft, count, etc.\n  coordinates: jsonb(\"coordinates\"), // x, y coordinates for annotations\n  detectedByAi: boolean(\"detected_by_ai\").default(false),\n  costPerUnit: real(\"cost_per_unit\"),\n  originalCostPerUnit: real(\"original_cost_per_unit\"), // Original cost before manual adjustments\n  totalCost: real(\"total_cost\"),\n  originalTotalCost: real(\"original_total_cost\"), // Original total cost before adjustments\n  manuallyEdited: boolean(\"manually_edited\").default(false), // Track if user has modified this item\n  customPricing: jsonb(\"custom_pricing\"), // Store custom pricing overrides\n  linkedSkuId: varchar(\"linked_sku_id\").references(() => productSkus.id), // Link to product SKU for pricing\n  notes: text(\"notes\"), // user notes for the takeoff item\n  verified: boolean(\"verified\").default(false), // manually verified by user\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Add saved analyses table\nexport const savedAnalyses = pgTable(\"saved_analyses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id).notNull(),\n  drawingId: varchar(\"drawing_id\").references(() => drawings.id),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  analysisData: jsonb(\"analysis_data\").notNull(), // stores the complete analysis results\n  totalItems: integer(\"total_items\").default(0),\n  totalCost: real(\"total_cost\").default(0),\n  elementTypes: jsonb(\"element_types\"), // array of analyzed element types\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const materialCosts = pgTable(\"material_costs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  category: text(\"category\").notNull(), // doors, windows, flooring, etc.\n  itemName: text(\"item_name\").notNull(),\n  unit: text(\"unit\").notNull(),\n  materialCost: real(\"material_cost\").notNull(),\n  laborCost: real(\"labor_cost\").notNull(),\n  description: text(\"description\"),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Trade classifications for organizing SKUs and pricing\nexport const tradeClasses = pgTable(\"trade_classes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  code: text(\"code\").notNull().unique(),\n  description: text(\"description\"),\n  parentId: varchar(\"parent_id\"), // for hierarchical structure - references self\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Product SKUs organized by trade class\nexport const productSkus = pgTable(\"product_skus\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sku: text(\"sku\").notNull().unique(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  tradeClassId: varchar(\"trade_class_id\").references(() => tradeClasses.id).notNull(),\n  category: text(\"category\").notNull(),\n  subcategory: text(\"subcategory\"),\n  unit: text(\"unit\").notNull(),\n  unitSize: real(\"unit_size\"), // e.g., 2x4x8 for lumber\n  unitDescription: text(\"unit_description\"), // \"per linear foot\", \"per sheet\", etc.\n  materialCost: real(\"material_cost\").notNull(),\n  laborCost: real(\"labor_cost\").notNull(),\n  markupPercentage: real(\"markup_percentage\").default(0.20), // 20% default markup\n  tags: jsonb(\"tags\"), // array of searchable tags\n  specifications: jsonb(\"specifications\"), // detailed product specs\n  vendor: text(\"vendor\"),\n  vendorSku: text(\"vendor_sku\"),\n  isActive: boolean(\"is_active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Project-specific custom pricing overrides\nexport const projectPricing = pgTable(\"project_pricing\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id).notNull(),\n  skuId: varchar(\"sku_id\").references(() => productSkus.id),\n  customSku: text(\"custom_sku\"), // for one-off custom items\n  itemName: text(\"item_name\").notNull(),\n  unit: text(\"unit\").notNull(),\n  materialCost: real(\"material_cost\").notNull(),\n  laborCost: real(\"labor_cost\").notNull(),\n  markupPercentage: real(\"markup_percentage\").default(0.20),\n  notes: text(\"notes\"),\n  isCustom: boolean(\"is_custom\").default(false), // true for custom items not in SKU catalog\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Estimate templates by trade class\nexport const estimateTemplates = pgTable(\"estimate_templates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  tradeClassId: varchar(\"trade_class_id\").references(() => tradeClasses.id).notNull(),\n  templateData: jsonb(\"template_data\").notNull(), // structured template with line items\n  isPublic: boolean(\"is_public\").default(false), // company-wide templates vs private\n  createdBy: text(\"created_by\"), // user identifier\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Define relations\nexport const projectsRelations = relations(projects, ({ many }) => ({\n  drawings: many(drawings),\n  savedAnalyses: many(savedAnalyses),\n  projectPricing: many(projectPricing),\n}));\n\nexport const tradeClassesRelations = relations(tradeClasses, ({ one, many }) => ({\n  parent: one(tradeClasses, {\n    fields: [tradeClasses.parentId],\n    references: [tradeClasses.id],\n    relationName: \"tradeClassParent\",\n  }),\n  children: many(tradeClasses, {\n    relationName: \"tradeClassParent\",\n  }),\n  productSkus: many(productSkus),\n  estimateTemplates: many(estimateTemplates),\n}));\n\nexport const productSkusRelations = relations(productSkus, ({ one, many }) => ({\n  tradeClass: one(tradeClasses, {\n    fields: [productSkus.tradeClassId],\n    references: [tradeClasses.id],\n  }),\n  projectPricing: many(projectPricing),\n}));\n\nexport const projectPricingRelations = relations(projectPricing, ({ one }) => ({\n  project: one(projects, {\n    fields: [projectPricing.projectId],\n    references: [projects.id],\n  }),\n  sku: one(productSkus, {\n    fields: [projectPricing.skuId],\n    references: [productSkus.id],\n  }),\n}));\n\nexport const estimateTemplatesRelations = relations(estimateTemplates, ({ one }) => ({\n  tradeClass: one(tradeClasses, {\n    fields: [estimateTemplates.tradeClassId],\n    references: [tradeClasses.id],\n  }),\n}));\n\nexport const drawingsRelations = relations(drawings, ({ one, many }) => ({\n  project: one(projects, {\n    fields: [drawings.projectId],\n    references: [projects.id],\n  }),\n  takeoffs: many(takeoffs),\n}));\n\nexport const takeoffsRelations = relations(takeoffs, ({ one }) => ({\n  drawing: one(drawings, {\n    fields: [takeoffs.drawingId],\n    references: [drawings.id],\n  }),\n}));\n\nexport const savedAnalysesRelations = relations(savedAnalyses, ({ one }) => ({\n  project: one(projects, {\n    fields: [savedAnalyses.projectId],\n    references: [projects.id],\n  }),\n  drawing: one(drawings, {\n    fields: [savedAnalyses.drawingId],\n    references: [drawings.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertProjectSchema = createInsertSchema(projects).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertDrawingSchema = createInsertSchema(drawings).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTakeoffSchema = createInsertSchema(takeoffs).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertMaterialCostSchema = createInsertSchema(materialCosts).omit({\n  id: true,\n  updatedAt: true,\n});\n\nexport const insertSavedAnalysisSchema = createInsertSchema(savedAnalyses).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTradeClassSchema = createInsertSchema(tradeClasses).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertProductSkuSchema = createInsertSchema(productSkus).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertProjectPricingSchema = createInsertSchema(projectPricing).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertEstimateTemplateSchema = createInsertSchema(estimateTemplates).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\n// Types\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Project = typeof projects.$inferSelect;\n\nexport type InsertDrawing = z.infer<typeof insertDrawingSchema>;\nexport type Drawing = typeof drawings.$inferSelect;\n\nexport type InsertTakeoff = z.infer<typeof insertTakeoffSchema>;\nexport type Takeoff = typeof takeoffs.$inferSelect;\n\nexport type InsertMaterialCost = z.infer<typeof insertMaterialCostSchema>;\nexport type MaterialCost = typeof materialCosts.$inferSelect;\n\nexport type InsertSavedAnalysis = z.infer<typeof insertSavedAnalysisSchema>;\nexport type SavedAnalysis = typeof savedAnalyses.$inferSelect;\n\nexport type InsertTradeClass = z.infer<typeof insertTradeClassSchema>;\nexport type TradeClass = typeof tradeClasses.$inferSelect;\n\nexport type InsertProductSku = z.infer<typeof insertProductSkuSchema>;\nexport type ProductSku = typeof productSkus.$inferSelect;\n\nexport type InsertProjectPricing = z.infer<typeof insertProjectPricingSchema>;\nexport type ProjectPricing = typeof projectPricing.$inferSelect;\n\nexport type InsertEstimateTemplate = z.infer<typeof insertEstimateTemplateSchema>;\nexport type EstimateTemplate = typeof estimateTemplates.$inferSelect;\n\n// Regional Cost Database Tables\nexport const regionalCostDatabase = pgTable(\"regional_cost_database\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  region: text(\"region\").notNull(), // e.g., \"Northeast\", \"Southwest\", \"California Bay Area\"\n  state: text(\"state\"),\n  city: text(\"city\"),\n  zipCode: text(\"zip_code\"),\n  costIndex: real(\"cost_index\").notNull().default(1.0), // Cost multiplier for region\n  laborRate: real(\"labor_rate\"), // Average labor rate per hour\n  materialMarkup: real(\"material_markup\").default(0.15), // Regional material markup percentage\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Supplier Management\nexport const suppliers = pgTable(\"suppliers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  contactName: text(\"contact_name\"),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  address: text(\"address\"),\n  website: text(\"website\"),\n  specialties: jsonb(\"specialties\"), // Array of trade specialties\n  leadTime: integer(\"lead_time_days\").default(7), // Default lead time in days\n  paymentTerms: text(\"payment_terms\").default(\"NET 30\"),\n  discount: real(\"discount_percentage\").default(0), // Volume discount percentage\n  rating: real(\"rating\").default(0), // Supplier rating 1-5\n  isActive: boolean(\"is_active\").default(true),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Real-time Material Pricing\nexport const materialPricing = pgTable(\"material_pricing\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  skuId: varchar(\"sku_id\").references(() => productSkus.id).notNull(),\n  supplierId: varchar(\"supplier_id\").references(() => suppliers.id).notNull(),\n  currentPrice: real(\"current_price\").notNull(),\n  previousPrice: real(\"previous_price\"),\n  priceChange: real(\"price_change\"), // Percentage change from previous price\n  minimumOrderQuantity: integer(\"minimum_order_quantity\").default(1),\n  volumeDiscounts: jsonb(\"volume_discounts\"), // Tiered pricing structure\n  availability: text(\"availability\").default(\"in_stock\"), // in_stock, limited, backorder, discontinued\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  priceValidUntil: timestamp(\"price_valid_until\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Change Order Management\nexport const changeOrders = pgTable(\"change_orders\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id).notNull(),\n  changeOrderNumber: text(\"change_order_number\").notNull(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  requestedBy: text(\"requested_by\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, approved, rejected, completed\n  priority: text(\"priority\").default(\"medium\"), // low, medium, high, urgent\n  originalCost: real(\"original_cost\").default(0),\n  proposedCost: real(\"proposed_cost\").default(0),\n  approvedCost: real(\"approved_cost\"),\n  actualCost: real(\"actual_cost\"),\n  costImpact: real(\"cost_impact\"), // Difference from original estimate\n  scheduleImpact: integer(\"schedule_impact_days\").default(0),\n  impactedTakeoffs: jsonb(\"impacted_takeoffs\"), // Array of takeoff IDs affected\n  attachments: jsonb(\"attachments\"), // Document attachments\n  approvedBy: text(\"approved_by\"),\n  approvedAt: timestamp(\"approved_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Profit Margin and Markup Controls\nexport const profitMarginSettings = pgTable(\"profit_margin_settings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id),\n  tradeClassId: varchar(\"trade_class_id\").references(() => tradeClasses.id),\n  scope: text(\"scope\").notNull().default(\"global\"), // global, project, trade_class\n  materialMarkup: real(\"material_markup\").default(0.15), // 15% default material markup\n  laborMarkup: real(\"labor_markup\").default(0.25), // 25% default labor markup\n  equipmentMarkup: real(\"equipment_markup\").default(0.20), // 20% default equipment markup\n  subcontractorMarkup: real(\"subcontractor_markup\").default(0.10), // 10% default subcontractor markup\n  generalConditions: real(\"general_conditions\").default(0.08), // 8% for overhead\n  bondInsurance: real(\"bond_insurance\").default(0.02), // 2% for bonds/insurance\n  contingency: real(\"contingency\").default(0.05), // 5% contingency\n  profit: real(\"profit\").default(0.10), // 10% profit margin\n  isActive: boolean(\"is_active\").default(true),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Historical Cost Tracking and Trending\nexport const costHistory = pgTable(\"cost_history\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  skuId: varchar(\"sku_id\").references(() => productSkus.id).notNull(),\n  supplierId: varchar(\"supplier_id\").references(() => suppliers.id),\n  regionId: varchar(\"region_id\").references(() => regionalCostDatabase.id),\n  price: real(\"price\").notNull(),\n  laborRate: real(\"labor_rate\"),\n  recordDate: timestamp(\"record_date\").notNull().defaultNow(),\n  inflationRate: real(\"inflation_rate\"), // Annual inflation rate at time of record\n  economicIndex: real(\"economic_index\"), // Construction cost index value\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Cost Escalation and Inflation Adjustments\nexport const costEscalation = pgTable(\"cost_escalation\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").references(() => projects.id).notNull(),\n  escalationType: text(\"escalation_type\").notNull(), // annual_inflation, custom_rate, market_adjustment\n  rate: real(\"rate\").notNull(), // Annual escalation rate as percentage\n  effectiveDate: timestamp(\"effective_date\").notNull(),\n  endDate: timestamp(\"end_date\"),\n  impactedCategories: jsonb(\"impacted_categories\"), // Which cost categories are affected\n  reason: text(\"reason\"), // Reason for escalation\n  isActive: boolean(\"is_active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Add insert schemas for new tables\nexport const insertRegionalCostDatabaseSchema = createInsertSchema(regionalCostDatabase).omit({\n  id: true,\n  lastUpdated: true,\n  createdAt: true,\n});\n\nexport const insertSupplierSchema = createInsertSchema(suppliers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertMaterialPricingSchema = createInsertSchema(materialPricing).omit({\n  id: true,\n  lastUpdated: true,\n  createdAt: true,\n});\n\nexport const insertChangeOrderSchema = createInsertSchema(changeOrders).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertProfitMarginSettingsSchema = createInsertSchema(profitMarginSettings).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertCostHistorySchema = createInsertSchema(costHistory).omit({\n  id: true,\n  recordDate: true,\n  createdAt: true,\n});\n\nexport const insertCostEscalationSchema = createInsertSchema(costEscalation).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\n// Add new types\nexport type InsertRegionalCostDatabase = z.infer<typeof insertRegionalCostDatabaseSchema>;\nexport type RegionalCostDatabase = typeof regionalCostDatabase.$inferSelect;\n\nexport type InsertSupplier = z.infer<typeof insertSupplierSchema>;\nexport type Supplier = typeof suppliers.$inferSelect;\n\nexport type InsertMaterialPricing = z.infer<typeof insertMaterialPricingSchema>;\nexport type MaterialPricing = typeof materialPricing.$inferSelect;\n\nexport type InsertChangeOrder = z.infer<typeof insertChangeOrderSchema>;\nexport type ChangeOrder = typeof changeOrders.$inferSelect;\n\nexport type InsertProfitMarginSettings = z.infer<typeof insertProfitMarginSettingsSchema>;\nexport type ProfitMarginSettings = typeof profitMarginSettings.$inferSelect;\n\nexport type InsertCostHistory = z.infer<typeof insertCostHistorySchema>;\nexport type CostHistory = typeof costHistory.$inferSelect;\n\nexport type InsertCostEscalation = z.infer<typeof insertCostEscalationSchema>;\nexport type CostEscalation = typeof costEscalation.$inferSelect;\n","size_bytes":20388},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport Dashboard from \"@/pages/dashboard-new\";\nimport Projects from \"@/pages/projects\";\nimport ProjectDetail from \"@/pages/project-detail\";\n\nimport Reports from \"@/pages/reports\";\nimport Settings from \"@/pages/settings\";\nimport AdvancedCostManagement from \"@/pages/advanced-cost-management\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/projects\" component={Projects} />\n      <Route path=\"/projects/:id\" component={ProjectDetail} />\n      <Route path=\"/reports\" component={Reports} />\n      <Route path=\"/settings\" component={Settings} />\n      <Route path=\"/advanced-cost-management\" component={AdvancedCostManagement} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":1270},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(0, 0%, 100%);\n  --foreground: hsl(20, 14.3%, 4.1%);\n  --muted: hsl(60, 4.8%, 95.9%);\n  --muted-foreground: hsl(25, 5.3%, 44.7%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(20, 14.3%, 4.1%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(20, 14.3%, 4.1%);\n  --border: hsl(20, 5.9%, 90%);\n  --input: hsl(20, 5.9%, 90%);\n  --primary: hsl(207, 90%, 54%);\n  --primary-foreground: hsl(211, 100%, 99%);\n  --secondary: hsl(60, 4.8%, 95.9%);\n  --secondary-foreground: hsl(24, 9.8%, 10%);\n  --accent: hsl(60, 4.8%, 95.9%);\n  --accent-foreground: hsl(24, 9.8%, 10%);\n  --destructive: hsl(0, 84.2%, 60.2%);\n  --destructive-foreground: hsl(60, 9.1%, 97.8%);\n  --ring: hsl(20, 14.3%, 4.1%);\n  --radius: 0.5rem;\n\n  /* Blueprint color scheme */\n  --blueprint-50: hsl(214, 100%, 97%);\n  --blueprint-100: hsl(214, 95%, 93%);\n  --blueprint-200: hsl(213, 97%, 87%);\n  --blueprint-300: hsl(212, 96%, 78%);\n  --blueprint-400: hsl(213, 94%, 68%);\n  --blueprint-500: hsl(217, 91%, 60%);\n  --blueprint-600: hsl(221, 83%, 53%);\n  --blueprint-700: hsl(224, 76%, 48%);\n  --blueprint-800: hsl(226, 71%, 40%);\n  --blueprint-900: hsl(224, 64%, 33%);\n}\n\n.dark {\n  --background: hsl(240, 10%, 3.9%);\n  --foreground: hsl(0, 0%, 98%);\n  --muted: hsl(240, 3.7%, 15.9%);\n  --muted-foreground: hsl(240, 5%, 64.9%);\n  --popover: hsl(240, 10%, 3.9%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  --card: hsl(240, 10%, 3.9%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --border: hsl(240, 3.7%, 15.9%);\n  --input: hsl(240, 3.7%, 15.9%);\n  --primary: hsl(207, 90%, 54%);\n  --primary-foreground: hsl(211, 100%, 99%);\n  --secondary: hsl(240, 3.7%, 15.9%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --accent: hsl(240, 3.7%, 15.9%);\n  --accent-foreground: hsl(0, 0%, 98%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(0, 0%, 98%);\n  --ring: hsl(240, 4.9%, 83.9%);\n  --radius: 0.5rem;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer utilities {\n  .blueprint-50 {\n    background-color: var(--blueprint-50);\n  }\n  .blueprint-100 {\n    background-color: var(--blueprint-100);\n  }\n  .blueprint-200 {\n    background-color: var(--blueprint-200);\n  }\n  .blueprint-300 {\n    background-color: var(--blueprint-300);\n  }\n  .blueprint-400 {\n    background-color: var(--blueprint-400);\n  }\n  .blueprint-500 {\n    background-color: var(--blueprint-500);\n  }\n  .blueprint-600 {\n    background-color: var(--blueprint-600);\n  }\n  .blueprint-700 {\n    background-color: var(--blueprint-700);\n  }\n  .blueprint-800 {\n    background-color: var(--blueprint-800);\n  }\n  .blueprint-900 {\n    background-color: var(--blueprint-900);\n  }\n\n  .text-blueprint-50 {\n    color: var(--blueprint-50);\n  }\n  .text-blueprint-100 {\n    color: var(--blueprint-100);\n  }\n  .text-blueprint-200 {\n    color: var(--blueprint-200);\n  }\n  .text-blueprint-300 {\n    color: var(--blueprint-300);\n  }\n  .text-blueprint-400 {\n    color: var(--blueprint-400);\n  }\n  .text-blueprint-500 {\n    color: var(--blueprint-500);\n  }\n  .text-blueprint-600 {\n    color: var(--blueprint-600);\n  }\n  .text-blueprint-700 {\n    color: var(--blueprint-700);\n  }\n  .text-blueprint-800 {\n    color: var(--blueprint-800);\n  }\n  .text-blueprint-900 {\n    color: var(--blueprint-900);\n  }\n\n  .border-blueprint-50 {\n    border-color: var(--blueprint-50);\n  }\n  .border-blueprint-100 {\n    border-color: var(--blueprint-100);\n  }\n  .border-blueprint-200 {\n    border-color: var(--blueprint-200);\n  }\n  .border-blueprint-300 {\n    border-color: var(--blueprint-300);\n  }\n  .border-blueprint-400 {\n    border-color: var(--blueprint-400);\n  }\n  .border-blueprint-500 {\n    border-color: var(--blueprint-500);\n  }\n  .border-blueprint-600 {\n    border-color: var(--blueprint-600);\n  }\n  .border-blueprint-700 {\n    border-color: var(--blueprint-700);\n  }\n  .border-blueprint-800 {\n    border-color: var(--blueprint-800);\n  }\n  .border-blueprint-900 {\n    border-color: var(--blueprint-900);\n  }\n}\n\n/* Animation for results appearing */\n@keyframes fade-in {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.animate-fade-in {\n  animation: fade-in 0.5s ease-out;\n}\n","size_bytes":4341},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ai-chat-interface.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Send,\n  Bot,\n  User,\n  Loader2,\n  MessageSquare\n} from \"lucide-react\";\n\ninterface ChatMessage {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n}\n\ninterface AIChatInterfaceProps {\n  className?: string;\n}\n\nexport default function AIChatInterface({ className = \"\" }: AIChatInterfaceProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>([\n    {\n      id: '1',\n      role: 'assistant',\n      content: 'Hello! I\\'m your AI construction estimating assistant. I can help you with takeoff calculations, material quantities, cost estimates, and answer questions about your blueprints. What would you like to know?',\n      timestamp: new Date()\n    }\n  ]);\n  const [inputValue, setInputValue] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim() || isLoading) return;\n\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      role: 'user',\n      content: inputValue,\n      timestamp: new Date()\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setIsLoading(true);\n\n    // Simulate AI response\n    setTimeout(() => {\n      const aiResponse: ChatMessage = {\n        id: (Date.now() + 1).toString(),\n        role: 'assistant',\n        content: generateAIResponse(inputValue),\n        timestamp: new Date()\n      };\n      \n      setMessages(prev => [...prev, aiResponse]);\n      setIsLoading(false);\n    }, 1500);\n  };\n\n  const generateAIResponse = (userInput: string): string => {\n    const input = userInput.toLowerCase();\n    \n    if (input.includes('door') || input.includes('doors')) {\n      return 'I can help you analyze doors in your blueprints. Based on typical construction standards, interior doors are usually 80\" tall with widths of 24\", 28\", 30\", 32\", or 36\". Exterior doors are typically 36\" wide. Would you like me to run a door takeoff analysis on your current drawing?';\n    }\n    \n    if (input.includes('window') || input.includes('windows')) {\n      return 'For window analysis, I look at dimensions, types (single/double hung, casement, picture), and glazing specifications. Common residential window sizes range from 2\\'x3\\' to 4\\'x6\\'. Should I analyze the windows in your current blueprint?';\n    }\n    \n    if (input.includes('cost') || input.includes('price') || input.includes('estimate')) {\n      return 'I can provide cost estimates based on current material prices and labor rates. For accurate pricing, I\\'ll need to know your location and project specifications. What type of cost estimate are you looking for?';\n    }\n    \n    if (input.includes('sqft') || input.includes('square feet') || input.includes('area')) {\n      return 'I can calculate areas for rooms, total building area, or specific material coverage. For flooring, I typically add 10% waste factor. For paint coverage, standard is 350-400 sq ft per gallon. What area calculation do you need?';\n    }\n    \n    if (input.includes('help') || input.includes('what can you do')) {\n      return 'I can assist with: \\nâ€¢ Quantity takeoffs (doors, windows, flooring, walls)\\nâ€¢ Material cost estimates\\nâ€¢ Area and linear measurements\\nâ€¢ Construction specifications\\nâ€¢ Code compliance questions\\nâ€¢ Project planning advice\\n\\nJust describe what you need help with!';\n    }\n    \n    return 'I understand you\\'re asking about construction estimating. I can help with material takeoffs, cost calculations, measurements, and construction specifications. Could you provide more specific details about what you\\'d like me to analyze or calculate?';\n  };\n\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  const quickActions = [\n    \"Calculate total square footage\",\n    \"Count doors and windows\", \n    \"Estimate material costs\",\n    \"Analyze room dimensions\"\n  ];\n\n  const handleQuickAction = (action: string) => {\n    setInputValue(action);\n  };\n\n  return (\n    <div className={`flex flex-col h-full bg-white ${className}`}>\n      {/* Header */}\n      <div className=\"p-4 border-b border-slate-200\">\n        <div className=\"flex items-center space-x-2\">\n          <MessageSquare className=\"w-5 h-5 text-purple-600\" />\n          <h2 className=\"text-lg font-semibold text-slate-900\">AI Assistant</h2>\n        </div>\n        <p className=\"text-sm text-slate-600 mt-1\">Construction estimating & takeoff help</p>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {messages.map((message) => (\n          <div key={message.id} className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n            <div className={`flex items-start space-x-2 max-w-[80%] ${message.role === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`}>\n              <div className={`w-8 h-8 rounded-full flex items-center justify-center ${\n                message.role === 'user' \n                  ? 'bg-blue-100 text-blue-600' \n                  : 'bg-purple-100 text-purple-600'\n              }`}>\n                {message.role === 'user' ? <User className=\"w-4 h-4\" /> : <Bot className=\"w-4 h-4\" />}\n              </div>\n              \n              <Card className={`${\n                message.role === 'user' \n                  ? 'bg-blue-600 text-white' \n                  : 'bg-slate-50 border-slate-200'\n              }`}>\n                <CardContent className=\"p-3\">\n                  <p className=\"text-sm whitespace-pre-line\">{message.content}</p>\n                  <p className={`text-xs mt-2 ${\n                    message.role === 'user' ? 'text-blue-100' : 'text-slate-500'\n                  }`}>\n                    {formatTime(message.timestamp)}\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        ))}\n        \n        {isLoading && (\n          <div className=\"flex justify-start\">\n            <div className=\"flex items-start space-x-2 max-w-[80%]\">\n              <div className=\"w-8 h-8 rounded-full flex items-center justify-center bg-purple-100 text-purple-600\">\n                <Bot className=\"w-4 h-4\" />\n              </div>\n              <Card className=\"bg-slate-50 border-slate-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-center space-x-2\">\n                    <Loader2 className=\"w-4 h-4 animate-spin text-purple-600\" />\n                    <p className=\"text-sm text-slate-600\">Thinking...</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        )}\n        \n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Quick Actions */}\n      {messages.length === 1 && (\n        <div className=\"p-4 border-t border-slate-200\">\n          <p className=\"text-xs text-slate-500 mb-2\">Quick actions:</p>\n          <div className=\"grid grid-cols-2 gap-2\">\n            {quickActions.map((action, index) => (\n              <Button\n                key={index}\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"text-xs text-left justify-start h-auto py-2\"\n                onClick={() => handleQuickAction(action)}\n              >\n                {action}\n              </Button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Input */}\n      <div className=\"p-4 border-t border-slate-200\">\n        <div className=\"flex space-x-2\">\n          <Input\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            placeholder=\"Ask about takeoffs, costs, or measurements...\"\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                handleSendMessage();\n              }\n            }}\n            className=\"flex-1\"\n          />\n          <Button \n            onClick={handleSendMessage}\n            disabled={!inputValue.trim() || isLoading}\n            className=\"bg-purple-600 hover:bg-purple-700\"\n          >\n            <Send className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":8715},"client/src/components/ai-chat-widget.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { \n  MessageSquare,\n  X,\n  Send,\n  Bot,\n  User,\n  Minimize2,\n  Maximize2\n} from \"lucide-react\";\n\ninterface AIChatWidgetProps {\n  className?: string;\n}\n\nexport default function AIChatWidget({ className = \"\" }: AIChatWidgetProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [inputValue, setInputValue] = useState('');\n\n  const handleSendMessage = () => {\n    if (!inputValue.trim()) return;\n    // Handle message sending\n    setInputValue('');\n  };\n\n  if (!isOpen) {\n    return (\n      <div className={`fixed top-32 right-6 z-50 ${className}`}>\n        <Button\n          onClick={() => setIsOpen(true)}\n          className=\"bg-purple-600 hover:bg-purple-700 text-white shadow-lg\"\n          size=\"sm\"\n        >\n          <MessageSquare className=\"w-4 h-4 mr-2\" />\n          AI Assistant\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`fixed top-32 right-6 z-50 ${className}`}>\n      <Card className={`w-80 shadow-xl border-purple-200 transition-all duration-300 ${\n        isMinimized ? 'h-12' : 'h-96'\n      }`}>\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-3 bg-purple-50 border-b border-purple-200 rounded-t-lg\">\n          <div className=\"flex items-center space-x-2\">\n            <MessageSquare className=\"w-4 h-4 text-purple-600\" />\n            <span className=\"text-sm font-medium text-purple-900\">AI Assistant</span>\n          </div>\n          <div className=\"flex items-center space-x-1\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-6 w-6 p-0 text-purple-600 hover:text-purple-800\"\n              onClick={() => setIsMinimized(!isMinimized)}\n            >\n              {isMinimized ? <Maximize2 className=\"w-3 h-3\" /> : <Minimize2 className=\"w-3 h-3\" />}\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-6 w-6 p-0 text-purple-600 hover:text-purple-800\"\n              onClick={() => setIsOpen(false)}\n            >\n              <X className=\"w-3 h-3\" />\n            </Button>\n          </div>\n        </div>\n\n        {!isMinimized && (\n          <>\n            {/* Messages */}\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-3 h-72\">\n              <div className=\"flex justify-start\">\n                <div className=\"flex items-start space-x-2 max-w-[85%]\">\n                  <div className=\"w-6 h-6 rounded-full flex items-center justify-center bg-purple-100 text-purple-600\">\n                    <Bot className=\"w-3 h-3\" />\n                  </div>\n                  <Card className=\"bg-slate-50 border-slate-200\">\n                    <CardContent className=\"p-2\">\n                      <p className=\"text-xs\">\n                        Hello! I'm your AI construction estimating assistant. Ask me about takeoffs, costs, or measurements.\n                      </p>\n                    </CardContent>\n                  </Card>\n                </div>\n              </div>\n            </div>\n\n            {/* Input */}\n            <div className=\"p-3 border-t border-slate-200\">\n              <div className=\"flex space-x-2\">\n                <Input\n                  value={inputValue}\n                  onChange={(e) => setInputValue(e.target.value)}\n                  placeholder=\"Ask about takeoffs...\"\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.preventDefault();\n                      handleSendMessage();\n                    }\n                  }}\n                  className=\"flex-1 text-xs\"\n                />\n                <Button \n                  onClick={handleSendMessage}\n                  disabled={!inputValue.trim()}\n                  size=\"sm\"\n                  className=\"bg-purple-600 hover:bg-purple-700 px-2\"\n                >\n                  <Send className=\"w-3 h-3\" />\n                </Button>\n              </div>\n            </div>\n          </>\n        )}\n      </Card>\n    </div>\n  );\n}","size_bytes":4263},"client/src/components/businessman-icon.tsx":{"content":"interface BusinessmanIconProps {\n  className?: string;\n  size?: number;\n}\n\nexport default function BusinessmanIcon({ className = \"\", size = 24 }: BusinessmanIconProps) {\n  return (\n    <svg\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={className}\n    >\n      {/* Head */}\n      <circle\n        cx=\"12\"\n        cy=\"6.5\"\n        r=\"2.5\"\n        fill=\"currentColor\"\n        opacity=\"0.95\"\n      />\n      \n      {/* Body/Suit */}\n      <path\n        d=\"M12 10c-3 0-5.5 1.8-5.5 4v2.5c0 0.8 0.4 1.5 1.2 1.5h8.6c0.8 0 1.2-0.7 1.2-1.5V14c0-2.2-2.5-4-5.5-4z\"\n        fill=\"currentColor\"\n        opacity=\"0.85\"\n      />\n      \n      {/* Tie */}\n      <path\n        d=\"M12 10.8v5.4l-0.6-0.9c-0.15-0.25-0.15-0.65 0-0.9l0.6-0.9 0.6 0.9c0.15 0.25 0.15 0.65 0 0.9L12 16.2v-5.4z\"\n        fill=\"currentColor\"\n        opacity=\"0.65\"\n      />\n      \n      {/* Hard Hat */}\n      <path\n        d=\"M9 4.5c0-1.7 1.3-3 3-3s3 1.3 3 3c0 0.3-0.1 0.6-0.2 0.8-0.3 0.2-0.8 0.2-1.1 0-0.6-0.4-1.4-0.4-2 0-0.3 0.2-0.8 0.2-1.1 0C9.1 5.1 9 4.8 9 4.5z\"\n        fill=\"currentColor\"\n        opacity=\"0.75\"\n      />\n      \n      {/* Blueprints/Plans */}\n      <rect\n        x=\"16\"\n        y=\"12\"\n        width=\"3.5\"\n        height=\"2.8\"\n        rx=\"0.3\"\n        fill=\"currentColor\"\n        opacity=\"0.6\"\n      />\n      <line\n        x1=\"16.5\"\n        y1=\"13\"\n        x2=\"19\"\n        y2=\"13\"\n        stroke=\"currentColor\"\n        strokeWidth=\"0.3\"\n        opacity=\"0.4\"\n      />\n      <line\n        x1=\"16.5\"\n        y1=\"13.8\"\n        x2=\"19\"\n        y2=\"13.8\"\n        stroke=\"currentColor\"\n        strokeWidth=\"0.3\"\n        opacity=\"0.4\"\n      />\n      \n      {/* Construction Tools */}\n      <rect\n        x=\"4\"\n        y=\"14\"\n        width=\"1.2\"\n        height=\"3.5\"\n        rx=\"0.2\"\n        fill=\"currentColor\"\n        opacity=\"0.55\"\n      />\n      <circle\n        cx=\"4.6\"\n        cy=\"13.5\"\n        r=\"0.5\"\n        fill=\"currentColor\"\n        opacity=\"0.55\"\n      />\n    </svg>\n  );\n}","size_bytes":2045},"client/src/components/calculator-robot-icon.tsx":{"content":"interface CalcuatorRobotIconProps {\n  className?: string;\n  size?: number;\n}\n\nexport default function CalculatorRobotIcon({ className = \"\", size = 20 }: CalcuatorRobotIconProps) {\n  return (\n    <svg\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={className}\n    >\n      {/* Robot Head/Calculator Body */}\n      <rect\n        x=\"4\"\n        y=\"3\"\n        width=\"16\"\n        height=\"18\"\n        rx=\"2\"\n        fill=\"currentColor\"\n        stroke=\"none\"\n      />\n      \n      {/* Calculator Screen */}\n      <rect\n        x=\"6\"\n        y=\"5\"\n        width=\"12\"\n        height=\"3\"\n        rx=\"0.5\"\n        fill=\"white\"\n        opacity=\"0.9\"\n      />\n      \n      {/* Robot Eyes (Calculator Buttons Row 1) */}\n      <circle cx=\"8\" cy=\"10.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"11\" cy=\"10.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"14\" cy=\"10.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"17\" cy=\"10.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      \n      {/* Calculator Buttons Row 2 */}\n      <circle cx=\"8\" cy=\"13\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"11\" cy=\"13\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"14\" cy=\"13\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"17\" cy=\"13\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      \n      {/* Calculator Buttons Row 3 */}\n      <circle cx=\"8\" cy=\"15.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"11\" cy=\"15.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"14\" cy=\"15.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <circle cx=\"17\" cy=\"15.5\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      \n      {/* Bottom Row */}\n      <circle cx=\"9.5\" cy=\"18\" r=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      <rect x=\"12\" y=\"17.2\" width=\"3.5\" height=\"1.6\" rx=\"0.8\" fill=\"white\" opacity=\"0.9\" />\n      \n      {/* Robot Antennae */}\n      <line x1=\"7\" y1=\"3\" x2=\"7\" y2=\"1\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <line x1=\"17\" y1=\"3\" x2=\"17\" y2=\"1\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <circle cx=\"7\" cy=\"1\" r=\"0.8\" fill=\"currentColor\" />\n      <circle cx=\"17\" cy=\"1\" r=\"0.8\" fill=\"currentColor\" />\n    </svg>\n  );\n}","size_bytes":2295},"client/src/components/cost-breakdown-chart.tsx":{"content":"import { useEffect, useRef } from 'react';\nimport { Chart, registerables } from 'chart.js';\nimport type { Takeoff } from '@shared/schema';\n\nChart.register(...registerables);\n\ninterface CostBreakdownChartProps {\n  takeoffs: Takeoff[];\n  chartType?: 'pie' | 'doughnut' | 'bar';\n  title?: string;\n}\n\nexport function CostBreakdownChart({ \n  takeoffs, \n  chartType = 'doughnut', \n  title = 'Cost Breakdown by Element Type' \n}: CostBreakdownChartProps) {\n  const chartRef = useRef<HTMLCanvasElement>(null);\n  const chartInstance = useRef<Chart | null>(null);\n\n  useEffect(() => {\n    if (!chartRef.current || !takeoffs.length) return;\n\n    // Destroy existing chart\n    if (chartInstance.current) {\n      chartInstance.current.destroy();\n    }\n\n    // Group takeoffs by element type and calculate totals\n    const groupedData = takeoffs.reduce((acc, takeoff) => {\n      const type = takeoff.elementType;\n      const cost = takeoff.totalCost || 0;\n      \n      if (!acc[type]) {\n        acc[type] = { cost: 0, count: 0 };\n      }\n      acc[type].cost += cost;\n      acc[type].count += 1;\n      \n      return acc;\n    }, {} as Record<string, { cost: number; count: number }>);\n\n    const labels = Object.keys(groupedData).map(key => \n      key.charAt(0).toUpperCase() + key.slice(1)\n    );\n    const costs = Object.values(groupedData).map(item => item.cost);\n    const counts = Object.values(groupedData).map(item => item.count);\n\n    // Color palette for different element types\n    const colors = [\n      '#3B82F6', // Blue - doors\n      '#10B981', // Green - windows  \n      '#F59E0B', // Amber - flooring\n      '#EF4444', // Red - electrical\n      '#8B5CF6', // Purple - plumbing\n      '#F97316', // Orange - HVAC\n      '#06B6D4', // Cyan - walls\n      '#84CC16'  // Lime - structural\n    ];\n\n    const ctx = chartRef.current.getContext('2d');\n    if (!ctx) return;\n\n    const config = {\n      type: chartType,\n      data: {\n        labels,\n        datasets: [{\n          label: 'Cost ($)',\n          data: costs,\n          backgroundColor: colors.slice(0, labels.length),\n          borderColor: colors.slice(0, labels.length),\n          borderWidth: 2\n        }]\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n          title: {\n            display: !!title,\n            text: title,\n            font: {\n              size: 16,\n              weight: 'bold' as const\n            },\n            padding: 20\n          },\n          legend: {\n            position: (chartType === 'bar' ? 'top' : 'right') as const,\n            labels: {\n              generateLabels: (chart: Chart) => {\n                const dataset = chart.data.datasets[0];\n                return labels.map((label, index) => ({\n                  text: `${label}: $${costs[index].toLocaleString()} (${counts[index]} items)`,\n                  fillStyle: colors[index],\n                  strokeStyle: colors[index],\n                  lineWidth: 2,\n                  hidden: false,\n                  index\n                }));\n              }\n            }\n          },\n          tooltip: {\n            callbacks: {\n              label: (context: any) => {\n                const label = context.label;\n                const value = context.parsed;\n                const count = counts[context.dataIndex];\n                const percentage = ((value / costs.reduce((a, b) => a + b, 0)) * 100).toFixed(1);\n                \n                return [\n                  `${label}: $${value.toLocaleString()}`,\n                  `${count} items (${percentage}%)`\n                ];\n              }\n            }\n          }\n        },\n        ...(chartType === 'bar' && {\n          scales: {\n            y: {\n              beginAtZero: true,\n              ticks: {\n                callback: (value: any) => `$${value.toLocaleString()}`\n              }\n            }\n          }\n        })\n      }\n    };\n\n    chartInstance.current = new Chart(ctx, config as any);\n\n    return () => {\n      if (chartInstance.current) {\n        chartInstance.current.destroy();\n      }\n    };\n  }, [takeoffs, chartType, title]);\n\n  if (!takeoffs.length) {\n    return (\n      <div className=\"flex items-center justify-center h-64 bg-slate-50 rounded-lg\">\n        <p className=\"text-slate-500\">No data available for chart</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative h-64 md:h-80\">\n      <canvas ref={chartRef} />\n    </div>\n  );\n}","size_bytes":4446},"client/src/components/drawing-viewer.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport FileUploadDialog from \"@/components/file-upload-dialog\";\nimport { \n  ZoomIn, \n  ZoomOut, \n  Maximize,\n  CheckCircle,\n  Loader2\n} from \"lucide-react\";\nimport type { Drawing } from \"@shared/schema\";\n\ninterface DrawingViewerProps {\n  drawing: Drawing | null;\n  onFileUpload?: (drawing: Drawing) => void;\n}\n\nexport default function DrawingViewer({ drawing, onFileUpload }: DrawingViewerProps) {\n  const [zoom, setZoom] = useState(100);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [offset, setOffset] = useState({ x: 0, y: 0 });\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const handleZoomIn = () => {\n    setZoom(prev => Math.min(prev + 25, 400));\n  };\n\n  const handleZoomOut = () => {\n    setZoom(prev => Math.max(prev - 25, 25));\n  };\n\n  const handleFitToScreen = () => {\n    setZoom(100);\n    setOffset({ x: 0, y: 0 });\n  };\n\n  const handleMouseDown = (e: React.MouseEvent) => {\n    setIsDragging(true);\n    setDragStart({ x: e.clientX - offset.x, y: e.clientY - offset.y });\n  };\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    if (!isDragging) return;\n    setOffset({\n      x: e.clientX - dragStart.x,\n      y: e.clientY - dragStart.y,\n    });\n  };\n\n  const handleMouseUp = () => {\n    setIsDragging(false);\n  };\n\n  if (!drawing) {\n    return <FileUploadDialog onFileUpload={onFileUpload || (() => {})} />;\n  }\n\n  const isProcessing = drawing.status === \"processing\";\n  const isComplete = drawing.status === \"complete\" && drawing.aiProcessed;\n  const isPdf = drawing.fileUrl?.toLowerCase().endsWith('.pdf');\n\n  return (\n    <div className=\"flex-1 bg-slate-100 relative overflow-hidden\">\n      {/* Zoom Controls */}\n      <div className=\"absolute top-4 left-4 z-10 flex items-center space-x-1 bg-white rounded-lg shadow-lg border border-slate-200 p-1\">\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomOut}>\n          <ZoomOut className=\"w-4 h-4\" />\n        </Button>\n        <span className=\"text-sm text-slate-600 px-2 min-w-[60px] text-center\">\n          {zoom}%\n        </span>\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomIn}>\n          <ZoomIn className=\"w-4 h-4\" />\n        </Button>\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleFitToScreen}>\n          <Maximize className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      {/* AI Status Indicator */}\n      <div className=\"absolute top-4 right-4 z-10 bg-white rounded-lg shadow-lg p-3 border border-slate-200\">\n        <div className=\"flex items-center space-x-2\">\n          {isProcessing ? (\n            <>\n              <Loader2 className=\"w-3 h-3 text-amber-500 animate-spin\" />\n              <span className=\"text-sm font-medium text-slate-700\">AI Processing...</span>\n            </>\n          ) : isComplete ? (\n            <>\n              <CheckCircle className=\"w-3 h-3 text-green-500\" />\n              <span className=\"text-sm font-medium text-slate-700\">AI Analysis Complete</span>\n            </>\n          ) : (\n            <>\n              <div className=\"w-3 h-3 bg-slate-400 rounded-full\" />\n              <span className=\"text-sm font-medium text-slate-700\">Ready for Analysis</span>\n            </>\n          )}\n        </div>\n        {isComplete && (\n          <p className=\"text-xs text-slate-500 mt-1\">\n            Detected: 8 doors, 12 windows, 6 rooms\n          </p>\n        )}\n      </div>\n\n      {/* Drawing Container */}\n      <div \n        ref={containerRef}\n        className=\"w-full h-full flex items-center justify-center p-8 cursor-grab active:cursor-grabbing\"\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n        onMouseLeave={handleMouseUp}\n      >\n        {/* Blueprint Image */}\n        <div \n          className=\"relative bg-white shadow-lg rounded-lg overflow-hidden\"\n          style={{\n            transform: `scale(${zoom / 100}) translate(${offset.x}px, ${offset.y}px)`,\n            transition: isDragging ? 'none' : 'transform 0.3s ease',\n          }}\n        >\n          {/* Actual Blueprint Display */}\n          {isPdf ? (\n            <iframe\n              src={drawing.fileUrl}\n              title={drawing.name}\n              className=\"w-[800px] h-[600px] border-0\"\n              onError={() => {\n                console.error('Failed to load PDF:', drawing.fileUrl);\n              }}\n            />\n          ) : (\n            <img\n              src={drawing.fileUrl}\n              alt={drawing.name}\n              className=\"max-w-[800px] max-h-[600px] object-contain\"\n              draggable={false}\n              onError={(e) => {\n                console.error('Failed to load drawing:', drawing.fileUrl);\n                // Fallback to a placeholder if image fails to load\n                (e.target as HTMLImageElement).src = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f8f9fa'/%3E%3Ctext x='200' y='150' text-anchor='middle' fill='%23666' font-family='Arial' font-size='16'%3EImage not found%3C/text%3E%3C/svg%3E\";\n              }}\n            />\n          )}\n          \n          {/* AI Detection Overlays */}\n          {isComplete && (\n            <div className=\"absolute inset-0 pointer-events-none\">\n              {/* Door Detection Markers */}\n              <div className=\"absolute top-1/3 left-1/4 w-4 h-4 bg-blue-500 border-2 border-white rounded-full shadow-lg animate-pulse\">\n                <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white text-xs px-2 py-1 rounded whitespace-nowrap\">\n                  Door (36\")\n                </div>\n              </div>\n              <div className=\"absolute top-1/2 left-1/3 w-4 h-4 bg-blue-500 border-2 border-white rounded-full shadow-lg animate-pulse\">\n                <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white text-xs px-2 py-1 rounded whitespace-nowrap\">\n                  Door (32\")\n                </div>\n              </div>\n              \n              {/* Window Detection Markers */}\n              <div className=\"absolute top-1/4 right-1/3 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-lg animate-pulse\">\n                <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-green-600 text-white text-xs px-2 py-1 rounded whitespace-nowrap\">\n                  Window (3'x4')\n                </div>\n              </div>\n              <div className=\"absolute bottom-1/3 right-1/4 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-lg animate-pulse\">\n                <div className=\"absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-green-600 text-white text-xs px-2 py-1 rounded whitespace-nowrap\">\n                  Window (2'x3')\n                </div>\n              </div>\n              \n              {/* Area Highlights */}\n              <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-24 border-2 border-amber-400 bg-amber-100 bg-opacity-30 rounded cursor-pointer hover:bg-opacity-50\">\n                <div className=\"absolute -top-6 left-0 bg-amber-500 text-white text-xs px-2 py-1 rounded\">\n                  Living Room: 245 sq ft\n                </div>\n              </div>\n\n              {/* Electrical Elements */}\n              <div className=\"absolute top-1/4 left-1/2 w-3 h-3 bg-yellow-500 border border-white rounded-full shadow\">\n                <div className=\"absolute -top-6 left-1/2 transform -translate-x-1/2 bg-yellow-600 text-white text-xs px-1 py-0.5 rounded\">\n                  Outlet\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Processing Overlay */}\n      {isProcessing && (\n        <div className=\"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center z-20\">\n          <div className=\"bg-white rounded-lg p-6 max-w-sm mx-4 shadow-xl\">\n            <div className=\"text-center\">\n              <Loader2 className=\"w-12 h-12 text-blueprint-600 animate-spin mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Processing Drawing</h3>\n              <p className=\"text-sm text-slate-600 mb-4\">\n                AI is analyzing your blueprint for doors, windows, and measurements...\n              </p>\n              <div className=\"w-full bg-slate-200 rounded-full h-2\">\n                <div className=\"bg-blueprint-600 h-2 rounded-full transition-all duration-300 w-2/3\"></div>\n              </div>\n              <p className=\"text-xs text-slate-500 mt-2\">This usually takes 30-60 seconds</p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8956},"client/src/components/file-upload-dialog.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Upload, \n  FileImage, \n  File,\n  X,\n  CheckCircle\n} from \"lucide-react\";\nimport type { Drawing } from \"@shared/schema\";\n\ninterface FileUploadDialogProps {\n  onFileUpload: (drawing: Drawing) => void;\n}\n\nexport default function FileUploadDialog({ onFileUpload }: FileUploadDialogProps) {\n  const [isDragOver, setIsDragOver] = useState(false);\n  const [uploadedFiles, setUploadedFiles] = useState<File[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const { toast } = useToast();\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragOver(true);\n  }, []);\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragOver(false);\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragOver(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    handleFiles(files);\n  }, []);\n\n  const handleFileSelect = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    handleFiles(files);\n  }, []);\n\n  const handleFiles = (files: File[]) => {\n    const validFiles = files.filter(file => {\n      const isValidType = file.type.includes('pdf') || \n                         file.type.includes('image') ||\n                         file.name.toLowerCase().endsWith('.pdf') ||\n                         file.name.toLowerCase().endsWith('.png') ||\n                         file.name.toLowerCase().endsWith('.jpg') ||\n                         file.name.toLowerCase().endsWith('.jpeg');\n      \n      const isValidSize = file.size <= 50 * 1024 * 1024; // 50MB limit\n      \n      if (!isValidType) {\n        toast({\n          title: \"Invalid file type\",\n          description: `${file.name} is not a supported format. Please upload PDF, PNG, or JPG files.`,\n          variant: \"destructive\",\n        });\n        return false;\n      }\n      \n      if (!isValidSize) {\n        toast({\n          title: \"File too large\",\n          description: `${file.name} exceeds the 50MB limit.`,\n          variant: \"destructive\",\n        });\n        return false;\n      }\n      \n      return true;\n    });\n\n    if (validFiles.length > 0) {\n      setUploadedFiles(validFiles);\n      // Automatically process files after upload\n      setTimeout(() => {\n        processFilesImmediately(validFiles);\n      }, 500);\n    }\n  };\n\n  const removeFile = (index: number) => {\n    setUploadedFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const processFiles = async () => {\n    if (uploadedFiles.length === 0) return;\n    processFilesImmediately(uploadedFiles);\n  };\n\n  const processFilesImmediately = async (filesToProcess: File[]) => {\n    setIsUploading(true);\n    \n    try {\n      const firstFile = filesToProcess[0];\n      \n      // Upload file to server\n      const formData = new FormData();\n      formData.append('file', firstFile);\n      \n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to upload file');\n      }\n      \n      const uploadResult = await response.json();\n      \n      // Create drawing object with actual file URL\n      const drawingData: Drawing = {\n        id: `drawing-${Date.now()}`,\n        projectId: \"\", // Will be set by the parent component when project is created\n        name: firstFile.name.replace(/\\.[^/.]+$/, \"\"),\n        filename: firstFile.name,\n        fileUrl: uploadResult.fileUrl, // Use actual uploaded file URL\n        fileType: firstFile.type,\n        status: \"complete\",\n        scale: \"1/4\\\" = 1'\",\n        aiProcessed: true,\n        uploadedAt: new Date(),\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n      \n      setIsUploading(false);\n      onFileUpload(drawingData);\n    } catch (error) {\n      console.error('File upload failed:', error);\n      setIsUploading(false);\n      toast({\n        title: \"Upload failed\",\n        description: error instanceof Error ? error.message : \"Failed to upload file\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const getFileIcon = (file: File) => {\n    if (file.type.includes('image')) {\n      return <FileImage className=\"w-5 h-5 text-blue-500\" />;\n    }\n    return <File className=\"w-5 h-5 text-red-500\" />;\n  };\n\n  return (\n    <div className=\"flex-1 bg-slate-50 flex items-center justify-center p-8\">\n      <div className=\"max-w-lg w-full\">\n        <div\n          className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\n            isDragOver \n              ? 'border-blue-500 bg-blue-50' \n              : 'border-slate-300 bg-white hover:border-slate-400'\n          }`}\n          onDragOver={handleDragOver}\n          onDragLeave={handleDragLeave}\n          onDrop={handleDrop}\n        >\n          <div className=\"mb-6\">\n            <Upload className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">\n              Drop files here to upload\n            </h3>\n            <p className=\"text-sm text-slate-600 mb-4\">\n              Upload blueprint PDFs or images for AI analysis\n            </p>\n            <p className=\"text-xs text-slate-500\">\n              Supports PDF, PNG, JPG files up to 50MB\n            </p>\n          </div>\n\n          <div className=\"space-y-4\">\n            <input\n              type=\"file\"\n              multiple\n              accept=\".pdf,.png,.jpg,.jpeg\"\n              onChange={handleFileSelect}\n              className=\"hidden\"\n              id=\"file-upload\"\n            />\n            <label htmlFor=\"file-upload\">\n              <Button asChild className=\"cursor-pointer\">\n                <span>Choose Files</span>\n              </Button>\n            </label>\n\n            {/* File List */}\n            {uploadedFiles.length > 0 && (\n              <div className=\"mt-6 space-y-2\">\n                <h4 className=\"text-sm font-medium text-slate-900 text-left\">\n                  Selected Files ({uploadedFiles.length})\n                </h4>\n                {uploadedFiles.map((file, index) => (\n                  <div key={index} className=\"flex items-center justify-between bg-slate-50 p-3 rounded-lg\">\n                    <div className=\"flex items-center space-x-3\">\n                      {getFileIcon(file)}\n                      <div className=\"text-left\">\n                        <p className=\"text-sm font-medium text-slate-900\">{file.name}</p>\n                        <p className=\"text-xs text-slate-500\">\n                          {(file.size / 1024 / 1024).toFixed(1)} MB\n                        </p>\n                      </div>\n                    </div>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => removeFile(index)}\n                      className=\"text-slate-400 hover:text-slate-600\"\n                    >\n                      <X className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                ))}\n                \n                <Button \n                  onClick={processFiles}\n                  disabled={isUploading}\n                  className=\"w-full mt-4 bg-purple-600 hover:bg-purple-700\"\n                >\n                  {isUploading ? (\n                    <>\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                      Processing...\n                    </>\n                  ) : (\n                    <>\n                      <CheckCircle className=\"w-4 h-4 mr-2\" />\n                      Process {uploadedFiles.length} file{uploadedFiles.length !== 1 ? 's' : ''}\n                    </>\n                  )}\n                </Button>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":8128},"client/src/components/interactive-floor-plan.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  ZoomIn, \n  ZoomOut, \n  Maximize,\n  CheckCircle,\n  Loader2\n} from \"lucide-react\";\nimport type { Drawing } from \"@shared/schema\";\n\ninterface FloorPlanElement {\n  id: string;\n  type: string;\n  coordinates: { x: number; y: number; width: number; height: number };\n  highlighted: boolean;\n}\n\ninterface InteractiveFloorPlanProps {\n  drawing: Drawing | null;\n  highlightedElement?: string | null;\n  activeViewMode?: 'view' | 'annotate';\n  activeTool?: 'ruler' | 'area' | 'count' | null;\n  selectedScale?: string;\n  onElementClick?: (elementId: string) => void;\n  onMeasurement?: (measurement: { type: string; value: string; coordinates: any }) => void;\n}\n\nexport default function InteractiveFloorPlan({ \n  drawing, \n  highlightedElement,\n  activeViewMode = 'view',\n  activeTool = null,\n  selectedScale = \"1/4\\\" = 1'\",\n  onElementClick,\n  onMeasurement\n}: InteractiveFloorPlanProps) {\n  const [zoom, setZoom] = useState(100);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [offset, setOffset] = useState({ x: 0, y: 0 });\n  const [measurements, setMeasurements] = useState<any[]>([]);\n  const [isDrawingMeasurement, setIsDrawingMeasurement] = useState(false);\n  const [measurementStart, setMeasurementStart] = useState<{ x: number; y: number } | null>(null);\n  const [currentMeasurement, setCurrentMeasurement] = useState<{ x: number; y: number } | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  \n  // Mock floor plan elements - in real implementation, these would come from AI analysis\n  const [floorPlanElements, setFloorPlanElements] = useState<FloorPlanElement[]>([\n    { id: 'door-1', type: 'doors', coordinates: { x: 150, y: 200, width: 40, height: 8 }, highlighted: false },\n    { id: 'door-2', type: 'doors', coordinates: { x: 300, y: 150, width: 8, height: 40 }, highlighted: false },\n    { id: 'door-3', type: 'doors', coordinates: { x: 450, y: 300, width: 40, height: 8 }, highlighted: false },\n    { id: 'window-1', type: 'windows', coordinates: { x: 100, y: 50, width: 80, height: 8 }, highlighted: false },\n    { id: 'window-2', type: 'windows', coordinates: { x: 400, y: 50, width: 60, height: 8 }, highlighted: false },\n    { id: 'window-3', type: 'windows', coordinates: { x: 500, y: 200, width: 8, height: 80 }, highlighted: false },\n    { id: 'electrical-1', type: 'electrical', coordinates: { x: 200, y: 250, width: 12, height: 12 }, highlighted: false },\n    { id: 'electrical-2', type: 'electrical', coordinates: { x: 350, y: 280, width: 12, height: 12 }, highlighted: false },\n    { id: 'electrical-3', type: 'electrical', coordinates: { x: 180, y: 180, width: 12, height: 12 }, highlighted: false },\n  ]);\n\n  // Update highlighted elements when prop changes\n  useEffect(() => {\n    setFloorPlanElements(prev => \n      prev.map(element => ({\n        ...element,\n        highlighted: highlightedElement === element.type\n      }))\n    );\n  }, [highlightedElement]);\n\n  const handleZoomIn = () => {\n    setZoom(prev => Math.min(prev + 25, 400));\n  };\n\n  const handleZoomOut = () => {\n    setZoom(prev => Math.max(prev - 25, 25));\n  };\n\n  const handleFitToScreen = () => {\n    setZoom(100);\n    setOffset({ x: 0, y: 0 });\n  };\n\n  const handleMouseDown = (e: React.MouseEvent) => {\n    const rect = containerRef.current?.getBoundingClientRect();\n    if (!rect) return;\n    \n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    \n    if (activeViewMode === 'annotate' && activeTool === 'ruler') {\n      if (!isDrawingMeasurement) {\n        setIsDrawingMeasurement(true);\n        setMeasurementStart({ x, y });\n      } else {\n        // Complete the measurement\n        const distance = Math.sqrt(\n          Math.pow(x - measurementStart!.x, 2) + Math.pow(y - measurementStart!.y, 2)\n        );\n        const scaledDistance = convertPixelsToFeet(distance, selectedScale);\n        \n        const newMeasurement = {\n          id: Date.now(),\n          type: 'linear',\n          start: measurementStart,\n          end: { x, y },\n          value: `${scaledDistance.toFixed(1)} ft`,\n        };\n        \n        setMeasurements(prev => [...prev, newMeasurement]);\n        onMeasurement?.({\n          type: newMeasurement.type,\n          value: newMeasurement.value,\n          coordinates: { start: newMeasurement.start, end: newMeasurement.end }\n        });\n        setIsDrawingMeasurement(false);\n        setMeasurementStart(null);\n        setCurrentMeasurement(null);\n      }\n    } else if (activeViewMode === 'view' || !activeTool) {\n      setIsDragging(true);\n      setDragStart({ x: e.clientX - offset.x, y: e.clientY - offset.y });\n    }\n  };\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    if (isDragging) {\n      setOffset({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y,\n      });\n    } else if (isDrawingMeasurement && measurementStart) {\n      const rect = containerRef.current?.getBoundingClientRect();\n      if (rect) {\n        setCurrentMeasurement({\n          x: e.clientX - rect.left,\n          y: e.clientY - rect.top,\n        });\n      }\n    }\n  };\n\n  const handleMouseUp = () => {\n    setIsDragging(false);\n  };\n\n  const getElementColor = (type: string, highlighted: boolean) => {\n    const colors = {\n      doors: highlighted ? '#ef4444' : '#dc2626',\n      windows: highlighted ? '#3b82f6' : '#2563eb',\n      electrical: highlighted ? '#eab308' : '#ca8a04',\n      flooring: highlighted ? '#22c55e' : '#16a34a',\n    };\n    return colors[type as keyof typeof colors] || '#6b7280';\n  };\n\n  const getElementOpacity = (highlighted: boolean, hasHighlight: boolean) => {\n    if (!hasHighlight) return 0.8;\n    return highlighted ? 1.0 : 0.3;\n  };\n\n  const convertPixelsToFeet = (pixels: number, scale: string) => {\n    // Convert pixels to feet based on scale\n    // This is a simplified conversion - in reality you'd need actual drawing scale\n    const scaleFactors: { [key: string]: number } = {\n      \"1/4\\\" = 1'\": 48,  // 1/4 inch = 1 foot, so 48 pixels per foot\n      \"1/8\\\" = 1'\": 96,  // 1/8 inch = 1 foot, so 96 pixels per foot  \n      \"1/2\\\" = 1'\": 24,  // 1/2 inch = 1 foot, so 24 pixels per foot\n      \"1\\\" = 1'\": 12,    // 1 inch = 1 foot, so 12 pixels per foot\n    };\n    return pixels / (scaleFactors[scale] || 48);\n  };\n\n  if (!drawing) {\n    return (\n      <div className=\"flex-1 bg-slate-100 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 bg-slate-200 rounded-lg flex items-center justify-center mx-auto mb-4\">\n            <Maximize className=\"w-8 h-8 text-slate-400\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const isProcessing = drawing.status === \"processing\";\n  const isComplete = drawing.status === \"complete\" && drawing.aiProcessed;\n\n  return (\n    <div className=\"flex-1 bg-slate-100 relative overflow-hidden\">\n      {/* Zoom Controls */}\n      <div className=\"absolute top-4 left-4 z-10 flex items-center space-x-1 bg-white rounded-lg shadow-lg border border-slate-200 p-1\">\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomOut}>\n          <ZoomOut className=\"w-4 h-4\" />\n        </Button>\n        <span className=\"text-sm text-slate-600 px-2 min-w-[60px] text-center\">\n          {zoom}%\n        </span>\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomIn}>\n          <ZoomIn className=\"w-4 h-4\" />\n        </Button>\n        <Button variant=\"ghost\" size=\"sm\" onClick={handleFitToScreen}>\n          <Maximize className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      {/* Status Indicator */}\n      <div className=\"absolute top-4 right-4 z-10 flex items-center space-x-2 bg-white rounded-lg shadow-lg border border-slate-200 px-3 py-2\">\n        {isProcessing && (\n          <>\n            <Loader2 className=\"w-4 h-4 text-blue-500 animate-spin\" />\n            <span className=\"text-sm text-slate-700\">Processing...</span>\n          </>\n        )}\n        {isComplete && (\n          <>\n            <CheckCircle className=\"w-4 h-4 text-green-500\" />\n            <span className=\"text-sm text-slate-700\">Analysis Complete</span>\n          </>\n        )}\n      </div>\n\n      {/* Element Legend */}\n      {isComplete && (\n        <div className=\"absolute bottom-4 left-4 z-10 bg-white rounded-lg shadow-lg border border-slate-200 p-3\">\n          <h3 className=\"text-sm font-medium text-slate-900 mb-2\">Detected Elements</h3>\n          <div className=\"flex flex-wrap gap-2\">\n            <Badge variant=\"outline\" className=\"text-red-600 border-red-200\">\n              <div className=\"w-2 h-2 bg-red-600 rounded-full mr-1\"></div>\n              Doors\n            </Badge>\n            <Badge variant=\"outline\" className=\"text-blue-600 border-blue-200\">\n              <div className=\"w-2 h-2 bg-blue-600 rounded-full mr-1\"></div>\n              Windows\n            </Badge>\n            <Badge variant=\"outline\" className=\"text-yellow-600 border-yellow-200\">\n              <div className=\"w-2 h-2 bg-yellow-600 rounded-full mr-1\"></div>\n              Electrical\n            </Badge>\n          </div>\n        </div>\n      )}\n\n      {/* Drawing Canvas */}\n      <div\n        ref={containerRef}\n        className={`absolute inset-0 ${\n          activeViewMode === 'view' || !activeTool \n            ? 'cursor-grab active:cursor-grabbing' \n            : activeTool === 'ruler' \n              ? 'cursor-crosshair' \n              : activeTool === 'count'\n                ? 'cursor-pointer'\n                : 'cursor-default'\n        }`}\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n        onMouseLeave={handleMouseUp}\n      >\n        {/* Actual Drawing Display */}\n        <div\n          className=\"bg-white border-2 border-slate-300 relative transition-transform duration-200\"\n          style={{\n            width: '800px',\n            height: '600px',\n            transform: `translate(${50 + offset.x}px, ${50 + offset.y}px) scale(${zoom / 100})`,\n            transformOrigin: 'top left',\n          }}\n        >\n          {/* Display the actual drawing file */}\n          {drawing.fileUrl && (\n            <img\n              src={drawing.fileUrl}\n              alt={drawing.name}\n              className=\"w-full h-full object-contain\"\n              onError={(e) => {\n                // Fallback to URL.createObjectURL if direct path doesn't work\n                const target = e.target as HTMLImageElement;\n                console.warn('Failed to load drawing from:', drawing.fileUrl);\n              }}\n            />\n          )}\n          \n          {/* Fallback mock layout if image fails to load */}\n          {!drawing.fileUrl && (\n            <>\n              <div className=\"absolute inset-4 border-2 border-slate-400\">\n                <div className=\"absolute top-0 left-1/3 w-px h-full bg-slate-300\"></div>\n                <div className=\"absolute top-1/2 left-0 w-full h-px bg-slate-300\"></div>\n              </div>\n              <div className=\"absolute top-8 left-8 text-xs text-slate-500 font-medium\">Living Room</div>\n              <div className=\"absolute top-8 right-8 text-xs text-slate-500 font-medium\">Kitchen</div>\n              <div className=\"absolute bottom-8 left-8 text-xs text-slate-500 font-medium\">Bedroom</div>\n              <div className=\"absolute bottom-8 right-8 text-xs text-slate-500 font-medium\">Bathroom</div>\n            </>\n          )}\n\n          {/* Interactive Elements */}\n          {isComplete && floorPlanElements.map((element) => (\n            <div\n              key={element.id}\n              className={`absolute transition-all duration-300 cursor-pointer ${\n                element.highlighted ? 'animate-pulse shadow-lg' : ''\n              }`}\n              style={{\n                left: `${element.coordinates.x}px`,\n                top: `${element.coordinates.y}px`,\n                width: `${element.coordinates.width}px`,\n                height: `${element.coordinates.height}px`,\n                backgroundColor: getElementColor(element.type, element.highlighted),\n                opacity: getElementOpacity(element.highlighted, !!highlightedElement),\n                transform: element.highlighted ? 'scale(1.2)' : 'scale(1)',\n                zIndex: element.highlighted ? 10 : 5,\n              }}\n              onClick={() => onElementClick?.(element.id)}\n              title={`${element.type} - ${element.id}`}\n            />\n          ))}\n        </div>\n\n        {/* Measurements Overlay - Separate SVG */}\n        <svg \n          className=\"absolute inset-0 pointer-events-none\"\n          style={{\n            transform: `translate(${50 + offset.x}px, ${50 + offset.y}px) scale(${zoom / 100})`,\n            transformOrigin: 'top left',\n          }}\n        >\n          {/* Arrow marker definition */}\n          <defs>\n            <marker\n              id=\"arrowhead\"\n              markerWidth=\"10\"\n              markerHeight=\"7\"\n              refX=\"9\"\n              refY=\"3.5\"\n              orient=\"auto\"\n            >\n              <polygon\n                points=\"0 0, 10 3.5, 0 7\"\n                fill=\"#ef4444\"\n              />\n            </marker>\n          </defs>\n\n          {/* Measurements */}\n          {measurements.map((measurement) => (\n            <g key={measurement.id}>\n              <line\n                x1={measurement.start.x}\n                y1={measurement.start.y}\n                x2={measurement.end.x}\n                y2={measurement.end.y}\n                stroke=\"#ef4444\"\n                strokeWidth=\"2\"\n                markerEnd=\"url(#arrowhead)\"\n              />\n              <text\n                x={(measurement.start.x + measurement.end.x) / 2}\n                y={(measurement.start.y + measurement.end.y) / 2 - 10}\n                fill=\"#ef4444\"\n                fontSize=\"12\"\n                textAnchor=\"middle\"\n                className=\"font-medium\"\n              >\n                {measurement.value}\n              </text>\n            </g>\n          ))}\n\n          {/* Current measurement being drawn */}\n          {isDrawingMeasurement && measurementStart && currentMeasurement && (\n            <g>\n              <line\n                x1={measurementStart.x}\n                y1={measurementStart.y}\n                x2={currentMeasurement.x}\n                y2={currentMeasurement.y}\n                stroke=\"#ef4444\"\n                strokeWidth=\"2\"\n                strokeDasharray=\"5,5\"\n              />\n            </g>\n          )}\n        </svg>\n      </div>\n    </div>\n  );\n}","size_bytes":14693},"client/src/components/layout.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Bell, User, Home, Folder, BarChart3, Settings, DollarSign } from \"lucide-react\";\nimport estimagentLogo from \"@/assets/estimagent-logo.png\";\n\ninterface LayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function Layout({ children }: LayoutProps) {\n  const [location] = useLocation();\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      {/* Header */}\n      <header className=\"bg-white border-b border-slate-200 shadow-sm\">\n        <div className=\"relative flex items-center px-6 py-4\">\n          {/* Logo - Fixed Left */}\n          <div className=\"flex items-center\">\n            <Link href=\"/\">\n              <div className=\"flex items-center cursor-pointer\">\n                <img \n                  src={estimagentLogo} \n                  alt=\"Calculator Logo\" \n                  className=\"h-20 w-20 object-contain\"\n                />\n              </div>\n            </Link>\n          </div>\n\n          {/* Absolutely Centered Navigation */}\n          <div className=\"absolute left-1/2 transform -translate-x-1/2 hidden md:flex items-center space-x-1\">\n            <Link href=\"/\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className={\n                  location === \"/\"\n                    ? \"text-blueprint-700 bg-blueprint-50 hover:bg-blueprint-100\"\n                    : \"text-slate-600 hover:text-blueprint-700\"\n                }\n              >\n                <Home className=\"w-4 h-4 mr-2\" />\n                Dashboard\n              </Button>\n            </Link>\n            <Link href=\"/projects\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className={\n                  location === \"/projects\"\n                    ? \"text-blueprint-700 bg-blueprint-50 hover:bg-blueprint-100\"\n                    : \"text-slate-600 hover:text-blueprint-700\"\n                }\n              >\n                <Folder className=\"w-4 h-4 mr-2\" />\n                Projects\n              </Button>\n            </Link>\n\n            <Link href=\"/reports\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className={\n                  location === \"/reports\"\n                    ? \"text-blueprint-700 bg-blueprint-50 hover:bg-blueprint-100\"\n                    : \"text-slate-600 hover:text-blueprint-700\"\n                }\n              >\n                <BarChart3 className=\"w-4 h-4 mr-2\" />\n                Reports\n              </Button>\n            </Link>\n\n            <Link href=\"/advanced-cost-management\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className={\n                  location === \"/advanced-cost-management\"\n                    ? \"text-blueprint-700 bg-blueprint-50 hover:bg-blueprint-100\"\n                    : \"text-slate-600 hover:text-blueprint-700\"\n                }\n              >\n                <DollarSign className=\"w-4 h-4 mr-2\" />\n                Advanced Costs\n              </Button>\n            </Link>\n          </div>\n\n          {/* Right side placeholder for balance */}\n          <div className=\"flex items-center ml-auto\">\n            {/* Empty space for header balance */}\n          </div>\n        </div>\n      </header>\n\n      {/* Page Content */}\n      {children}\n    </div>\n  );\n}\n","size_bytes":3447},"client/src/components/llm-takeoff-processor.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  Brain, \n  Upload, \n  Loader2, \n  CheckCircle, \n  AlertCircle,\n  Eye,\n  Download,\n  RefreshCw\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Drawing, Takeoff } from \"@shared/schema\";\n\ninterface LLMTakeoffProcessorProps {\n  drawing: Drawing;\n  onAnalysisComplete?: () => void;\n}\n\ninterface AnalysisStatus {\n  stage: 'uploading' | 'preprocessing' | 'analyzing' | 'extracting' | 'calculating' | 'complete' | 'error';\n  progress: number;\n  message: string;\n  elementsFound?: number;\n  confidence?: number;\n}\n\ninterface LLMAnalysisResult {\n  elementType: string;\n  elements: Array<{\n    id: string;\n    type: string;\n    quantity: number;\n    dimensions?: {\n      width?: number;\n      height?: number;\n      area?: number;\n      length?: number;\n    };\n    location: {\n      x: number;\n      y: number;\n    };\n    confidence: number;\n    attributes?: Record<string, any>;\n  }>;\n}\n\nexport default function LLMTakeoffProcessor({ drawing, onAnalysisComplete }: LLMTakeoffProcessorProps) {\n  const [analysisStatus, setAnalysisStatus] = useState<AnalysisStatus | null>(null);\n  const [analysisResults, setAnalysisResults] = useState<LLMAnalysisResult[]>([]);\n  const { toast } = useToast();\n\n  const { data: existingTakeoffs = [] } = useQuery<Takeoff[]>({\n    queryKey: [\"/api/drawings\", drawing.id, \"takeoffs\"],\n    enabled: !!drawing.id,\n  });\n\n  const runLLMAnalysisMutation = useMutation({\n    mutationFn: async (elementTypes: string[]) => {\n      setAnalysisStatus({\n        stage: 'uploading',\n        progress: 10,\n        message: 'Uploading floorplan to LLM processor...'\n      });\n\n      // Simulate LLM processing stages\n      const stages = [\n        { stage: 'preprocessing', progress: 25, message: 'Preprocessing floorplan image...', delay: 1000 },\n        { stage: 'analyzing', progress: 50, message: 'Running AI analysis on floorplan...', delay: 3000 },\n        { stage: 'extracting', progress: 75, message: 'Extracting building elements...', delay: 2000 },\n        { stage: 'calculating', progress: 90, message: 'Calculating quantities and costs...', delay: 1000 },\n        { stage: 'complete', progress: 100, message: 'Analysis complete!', delay: 500 }\n      ];\n\n      for (const stage of stages) {\n        await new Promise(resolve => setTimeout(resolve, stage.delay));\n        setAnalysisStatus({\n          ...stage,\n          stage: stage.stage as AnalysisStatus['stage'],\n          elementsFound: stage.stage === 'extracting' ? Math.floor(Math.random() * 20) + 10 : undefined,\n          confidence: stage.stage === 'complete' ? Math.random() * 0.2 + 0.8 : undefined\n        });\n      }\n\n      // Call the actual API\n      return apiRequest(`/api/drawings/${drawing.id}/run-llm-takeoff`, \"POST\", { \n        elementTypes,\n        llmModel: \"floorplan-analyzer-v2\",\n        enhancedAnalysis: true \n      });\n    },\n    onSuccess: (data: any) => {\n      toast({\n        title: \"LLM Analysis Complete\",\n        description: `Successfully analyzed ${data.elementsProcessed || 'multiple'} elements with ${Math.round((data.averageConfidence || 0.85) * 100)}% confidence`,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/drawings\", drawing.id, \"takeoffs\"] });\n      onAnalysisComplete?.();\n    },\n    onError: (error) => {\n      setAnalysisStatus({\n        stage: 'error',\n        progress: 0,\n        message: 'Analysis failed. Please try again.'\n      });\n      toast({\n        title: \"Analysis Failed\",\n        description: \"The LLM analysis encountered an error. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const reprocessTakeoffMutation = useMutation({\n    mutationFn: async (takeoffId: string) => {\n      return apiRequest(`/api/takeoffs/${takeoffId}/reprocess`, \"POST\", {\n        useAdvancedLLM: true,\n        recalculateCosts: true\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Reprocessing Complete\",\n        description: \"Takeoff has been reprocessed with enhanced accuracy\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/drawings\", drawing.id, \"takeoffs\"] });\n    },\n  });\n\n  const handleRunAnalysis = () => {\n    // Default to all element types for comprehensive analysis\n    const allElementTypes = ['doors', 'windows', 'flooring', 'walls', 'electrical', 'plumbing', 'hvac', 'structural'];\n    runLLMAnalysisMutation.mutate(allElementTypes);\n  };\n\n  const groupedTakeoffs = (existingTakeoffs as Takeoff[]).reduce((acc: Record<string, Takeoff[]>, takeoff: Takeoff) => {\n    if (!acc[takeoff.elementType]) {\n      acc[takeoff.elementType] = [];\n    }\n    acc[takeoff.elementType].push(takeoff);\n    return acc;\n  }, {});\n\n  return (\n    <div className=\"space-y-6\">\n      {/* LLM Analysis Control Panel */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <Brain className=\"w-5 h-5 text-purple-600\" />\n            <span>AI Floorplan Analysis</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {!analysisStatus ? (\n            <div className=\"space-y-4\">\n              <p className=\"text-sm text-slate-600\">\n                Use our trained LLM model to automatically detect and quantify building elements from your floorplan.\n              </p>\n              <div className=\"flex items-center justify-between\">\n                <div className=\"space-y-1\">\n                  <p className=\"text-sm font-medium\">Enhanced Analysis Ready</p>\n                  <p className=\"text-xs text-slate-500\">\n                    Model: floorplan-analyzer-v2 | Trained on 10K+ construction drawings\n                  </p>\n                </div>\n                <Button \n                  onClick={handleRunAnalysis}\n                  disabled={runLLMAnalysisMutation.isPending}\n                  className=\"bg-purple-600 hover:bg-purple-700\"\n                >\n                  <Brain className=\"w-4 h-4 mr-2\" />\n                  Run AI Analysis\n                </Button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  {analysisStatus.stage === 'complete' ? (\n                    <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                  ) : analysisStatus.stage === 'error' ? (\n                    <AlertCircle className=\"w-5 h-5 text-red-600\" />\n                  ) : (\n                    <Loader2 className=\"w-5 h-5 animate-spin text-purple-600\" />\n                  )}\n                  <span className=\"text-sm font-medium\">\n                    {analysisStatus.message}\n                  </span>\n                </div>\n                {analysisStatus.elementsFound && (\n                  <Badge variant=\"outline\">\n                    {analysisStatus.elementsFound} elements found\n                  </Badge>\n                )}\n              </div>\n              \n              <Progress value={analysisStatus.progress} className=\"h-2\" />\n              \n              {analysisStatus.confidence && (\n                <div className=\"flex items-center justify-between text-xs text-slate-600\">\n                  <span>Analysis Confidence: {Math.round(analysisStatus.confidence * 100)}%</span>\n                  <span>Stage: {analysisStatus.stage}</span>\n                </div>\n              )}\n\n              {analysisStatus.stage === 'complete' && (\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={() => setAnalysisStatus(null)}\n                >\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\n                  Run New Analysis\n                </Button>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Takeoff Results by Element Type */}\n      {Object.keys(groupedTakeoffs).length > 0 && (\n        <div className=\"space-y-4\">\n          <h3 className=\"text-lg font-semibold\">Analysis Results</h3>\n          \n          {Object.entries(groupedTakeoffs).map(([elementType, takeoffs]: [string, Takeoff[]]) => (\n            <Card key={elementType}>\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"capitalize text-base\">\n                    {elementType} ({takeoffs.length} items)\n                  </CardTitle>\n                  <div className=\"flex items-center space-x-2\">\n                    <Badge variant=\"secondary\">\n                      AI Detected: {takeoffs.filter((t: Takeoff) => t.detectedByAi).length}\n                    </Badge>\n                    <Button variant=\"outline\" size=\"sm\">\n                      <Eye className=\"w-4 h-4 mr-1\" />\n                      View on Plan\n                    </Button>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {takeoffs.map((takeoff: Takeoff) => (\n                    <div key={takeoff.id} className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <span className=\"font-medium text-sm\">{takeoff.elementName}</span>\n                          {takeoff.detectedByAi && (\n                            <Badge variant=\"outline\" className=\"text-xs\">AI</Badge>\n                          )}\n                        </div>\n                        <div className=\"text-xs text-slate-600\">\n                          Qty: {takeoff.quantity} {takeoff.unit}\n                          {takeoff.area && ` | Area: ${takeoff.area} sq ft`}\n                          {takeoff.length && ` | Length: ${takeoff.length} ft`}\n                        </div>\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-sm font-medium\">\n                          ${takeoff.totalCost?.toLocaleString() || 0}\n                        </span>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"sm\"\n                          onClick={() => reprocessTakeoffMutation.mutate(takeoff.id)}\n                          disabled={reprocessTakeoffMutation.isPending}\n                        >\n                          <RefreshCw className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {/* Summary Statistics */}\n      {(existingTakeoffs as Takeoff[]).length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Project Summary</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">\n                  {(existingTakeoffs as Takeoff[]).filter((t: Takeoff) => t.elementType === 'doors').reduce((sum: number, t: Takeoff) => sum + (t.quantity || 0), 0)}\n                </div>\n                <div className=\"text-xs text-slate-600\">Doors</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-cyan-600\">\n                  {(existingTakeoffs as Takeoff[]).filter((t: Takeoff) => t.elementType === 'windows').reduce((sum: number, t: Takeoff) => sum + (t.quantity || 0), 0)}\n                </div>\n                <div className=\"text-xs text-slate-600\">Windows</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-amber-600\">\n                  {(existingTakeoffs as Takeoff[]).filter((t: Takeoff) => t.elementType === 'flooring').reduce((sum: number, t: Takeoff) => sum + (t.area || 0), 0).toLocaleString()}\n                </div>\n                <div className=\"text-xs text-slate-600\">Sq Ft Floor</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">\n                  ${(existingTakeoffs as Takeoff[]).reduce((sum: number, t: Takeoff) => sum + (t.totalCost || 0), 0).toLocaleString()}\n                </div>\n                <div className=\"text-xs text-slate-600\">Total Cost</div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":13122},"client/src/components/progress-photos.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Camera, Upload, X, Calendar, MapPin } from \"lucide-react\";\n\ninterface ProgressPhoto {\n  id: string;\n  url: string;\n  filename: string;\n  description: string;\n  location: string;\n  takenAt: Date;\n  tags: string[];\n}\n\ninterface ProgressPhotosProps {\n  projectId: string;\n  photos?: ProgressPhoto[];\n  onPhotosUpdate?: (photos: ProgressPhoto[]) => void;\n}\n\nexport function ProgressPhotos({ projectId, photos = [], onPhotosUpdate }: ProgressPhotosProps) {\n  const [isAddingPhoto, setIsAddingPhoto] = useState(false);\n  const [newPhoto, setNewPhoto] = useState({\n    description: \"\",\n    location: \"\",\n    tags: \"\"\n  });\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string>(\"\");\n  \n  const { toast } = useToast();\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"Invalid File Type\",\n        description: \"Please select an image file (PNG, JPG, etc.)\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate file size (max 10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      toast({\n        title: \"File Too Large\",\n        description: \"Please select an image smaller than 10MB\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setSelectedFile(file);\n    \n    // Create preview\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      setPreviewUrl(e.target?.result as string);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleAddPhoto = async () => {\n    if (!selectedFile) {\n      toast({\n        title: \"No Image Selected\",\n        description: \"Please select an image to upload\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      // In a real implementation, you'd upload to your server/cloud storage\n      // For now, we'll simulate with a local URL\n      const photoUrl = previewUrl;\n      \n      const newProgressPhoto: ProgressPhoto = {\n        id: `photo-${Date.now()}`,\n        url: photoUrl,\n        filename: selectedFile.name,\n        description: newPhoto.description,\n        location: newPhoto.location,\n        takenAt: new Date(),\n        tags: newPhoto.tags.split(',').map(tag => tag.trim()).filter(Boolean)\n      };\n\n      const updatedPhotos = [...photos, newProgressPhoto];\n      onPhotosUpdate?.(updatedPhotos);\n\n      // Reset form\n      setNewPhoto({ description: \"\", location: \"\", tags: \"\" });\n      setSelectedFile(null);\n      setPreviewUrl(\"\");\n      setIsAddingPhoto(false);\n\n      toast({\n        title: \"Photo Added\",\n        description: \"Progress photo has been added successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Upload Failed\",\n        description: \"Failed to add progress photo. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleRemovePhoto = (photoId: string) => {\n    const updatedPhotos = photos.filter(photo => photo.id !== photoId);\n    onPhotosUpdate?.(updatedPhotos);\n    \n    toast({\n      title: \"Photo Removed\",\n      description: \"Progress photo has been removed\",\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Add Photo Button */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-slate-900\">Progress Photos</h3>\n          <p className=\"text-sm text-slate-600\">Document project progress with photos and annotations</p>\n        </div>\n        \n        <Dialog open={isAddingPhoto} onOpenChange={setIsAddingPhoto}>\n          <DialogTrigger asChild>\n            <Button>\n              <Camera className=\"w-4 h-4 mr-2\" />\n              Add Photo\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>Add Progress Photo</DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"space-y-6\">\n              {/* File Upload */}\n              <div>\n                <Label htmlFor=\"photo-upload\">Photo</Label>\n                <div className=\"mt-2\">\n                  <Input\n                    id=\"photo-upload\"\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleFileSelect}\n                    className=\"mb-4\"\n                  />\n                  \n                  {previewUrl && (\n                    <div className=\"relative\">\n                      <img\n                        src={previewUrl}\n                        alt=\"Preview\"\n                        className=\"w-full h-48 object-cover rounded-lg border\"\n                      />\n                      <Button\n                        size=\"sm\"\n                        variant=\"destructive\"\n                        className=\"absolute top-2 right-2\"\n                        onClick={() => {\n                          setSelectedFile(null);\n                          setPreviewUrl(\"\");\n                        }}\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Description */}\n              <div>\n                <Label htmlFor=\"photo-description\">Description</Label>\n                <Textarea\n                  id=\"photo-description\"\n                  value={newPhoto.description}\n                  onChange={(e) => setNewPhoto({\n                    ...newPhoto,\n                    description: e.target.value\n                  })}\n                  placeholder=\"Describe what this photo shows...\"\n                  rows={3}\n                />\n              </div>\n\n              {/* Location */}\n              <div>\n                <Label htmlFor=\"photo-location\">Location/Area</Label>\n                <Input\n                  id=\"photo-location\"\n                  value={newPhoto.location}\n                  onChange={(e) => setNewPhoto({\n                    ...newPhoto,\n                    location: e.target.value\n                  })}\n                  placeholder=\"e.g., Kitchen, Second Floor, Foundation\"\n                />\n              </div>\n\n              {/* Tags */}\n              <div>\n                <Label htmlFor=\"photo-tags\">Tags (comma-separated)</Label>\n                <Input\n                  id=\"photo-tags\"\n                  value={newPhoto.tags}\n                  onChange={(e) => setNewPhoto({\n                    ...newPhoto,\n                    tags: e.target.value\n                  })}\n                  placeholder=\"e.g., framing, electrical, before, after\"\n                />\n              </div>\n\n              <div className=\"flex space-x-2 pt-4\">\n                <Button onClick={handleAddPhoto} className=\"flex-1\">\n                  <Upload className=\"w-4 h-4 mr-2\" />\n                  Add Photo\n                </Button>\n                <Button variant=\"outline\" onClick={() => setIsAddingPhoto(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Photos Grid */}\n      {photos.length > 0 ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {photos.map((photo) => (\n            <Card key={photo.id}>\n              <CardHeader className=\"pb-2\">\n                <div className=\"relative\">\n                  <img\n                    src={photo.url}\n                    alt={photo.description}\n                    className=\"w-full h-48 object-cover rounded-lg\"\n                  />\n                  <Button\n                    size=\"sm\"\n                    variant=\"destructive\"\n                    className=\"absolute top-2 right-2 opacity-80 hover:opacity-100\"\n                    onClick={() => handleRemovePhoto(photo.id)}\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <p className=\"text-sm font-medium text-slate-900\">\n                  {photo.description || \"No description\"}\n                </p>\n                \n                {photo.location && (\n                  <div className=\"flex items-center text-xs text-slate-600\">\n                    <MapPin className=\"w-3 h-3 mr-1\" />\n                    {photo.location}\n                  </div>\n                )}\n                \n                <div className=\"flex items-center text-xs text-slate-500\">\n                  <Calendar className=\"w-3 h-3 mr-1\" />\n                  {photo.takenAt.toLocaleDateString()}\n                </div>\n                \n                {photo.tags.length > 0 && (\n                  <div className=\"flex flex-wrap gap-1 mt-2\">\n                    {photo.tags.map((tag, index) => (\n                      <span\n                        key={index}\n                        className=\"px-2 py-1 text-xs bg-slate-100 text-slate-700 rounded\"\n                      >\n                        {tag}\n                      </span>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <div className=\"text-center py-12 bg-slate-50 rounded-lg border-2 border-dashed border-slate-300\">\n          <Camera className=\"mx-auto h-12 w-12 text-slate-400\" />\n          <h3 className=\"mt-2 text-sm font-medium text-slate-900\">No progress photos</h3>\n          <p className=\"mt-1 text-sm text-slate-500\">\n            Start documenting your project by adding progress photos.\n          </p>\n          <Button\n            className=\"mt-4\"\n            onClick={() => setIsAddingPhoto(true)}\n          >\n            <Camera className=\"w-4 h-4 mr-2\" />\n            Add First Photo\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":10544},"client/src/components/project-sidebar.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport UploadZone from \"./upload-zone\";\nimport {\n  Settings,\n  Plus,\n  FileImage,\n  File,\n  Loader2,\n  CheckCircle,\n  Clock,\n  ChevronRight\n} from \"lucide-react\";\nimport type { Project, Drawing } from \"@shared/schema\";\n\ninterface ProjectSidebarProps {\n  currentProject: Project | null;\n  setCurrentProject: (project: Project) => void;\n  drawings: Drawing[];\n  selectedDrawing: Drawing | null;\n  setSelectedDrawing: (drawing: Drawing) => void;\n  isLoading: boolean;\n}\n\nexport default function ProjectSidebar({\n  currentProject,\n  drawings,\n  selectedDrawing,\n  setSelectedDrawing,\n  isLoading\n}: ProjectSidebarProps) {\n  const [showUpload, setShowUpload] = useState(false);\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"complete\":\n        return <CheckCircle className=\"w-2 h-2 text-green-500\" />;\n      case \"processing\":\n        return <Loader2 className=\"w-2 h-2 text-amber-500 animate-spin\" />;\n      default:\n        return <Clock className=\"w-2 h-2 text-slate-400\" />;\n    }\n  };\n\n  const getStatusText = (status: string, aiProcessed: boolean) => {\n    if (status === \"complete\" && aiProcessed) return \"AI Processing Complete\";\n    if (status === \"processing\") return \"Processing...\";\n    if (status === \"complete\") return \"Ready for Review\";\n    return \"Pending Analysis\";\n  };\n\n  const getDrawingIcon = (fileType: string) => {\n    return fileType === \"application/pdf\" ? File : FileImage;\n  };\n\n  return (\n    <aside className=\"w-80 bg-white border-r border-slate-200 flex flex-col\">\n      {/* Project Selector */}\n      <div className=\"p-6 border-b border-slate-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-lg font-semibold text-slate-900\">Current Project</h2>\n          <Button variant=\"ghost\" size=\"sm\">\n            <Settings className=\"w-4 h-4\" />\n          </Button>\n        </div>\n        \n        {currentProject && (\n          <div className=\"bg-slate-50 rounded-lg p-4\">\n            <h3 className=\"font-medium text-slate-900\">{currentProject.name}</h3>\n            <p className=\"text-sm text-slate-600 mt-1\">{currentProject.address}</p>\n            <div className=\"flex items-center mt-3 space-x-4\">\n              <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700\">\n                {currentProject.status}\n              </Badge>\n              <span className=\"text-xs text-slate-500\">Updated 2h ago</span>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Upload Section */}\n      <div className=\"p-6 border-b border-slate-200\">\n        <h3 className=\"text-sm font-semibold text-slate-900 mb-4\">Upload Drawings</h3>\n        \n        {!showUpload ? (\n          <div \n            className=\"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-blueprint-400 transition-colors cursor-pointer\"\n            onClick={() => setShowUpload(true)}\n          >\n            <div className=\"w-8 h-8 mx-auto mb-3 text-slate-400\">\n              <Plus className=\"w-full h-full\" />\n            </div>\n            <p className=\"text-sm font-medium text-slate-600 mb-1\">Drop files here or click to browse</p>\n            <p className=\"text-xs text-slate-500\">PDF, PNG, JPG up to 50MB</p>\n          </div>\n        ) : (\n          <UploadZone \n            projectId={currentProject?.id || \"\"} \n            onUploadComplete={() => setShowUpload(false)}\n            onCancel={() => setShowUpload(false)}\n          />\n        )}\n        \n        <Button \n          className=\"w-full mt-3 bg-blueprint-600 hover:bg-blueprint-700\"\n          onClick={() => setShowUpload(true)}\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add New Drawing\n        </Button>\n      </div>\n\n      {/* Drawing List */}\n      <div className=\"p-6 flex-1 overflow-y-auto\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-sm font-semibold text-slate-900\">Project Drawings</h3>\n          <Badge variant=\"outline\" className=\"text-xs\">\n            {drawings.length} files\n          </Badge>\n        </div>\n        \n        {isLoading ? (\n          <div className=\"space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"bg-slate-100 rounded-lg p-3 animate-pulse\">\n                <div className=\"h-4 bg-slate-200 rounded mb-2\"></div>\n                <div className=\"h-3 bg-slate-200 rounded w-2/3\"></div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {drawings.map((drawing) => {\n              const Icon = getDrawingIcon(drawing.fileType);\n              const isSelected = selectedDrawing?.id === drawing.id;\n              const isProcessingComplete = drawing.status === \"complete\" && drawing.aiProcessed;\n              \n              return (\n                <div\n                  key={drawing.id}\n                  className={`rounded-lg p-3 cursor-pointer transition-colors ${\n                    isSelected\n                      ? \"bg-blueprint-50 border border-blueprint-200\"\n                      : \"bg-white border border-slate-200 hover:bg-slate-50\"\n                  }`}\n                  onClick={() => setSelectedDrawing(drawing)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-3\">\n                      <Icon className={`w-4 h-4 ${isSelected ? \"text-blueprint-600\" : \"text-slate-600\"}`} />\n                      <div>\n                        <p className=\"text-sm font-medium text-slate-900\">{drawing.name}</p>\n                        <p className=\"text-xs text-slate-500\">\n                          {getStatusText(drawing.status, drawing.aiProcessed || false)}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-1\">\n                      {getStatusIcon(drawing.status)}\n                      <ChevronRight className=\"w-3 h-3 text-slate-400\" />\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n            \n            {drawings.length === 0 && (\n              <div className=\"text-center py-8\">\n                <FileImage className=\"w-8 h-8 text-slate-400 mx-auto mb-2\" />\n                <p className=\"text-sm text-slate-600\">No drawings uploaded yet</p>\n                <p className=\"text-xs text-slate-500\">Upload your first drawing to get started</p>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </aside>\n  );\n}\n","size_bytes":6739},"client/src/components/realtime-analysis-panel.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  Brain,\n  CheckCircle,\n  Loader2,\n  Eye,\n  Square,\n  DoorOpen,\n  Zap,\n  Droplets,\n  Wind,\n  Hammer,\n  Download,\n  RefreshCw\n} from \"lucide-react\";\nimport type { Drawing } from \"@shared/schema\";\n\ninterface AnalysisStep {\n  id: string;\n  name: string;\n  status: 'pending' | 'processing' | 'complete';\n  progress: number;\n  icon: React.ComponentType<{ className?: string }>;\n}\n\ninterface TakeoffResult {\n  type: string;\n  count: number;\n  unit: string;\n  details: string[];\n  icon: React.ComponentType<{ className?: string }>;\n  color: string;\n}\n\ninterface RealtimeAnalysisPanelProps {\n  drawing: Drawing | null;\n  selectedTypes: string[];\n  isAnalyzing: boolean;\n  onStartAnalysis: () => void;\n  onElementHover?: (elementType: string | null) => void;\n}\n\nexport default function RealtimeAnalysisPanel({ \n  drawing, \n  selectedTypes, \n  isAnalyzing,\n  onStartAnalysis,\n  onElementHover \n}: RealtimeAnalysisPanelProps) {\n  const [analysisSteps, setAnalysisSteps] = useState<AnalysisStep[]>([\n    { id: 'preprocessing', name: 'Image Preprocessing', status: 'pending', progress: 0, icon: Eye },\n    { id: 'detection', name: 'Element Detection', status: 'pending', progress: 0, icon: Brain },\n    { id: 'measurement', name: 'Measurements', status: 'pending', progress: 0, icon: Square },\n    { id: 'calculation', name: 'Calculations', status: 'pending', progress: 0, icon: CheckCircle }\n  ]);\n\n  const [results, setResults] = useState<TakeoffResult[]>([]);\n\n  useEffect(() => {\n    if (!isAnalyzing) {\n      setAnalysisSteps(steps => steps.map(step => ({ \n        ...step, \n        status: 'pending', \n        progress: 0 \n      })));\n      setResults([]);\n      return;\n    }\n\n    // Simulate real-time analysis progress\n    const runAnalysis = async () => {\n      for (let i = 0; i < analysisSteps.length; i++) {\n        const step = analysisSteps[i];\n        \n        // Start processing this step\n        setAnalysisSteps(prev => prev.map(s => \n          s.id === step.id ? { ...s, status: 'processing' } : s\n        ));\n\n        // Simulate progress\n        for (let progress = 0; progress <= 100; progress += 10) {\n          await new Promise(resolve => setTimeout(resolve, 200));\n          setAnalysisSteps(prev => prev.map(s => \n            s.id === step.id ? { ...s, progress } : s\n          ));\n        }\n\n        // Complete this step\n        setAnalysisSteps(prev => prev.map(s => \n          s.id === step.id ? { ...s, status: 'complete', progress: 100 } : s\n        ));\n\n        // Add results after all steps complete\n        if (step.id === 'calculation') {\n          setTimeout(() => {\n            generateResults();\n          }, 500);\n        }\n      }\n    };\n\n    runAnalysis();\n  }, [isAnalyzing]);\n\n  const generateResults = () => {\n    const mockResults: TakeoffResult[] = [];\n\n    if (selectedTypes.includes('doors')) {\n      mockResults.push({\n        type: 'Doors',\n        count: 8,\n        unit: 'each',\n        details: ['3x Interior (32\")', '2x Interior (28\")', '2x Exterior (36\")', '1x Bathroom (24\")'],\n        icon: DoorOpen,\n        color: 'text-blue-600 bg-blue-50'\n      });\n    }\n\n    if (selectedTypes.includes('windows')) {\n      mockResults.push({\n        type: 'Windows',\n        count: 12,\n        unit: 'each',\n        details: ['4x Living Room (3\\'x4\\')', '6x Bedroom (2\\'x3\\')', '2x Kitchen (1.5\\'x2\\')'],\n        icon: Square,\n        color: 'text-cyan-600 bg-cyan-50'\n      });\n    }\n\n    if (selectedTypes.includes('electrical')) {\n      mockResults.push({\n        type: 'Electrical',\n        count: 24,\n        unit: 'each',\n        details: ['16x Outlets', '6x Light Switches', '2x GFCI Outlets'],\n        icon: Zap,\n        color: 'text-yellow-600 bg-yellow-50'\n      });\n    }\n\n    if (selectedTypes.includes('flooring')) {\n      mockResults.push({\n        type: 'Flooring',\n        count: 1850,\n        unit: 'sq ft',\n        details: ['Living: 420 sq ft', 'Bedrooms: 680 sq ft', 'Kitchen: 280 sq ft', 'Other: 470 sq ft'],\n        icon: Square,\n        color: 'text-amber-600 bg-amber-50'\n      });\n    }\n\n    setResults(mockResults);\n  };\n\n  if (!drawing) {\n    return (\n      <div className=\"flex-1 bg-white border-l border-slate-200 flex flex-col overflow-hidden\">\n        <div className=\"p-4 border-b border-slate-200\">\n          <h2 className=\"text-lg font-semibold text-slate-900\">AI Analysis</h2>\n          <p className=\"text-sm text-slate-600\">Real-time takeoff processing</p>\n        </div>\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <Brain className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n            <p className=\"text-sm text-slate-600\">Upload a drawing to begin analysis</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex-1 bg-white border-l border-slate-200 flex flex-col overflow-hidden\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-slate-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-lg font-semibold text-slate-900\">AI Analysis</h2>\n            <p className=\"text-sm text-slate-600\">Real-time takeoff processing</p>\n          </div>\n          {!isAnalyzing && results.length > 0 && (\n            <Button\n              onClick={onStartAnalysis}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-purple-600 border-purple-200 hover:bg-purple-50\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-1\" />\n              Rerun\n            </Button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto\">\n        {/* Analysis Progress */}\n        {isAnalyzing && (\n          <div className=\"p-4 border-b border-slate-200\">\n            <h3 className=\"text-sm font-medium text-slate-900 mb-3\">Processing Steps</h3>\n            <div className=\"space-y-3\">\n              {analysisSteps.map((step) => {\n                const IconComponent = step.icon;\n                return (\n                  <div key={step.id} className=\"flex items-center space-x-3\">\n                    <div className={`w-8 h-8 rounded-full flex items-center justify-center ${\n                      step.status === 'complete' ? 'bg-green-100 text-green-600' :\n                      step.status === 'processing' ? 'bg-blue-100 text-blue-600' :\n                      'bg-slate-100 text-slate-400'\n                    }`}>\n                      {step.status === 'processing' ? (\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\n                      ) : step.status === 'complete' ? (\n                        <CheckCircle className=\"w-4 h-4\" />\n                      ) : (\n                        <IconComponent className=\"w-4 h-4\" />\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"text-sm font-medium text-slate-900\">{step.name}</span>\n                        {step.status === 'processing' && (\n                          <span className=\"text-xs text-slate-500\">{step.progress}%</span>\n                        )}\n                      </div>\n                      {step.status !== 'pending' && (\n                        <Progress value={step.progress} className=\"h-1\" />\n                      )}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Results - Only show after analysis is complete */}\n        {!isAnalyzing && results.length > 0 && (\n          <div className=\"p-4 animate-fade-in\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold text-slate-900\">Takeoff Results</h3>\n              <Badge variant=\"secondary\" className=\"bg-green-100 text-green-800\">\n                Analysis Complete\n              </Badge>\n            </div>\n\n            <div className=\"space-y-4\">\n              {results.map((result, index) => {\n                const IconComponent = result.icon;\n                return (\n                  <Card \n                    key={index} \n                    className={`${result.color} border shadow-sm hover:shadow-md transition-shadow cursor-pointer`}\n                    onMouseEnter={() => onElementHover?.(result.type.toLowerCase())}\n                    onMouseLeave={() => onElementHover?.(null)}\n                  >\n                    <CardHeader className=\"pb-3\">\n                      <CardTitle className=\"text-base flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"p-2 rounded-lg bg-white/80\">\n                            <IconComponent className=\"w-5 h-5\" />\n                          </div>\n                          <span className=\"font-semibold\">{result.type}</span>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-lg font-bold text-slate-900\">{result.count}</div>\n                          <div className=\"text-xs text-slate-600 uppercase tracking-wide\">{result.unit}</div>\n                        </div>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"pt-0\">\n                      <div className=\"space-y-2\">\n                        {result.details.map((detail, i) => (\n                          <div key={i} className=\"flex items-center text-sm text-slate-700\">\n                            <div className=\"w-2 h-2 bg-slate-400 rounded-full mr-3 flex-shrink-0\"></div>\n                            <span>{detail}</span>\n                          </div>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n\n            {/* Summary Stats */}\n            <div className=\"mt-6 p-4 bg-slate-50 rounded-lg border\">\n              <h4 className=\"text-sm font-medium text-slate-900 mb-3\">Analysis Summary</h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-slate-600\">Categories:</span>\n                  <span className=\"ml-2 font-medium\">{results.length}</span>\n                </div>\n                <div>\n                  <span className=\"text-slate-600\">Total Items:</span>\n                  <span className=\"ml-2 font-medium\">\n                    {results.reduce((sum, r) => sum + r.count, 0)}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Export Button */}\n            <Button className=\"w-full mt-4 bg-green-600 hover:bg-green-700 text-white shadow-sm\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export Detailed Report\n            </Button>\n          </div>\n        )}\n\n        {/* Empty State */}\n        {!isAnalyzing && results.length === 0 && selectedTypes.length > 0 && (\n          <div className=\"flex-1 flex items-center justify-center p-8\">\n            <div className=\"text-center\">\n              <Brain className=\"w-12 h-12 text-purple-400 mx-auto mb-4\" />\n              <p className=\"text-sm text-slate-600 mb-4\">\n                Ready to analyze {selectedTypes.length} element type{selectedTypes.length !== 1 ? 's' : ''}\n              </p>\n              <Button \n                onClick={onStartAnalysis}\n                className=\"bg-purple-600 hover:bg-purple-700\"\n              >\n                Start Analysis\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":12051},"client/src/components/report-generator.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ReportGenerator } from \"@/lib/reportGenerator\";\nimport { \n  FileText, \n  Download, \n  Building, \n  TrendingUp, \n  Users, \n  Settings,\n  Loader2\n} from \"lucide-react\";\nimport type { Project, Takeoff, Drawing, SavedAnalysis } from \"@shared/schema\";\n\ninterface ReportGeneratorProps {\n  project: Project;\n  takeoffs: Takeoff[];\n  drawings: Drawing[];\n  analyses?: SavedAnalysis[];\n}\n\ninterface CompanySettings {\n  name: string;\n  address: string;\n  phone: string;\n  email: string;\n  logo?: string;\n}\n\nexport function ReportGeneratorComponent({ project, takeoffs, drawings, analyses }: ReportGeneratorProps) {\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [companySettings, setCompanySettings] = useState<CompanySettings>({\n    name: \"EstimAgent Construction Services\",\n    address: \"123 Business St, Suite 100, City, State 12345\",\n    phone: \"(555) 123-4567\",\n    email: \"contact@estimagent.com\"\n  });\n  const [selectedAnalysis, setSelectedAnalysis] = useState<string>(\"\");\n  \n  const { toast } = useToast();\n  const reportGen = new ReportGenerator();\n\n  const handleGenerateReport = async (reportType: 'executive' | 'detailed' | 'comparison') => {\n    setIsGenerating(true);\n    try {\n      let blob: Blob;\n      let filename: string;\n\n      const reportData = {\n        project,\n        takeoffs,\n        drawings,\n        analyses\n      };\n\n      switch (reportType) {\n        case 'executive':\n          blob = await reportGen.generateExecutiveSummary(reportData, companySettings);\n          filename = `${project.name}-executive-summary.pdf`;\n          break;\n        \n        case 'detailed':\n          blob = await reportGen.generateDetailedCostReport(reportData, companySettings);\n          filename = `${project.name}-detailed-cost-report.pdf`;\n          break;\n        \n        case 'comparison':\n          // For now, compare current state with itself - in real implementation,\n          // this would compare with a saved analysis or previous version\n          blob = await reportGen.generateComparisonReport(reportData, reportData, companySettings);\n          filename = `${project.name}-comparison-report.pdf`;\n          break;\n        \n        default:\n          throw new Error('Unknown report type');\n      }\n\n      // Download the generated PDF\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = filename;\n      a.click();\n      URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Report Generated\",\n        description: `${reportType === 'executive' ? 'Executive Summary' : reportType === 'detailed' ? 'Detailed Cost Report' : 'Comparison Report'} has been downloaded successfully.`,\n      });\n    } catch (error) {\n      console.error('Error generating report:', error);\n      toast({\n        title: \"Report Generation Failed\",\n        description: \"There was an error generating the report. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  const reportStats = {\n    totalItems: takeoffs.length,\n    totalCost: takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0),\n    verifiedItems: takeoffs.filter(t => t.verified).length,\n    elementTypes: new Set(takeoffs.map(t => t.elementType)).size\n  };\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button className=\"bg-blue-600 hover:bg-blue-700\">\n          <FileText className=\"w-4 h-4 mr-2\" />\n          Generate Reports\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Professional Report Generator</DialogTitle>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"reports\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"reports\">Generate Reports</TabsTrigger>\n            <TabsTrigger value=\"settings\">Company Settings</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"reports\" className=\"space-y-6\">\n            {/* Report Statistics */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-blue-600\">{reportStats.totalItems}</div>\n                  <div className=\"text-sm text-slate-600\">Total Items</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-green-600\">${reportStats.totalCost.toLocaleString()}</div>\n                  <div className=\"text-sm text-slate-600\">Total Cost</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-purple-600\">{reportStats.verifiedItems}</div>\n                  <div className=\"text-sm text-slate-600\">Verified</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-orange-600\">{reportStats.elementTypes}</div>\n                  <div className=\"text-sm text-slate-600\">Element Types</div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Report Types */}\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              {/* Executive Summary */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <Users className=\"w-5 h-5 mr-2 text-blue-600\" />\n                    Executive Summary\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-slate-600\">\n                    High-level overview with project metrics, cost summary, and key insights for stakeholders and executives.\n                  </p>\n                  <ul className=\"text-xs text-slate-500 space-y-1\">\n                    <li>â€¢ Project overview and timeline</li>\n                    <li>â€¢ Cost summary by category</li>\n                    <li>â€¢ Key performance metrics</li>\n                    <li>â€¢ Professional branding</li>\n                  </ul>\n                  <Button \n                    onClick={() => handleGenerateReport('executive')}\n                    disabled={isGenerating}\n                    className=\"w-full\"\n                  >\n                    {isGenerating ? (\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    ) : (\n                      <Download className=\"w-4 h-4 mr-2\" />\n                    )}\n                    Generate Executive Report\n                  </Button>\n                </CardContent>\n              </Card>\n\n              {/* Detailed Cost Report */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <Building className=\"w-5 h-5 mr-2 text-green-600\" />\n                    Detailed Cost Report\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-slate-600\">\n                    Comprehensive breakdown of all materials, labor costs, and quantities organized by element type.\n                  </p>\n                  <ul className=\"text-xs text-slate-500 space-y-1\">\n                    <li>â€¢ Item-by-item cost breakdown</li>\n                    <li>â€¢ Material vs labor separation</li>\n                    <li>â€¢ Quantity and unit details</li>\n                    <li>â€¢ Verification status tracking</li>\n                  </ul>\n                  <Button \n                    onClick={() => handleGenerateReport('detailed')}\n                    disabled={isGenerating}\n                    className=\"w-full bg-green-600 hover:bg-green-700\"\n                  >\n                    {isGenerating ? (\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    ) : (\n                      <Download className=\"w-4 h-4 mr-2\" />\n                    )}\n                    Generate Detailed Report\n                  </Button>\n                </CardContent>\n              </Card>\n\n              {/* Comparison Report */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <TrendingUp className=\"w-5 h-5 mr-2 text-purple-600\" />\n                    Comparison Report\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-slate-600\">\n                    Compare original estimates with revised versions to track changes and scope modifications.\n                  </p>\n                  \n                  {analyses && analyses.length > 0 && (\n                    <div>\n                      <Label htmlFor=\"analysis-select\" className=\"text-xs\">Compare Against:</Label>\n                      <Select value={selectedAnalysis} onValueChange={setSelectedAnalysis}>\n                        <SelectTrigger className=\"mt-1\">\n                          <SelectValue placeholder=\"Select saved analysis\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {analyses.map((analysis) => (\n                            <SelectItem key={analysis.id} value={analysis.id}>\n                              {analysis.name}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n                  \n                  <ul className=\"text-xs text-slate-500 space-y-1\">\n                    <li>â€¢ Side-by-side cost comparison</li>\n                    <li>â€¢ Change percentage analysis</li>\n                    <li>â€¢ Item-level differences</li>\n                    <li>â€¢ Impact assessment</li>\n                  </ul>\n                  <Button \n                    onClick={() => handleGenerateReport('comparison')}\n                    disabled={isGenerating}\n                    className=\"w-full bg-purple-600 hover:bg-purple-700\"\n                  >\n                    {isGenerating ? (\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    ) : (\n                      <Download className=\"w-4 h-4 mr-2\" />\n                    )}\n                    Generate Comparison Report\n                  </Button>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"settings\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center\">\n                  <Settings className=\"w-5 h-5 mr-2\" />\n                  Company Information\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"company-name\">Company Name</Label>\n                    <Input\n                      id=\"company-name\"\n                      value={companySettings.name}\n                      onChange={(e) => setCompanySettings({\n                        ...companySettings,\n                        name: e.target.value\n                      })}\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"company-phone\">Phone Number</Label>\n                    <Input\n                      id=\"company-phone\"\n                      value={companySettings.phone}\n                      onChange={(e) => setCompanySettings({\n                        ...companySettings,\n                        phone: e.target.value\n                      })}\n                    />\n                  </div>\n                </div>\n                \n                <div>\n                  <Label htmlFor=\"company-email\">Email Address</Label>\n                  <Input\n                    id=\"company-email\"\n                    type=\"email\"\n                    value={companySettings.email}\n                    onChange={(e) => setCompanySettings({\n                      ...companySettings,\n                      email: e.target.value\n                    })}\n                  />\n                </div>\n                \n                <div>\n                  <Label htmlFor=\"company-address\">Business Address</Label>\n                  <Textarea\n                    id=\"company-address\"\n                    value={companySettings.address}\n                    onChange={(e) => setCompanySettings({\n                      ...companySettings,\n                      address: e.target.value\n                    })}\n                    rows={3}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":13965},"client/src/components/reports-dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { CostBreakdownChart } from \"./cost-breakdown-chart\";\nimport { ProgressPhotos } from \"./progress-photos\";\nimport { ReportGeneratorComponent } from \"./report-generator\";\nimport { \n  BarChart, \n  FileText, \n  TrendingUp, \n  Camera,\n  Download,\n  Eye,\n  Calendar,\n  DollarSign,\n  CheckCircle\n} from \"lucide-react\";\nimport type { Project, Takeoff, Drawing, SavedAnalysis } from \"@shared/schema\";\n\ninterface ReportsDashboardProps {\n  project: Project;\n  takeoffs: Takeoff[];\n  drawings: Drawing[];\n  analyses?: SavedAnalysis[];\n}\n\nexport function ReportsDashboard({ \n  project, \n  takeoffs, \n  drawings, \n  analyses = [] \n}: ReportsDashboardProps) {\n  const [selectedChartType, setSelectedChartType] = useState<'pie' | 'doughnut' | 'bar'>('doughnut');\n  \n  // Calculate key metrics\n  const totalCost = takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n  const materialCost = totalCost * 0.6; // Estimated material cost\n  const laborCost = totalCost * 0.4; // Estimated labor cost\n  const verifiedItems = takeoffs.filter(t => t.verified).length;\n  const aiDetectedItems = takeoffs.filter(t => t.detectedByAi).length;\n  const manuallyEditedItems = takeoffs.filter(t => t.manuallyEdited).length;\n\n  // Group by element type for analysis\n  const elementTypeBreakdown = takeoffs.reduce((acc, takeoff) => {\n    const type = takeoff.elementType;\n    if (!acc[type]) {\n      acc[type] = { count: 0, cost: 0 };\n    }\n    acc[type].count += 1;\n    acc[type].cost += takeoff.totalCost || 0;\n    return acc;\n  }, {} as Record<string, { count: number; cost: number }>);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Report Generation */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-slate-900\">Project Reports & Analytics</h3>\n          <p className=\"text-sm text-slate-600\">\n            Generate professional reports and analyze project metrics\n          </p>\n        </div>\n        <ReportGeneratorComponent\n          project={project}\n          takeoffs={takeoffs}\n          drawings={drawings}\n          analyses={analyses}\n        />\n      </div>\n\n      {/* Key Metrics Cards */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <DollarSign className=\"w-8 h-8 mx-auto text-green-600 mb-2\" />\n            <div className=\"text-2xl font-bold text-slate-900\">${totalCost.toLocaleString()}</div>\n            <div className=\"text-sm text-slate-600\">Total Project Cost</div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <CheckCircle className=\"w-8 h-8 mx-auto text-blue-600 mb-2\" />\n            <div className=\"text-2xl font-bold text-slate-900\">\n              {takeoffs.length > 0 ? Math.round((verifiedItems / takeoffs.length) * 100) : 0}%\n            </div>\n            <div className=\"text-sm text-slate-600\">Verified Items</div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <BarChart className=\"w-8 h-8 mx-auto text-purple-600 mb-2\" />\n            <div className=\"text-2xl font-bold text-slate-900\">{Object.keys(elementTypeBreakdown).length}</div>\n            <div className=\"text-sm text-slate-600\">Element Types</div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <TrendingUp className=\"w-8 h-8 mx-auto text-orange-600 mb-2\" />\n            <div className=\"text-2xl font-bold text-slate-900\">{aiDetectedItems}</div>\n            <div className=\"text-sm text-slate-600\">AI Detected</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Cost Analysis */}\n      <div className=\"grid md:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              Cost Breakdown by Element Type\n              <div className=\"flex space-x-1\">\n                <Button\n                  size=\"sm\"\n                  variant={selectedChartType === 'doughnut' ? 'default' : 'outline'}\n                  onClick={() => setSelectedChartType('doughnut')}\n                >\n                  Donut\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant={selectedChartType === 'pie' ? 'default' : 'outline'}\n                  onClick={() => setSelectedChartType('pie')}\n                >\n                  Pie\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant={selectedChartType === 'bar' ? 'default' : 'outline'}\n                  onClick={() => setSelectedChartType('bar')}\n                >\n                  Bar\n                </Button>\n              </div>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <CostBreakdownChart \n              takeoffs={takeoffs} \n              chartType={selectedChartType}\n            />\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Material vs Labor Cost Analysis</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium\">Material Costs (60%)</span>\n                <span className=\"text-sm font-bold\">${materialCost.toLocaleString()}</span>\n              </div>\n              <div className=\"w-full bg-slate-200 rounded-full h-2\">\n                <div className=\"bg-blue-600 h-2 rounded-full\" style={{ width: '60%' }}></div>\n              </div>\n            </div>\n            \n            <div>\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium\">Labor Costs (40%)</span>\n                <span className=\"text-sm font-bold\">${laborCost.toLocaleString()}</span>\n              </div>\n              <div className=\"w-full bg-slate-200 rounded-full h-2\">\n                <div className=\"bg-green-600 h-2 rounded-full\" style={{ width: '40%' }}></div>\n              </div>\n            </div>\n\n            <div className=\"pt-4 border-t\">\n              <div className=\"text-sm text-slate-600 space-y-1\">\n                <div>â€¢ Material costs typically range 50-70% of total</div>\n                <div>â€¢ Labor costs typically range 30-50% of total</div>\n                <div>â€¢ Ratios may vary by project complexity</div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Element Type Breakdown Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Detailed Element Type Breakdown</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left p-2\">Element Type</th>\n                  <th className=\"text-right p-2\">Item Count</th>\n                  <th className=\"text-right p-2\">Total Cost</th>\n                  <th className=\"text-right p-2\">Average Cost/Item</th>\n                  <th className=\"text-right p-2\">% of Project</th>\n                </tr>\n              </thead>\n              <tbody>\n                {Object.entries(elementTypeBreakdown).map(([type, data]) => (\n                  <tr key={type} className=\"border-b hover:bg-slate-50\">\n                    <td className=\"p-2 font-medium capitalize\">{type}</td>\n                    <td className=\"p-2 text-right\">{data.count}</td>\n                    <td className=\"p-2 text-right font-medium\">${data.cost.toLocaleString()}</td>\n                    <td className=\"p-2 text-right\">${Math.round(data.cost / data.count).toLocaleString()}</td>\n                    <td className=\"p-2 text-right\">\n                      {totalCost > 0 ? ((data.cost / totalCost) * 100).toFixed(1) : 0}%\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Project Quality Metrics */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Project Quality & Accuracy Metrics</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid md:grid-cols-3 gap-6\">\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-green-600 mb-2\">\n                {takeoffs.length > 0 ? Math.round((verifiedItems / takeoffs.length) * 100) : 0}%\n              </div>\n              <div className=\"text-sm font-medium mb-1\">Verification Rate</div>\n              <div className=\"text-xs text-slate-500\">\n                {verifiedItems} of {takeoffs.length} items verified\n              </div>\n            </div>\n            \n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-blue-600 mb-2\">\n                {takeoffs.length > 0 ? Math.round((aiDetectedItems / takeoffs.length) * 100) : 0}%\n              </div>\n              <div className=\"text-sm font-medium mb-1\">AI Detection Rate</div>\n              <div className=\"text-xs text-slate-500\">\n                {aiDetectedItems} of {takeoffs.length} AI-detected\n              </div>\n            </div>\n            \n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-orange-600 mb-2\">\n                {takeoffs.length > 0 ? Math.round((manuallyEditedItems / takeoffs.length) * 100) : 0}%\n              </div>\n              <div className=\"text-sm font-medium mb-1\">Manual Edit Rate</div>\n              <div className=\"text-xs text-slate-500\">\n                {manuallyEditedItems} of {takeoffs.length} manually edited\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Progress Documentation */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center\">\n            <Camera className=\"w-5 h-5 mr-2\" />\n            Progress Documentation\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <ProgressPhotos\n            projectId={project.id}\n            photos={[]} // In real implementation, load from database\n            onPhotosUpdate={(photos) => {\n              // In real implementation, save to database\n              console.log('Updated photos:', photos);\n            }}\n          />\n        </CardContent>\n      </Card>\n\n      {/* Export Options */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center\">\n            <Download className=\"w-5 h-5 mr-2\" />\n            Export Options\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid md:grid-cols-3 gap-4\">\n            <Button variant=\"outline\" className=\"h-auto p-4 flex flex-col items-center space-y-2\">\n              <FileText className=\"w-6 h-6 text-blue-600\" />\n              <div className=\"text-center\">\n                <div className=\"font-medium\">Executive Summary</div>\n                <div className=\"text-xs text-slate-500\">High-level overview for stakeholders</div>\n              </div>\n            </Button>\n            \n            <Button variant=\"outline\" className=\"h-auto p-4 flex flex-col items-center space-y-2\">\n              <BarChart className=\"w-6 h-6 text-green-600\" />\n              <div className=\"text-center\">\n                <div className=\"font-medium\">Detailed Analysis</div>\n                <div className=\"text-xs text-slate-500\">Complete cost breakdown</div>\n              </div>\n            </Button>\n            \n            <Button variant=\"outline\" className=\"h-auto p-4 flex flex-col items-center space-y-2\">\n              <TrendingUp className=\"w-6 h-6 text-purple-600\" />\n              <div className=\"text-center\">\n                <div className=\"font-medium\">Progress Report</div>\n                <div className=\"text-xs text-slate-500\">Timeline and milestones</div>\n              </div>\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":12431},"client/src/components/takeoff-panel.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { \n  DoorOpen, \n  Square, \n  Zap, \n  Droplets,\n  Calculator,\n  Edit,\n  Download\n} from \"lucide-react\";\nimport type { Drawing, Takeoff } from \"@shared/schema\";\n\ninterface TakeoffPanelProps {\n  drawing: Drawing | null;\n}\n\ninterface TakeoffSummary {\n  doors: { total: number; interior36: number; interior32: number; entry: number };\n  windows: { total: number; doubleHung: number; casement: number; picture: number };\n  flooring: { hardwood: number; tile: number; carpet: number; total: number };\n  electrical: { outlets: number; lights: number; switches: number };\n  walls: { length: number };\n  costs: { materials: number; labor: number; total: number };\n}\n\nexport default function TakeoffPanel({ drawing }: TakeoffPanelProps) {\n  const { data: takeoffs = [], isLoading } = useQuery({\n    queryKey: [\"/api/drawings\", drawing?.id, \"takeoffs\"],\n    enabled: !!drawing?.id,\n  });\n\n  if (!drawing) {\n    return (\n      <div className=\"w-96 bg-white border-l border-slate-200 flex flex-col\">\n        <div className=\"p-4 border-b border-slate-200\">\n          <h2 className=\"text-lg font-semibold text-slate-900\">Takeoff Results</h2>\n          <p className=\"text-sm text-slate-600\">Select a drawing to view takeoff data</p>\n        </div>\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <Calculator className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n            <p className=\"text-sm text-slate-600\">No drawing selected</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Process takeoffs into summary\n  const summary: TakeoffSummary = {\n    doors: { total: 0, interior36: 0, interior32: 0, entry: 0 },\n    windows: { total: 0, doubleHung: 0, casement: 0, picture: 0 },\n    flooring: { hardwood: 0, tile: 0, carpet: 0, total: 0 },\n    electrical: { outlets: 0, lights: 0, switches: 0 },\n    walls: { length: 0 },\n    costs: { materials: 0, labor: 0, total: 0 },\n  };\n\n  if (takeoffs) {\n    takeoffs.forEach((takeoff: Takeoff) => {\n      const cost = takeoff.totalCost || 0;\n      summary.costs.total += cost;\n\n      switch (takeoff.elementType) {\n        case \"doors\":\n          summary.doors.total += takeoff.quantity || 0;\n          if (takeoff.elementName.includes(\"36\")) {\n            summary.doors.interior36 += takeoff.quantity || 0;\n          } else if (takeoff.elementName.includes(\"32\")) {\n            summary.doors.interior32 += takeoff.quantity || 0;\n          } else if (takeoff.elementName.toLowerCase().includes(\"entry\")) {\n            summary.doors.entry += takeoff.quantity || 0;\n          }\n          break;\n        case \"windows\":\n          summary.windows.total += takeoff.quantity || 0;\n          if (takeoff.elementName.toLowerCase().includes(\"double hung\")) {\n            summary.windows.doubleHung += takeoff.quantity || 0;\n          } else if (takeoff.elementName.toLowerCase().includes(\"casement\")) {\n            summary.windows.casement += takeoff.quantity || 0;\n          } else if (takeoff.elementName.toLowerCase().includes(\"picture\")) {\n            summary.windows.picture += takeoff.quantity || 0;\n          }\n          break;\n        case \"flooring\":\n          const area = takeoff.area || 0;\n          summary.flooring.total += area;\n          if (takeoff.elementName.toLowerCase().includes(\"hardwood\")) {\n            summary.flooring.hardwood += area;\n          } else if (takeoff.elementName.toLowerCase().includes(\"tile\")) {\n            summary.flooring.tile += area;\n          } else if (takeoff.elementName.toLowerCase().includes(\"carpet\")) {\n            summary.flooring.carpet += area;\n          }\n          break;\n        case \"electrical\":\n          if (takeoff.elementName.toLowerCase().includes(\"outlet\")) {\n            summary.electrical.outlets += takeoff.quantity || 0;\n          } else if (takeoff.elementName.toLowerCase().includes(\"light\")) {\n            summary.electrical.lights += takeoff.quantity || 0;\n          } else if (takeoff.elementName.toLowerCase().includes(\"switch\")) {\n            summary.electrical.switches += takeoff.quantity || 0;\n          }\n          break;\n        case \"walls\":\n          summary.walls.length += takeoff.length || 0;\n          break;\n      }\n    });\n\n    // Calculate materials and labor breakdown (assuming 60/40 split)\n    summary.costs.materials = summary.costs.total * 0.6;\n    summary.costs.labor = summary.costs.total * 0.4;\n  }\n\n  return (\n    <div className=\"w-96 bg-white border-l border-slate-200 flex flex-col\">\n      {/* Panel Header */}\n      <div className=\"p-4 border-b border-slate-200\">\n        <h2 className=\"text-lg font-semibold text-slate-900\">Takeoff Results</h2>\n        <p className=\"text-sm text-slate-600\">AI-powered measurements and manual adjustments</p>\n      </div>\n\n      {/* Results Content */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {isLoading ? (\n          <div className=\"p-4 space-y-3\">\n            {[1, 2, 3, 4].map((i) => (\n              <div key={i} className=\"bg-slate-100 rounded-lg p-3 animate-pulse\">\n                <div className=\"h-4 bg-slate-200 rounded mb-2\"></div>\n                <div className=\"h-3 bg-slate-200 rounded w-2/3\"></div>\n              </div>\n            ))}\n          </div>\n        ) : takeoffs && takeoffs.length > 0 ? (\n          <>\n            {/* Summary Cards */}\n            <div className=\"p-4 space-y-3\">\n              <Card className=\"bg-blue-50 border-blue-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"text-sm font-semibold text-blue-900 flex items-center\">\n                      <DoorOpen className=\"w-4 h-4 mr-2\" />\n                      Total Doors\n                    </h3>\n                    <span className=\"text-lg font-bold text-blue-700\">{summary.doors.total}</span>\n                  </div>\n                  <p className=\"text-xs text-blue-600 mt-1\">AI Detected + Manual Count</p>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"bg-green-50 border-green-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"text-sm font-semibold text-green-900 flex items-center\">\n                      <Square className=\"w-4 h-4 mr-2\" />\n                      Total Windows\n                    </h3>\n                    <span className=\"text-lg font-bold text-green-700\">{summary.windows.total}</span>\n                  </div>\n                  <p className=\"text-xs text-green-600 mt-1\">Standard & Custom Sizes</p>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"bg-amber-50 border-amber-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"text-sm font-semibold text-amber-900\">Floor Area</h3>\n                    <span className=\"text-lg font-bold text-amber-700\">\n                      {summary.flooring.total.toLocaleString()} sq ft\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-amber-600 mt-1\">Measured Areas Combined</p>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"bg-purple-50 border-purple-200\">\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"text-sm font-semibold text-purple-900\">Wall Length</h3>\n                    <span className=\"text-lg font-bold text-purple-700\">\n                      {summary.walls.length.toLocaleString()} ft\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-purple-600 mt-1\">Interior + Exterior</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Detailed Breakdown */}\n            <div className=\"p-4 border-t border-slate-200\">\n              <h3 className=\"text-sm font-semibold text-slate-900 mb-3\">Detailed Breakdown</h3>\n              \n              {/* Doors Section */}\n              {summary.doors.total > 0 && (\n                <div className=\"mb-4\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h4 className=\"text-sm font-medium text-slate-700 flex items-center\">\n                      <DoorOpen className=\"w-4 h-4 text-blue-600 mr-2\" />\n                      Doors\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <Edit className=\"w-3 h-3 mr-1\" />\n                      Edit\n                    </Button>\n                  </div>\n                  <div className=\"space-y-2 text-sm\">\n                    {summary.doors.interior36 > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Interior Doors (36\")</span>\n                        <span className=\"font-medium\">{summary.doors.interior36}</span>\n                      </div>\n                    )}\n                    {summary.doors.interior32 > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Interior Doors (32\")</span>\n                        <span className=\"font-medium\">{summary.doors.interior32}</span>\n                      </div>\n                    )}\n                    {summary.doors.entry > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Entry Door</span>\n                        <span className=\"font-medium\">{summary.doors.entry}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Windows Section */}\n              {summary.windows.total > 0 && (\n                <div className=\"mb-4\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h4 className=\"text-sm font-medium text-slate-700 flex items-center\">\n                      <Square className=\"w-4 h-4 text-green-600 mr-2\" />\n                      Windows\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <Edit className=\"w-3 h-3 mr-1\" />\n                      Edit\n                    </Button>\n                  </div>\n                  <div className=\"space-y-2 text-sm\">\n                    {summary.windows.doubleHung > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Double Hung (3'x4')</span>\n                        <span className=\"font-medium\">{summary.windows.doubleHung}</span>\n                      </div>\n                    )}\n                    {summary.windows.casement > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Casement (2'x3')</span>\n                        <span className=\"font-medium\">{summary.windows.casement}</span>\n                      </div>\n                    )}\n                    {summary.windows.picture > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Picture Window</span>\n                        <span className=\"font-medium\">{summary.windows.picture}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Flooring Section */}\n              {summary.flooring.total > 0 && (\n                <div className=\"mb-4\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h4 className=\"text-sm font-medium text-slate-700 flex items-center\">\n                      <Square className=\"w-4 h-4 text-amber-600 mr-2\" />\n                      Flooring\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <Edit className=\"w-3 h-3 mr-1\" />\n                      Edit\n                    </Button>\n                  </div>\n                  <div className=\"space-y-2 text-sm\">\n                    {summary.flooring.hardwood > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Hardwood</span>\n                        <span className=\"font-medium\">{summary.flooring.hardwood.toLocaleString()} sq ft</span>\n                      </div>\n                    )}\n                    {summary.flooring.tile > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Tile</span>\n                        <span className=\"font-medium\">{summary.flooring.tile.toLocaleString()} sq ft</span>\n                      </div>\n                    )}\n                    {summary.flooring.carpet > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Carpet</span>\n                        <span className=\"font-medium\">{summary.flooring.carpet.toLocaleString()} sq ft</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Electrical Section */}\n              {(summary.electrical.outlets > 0 || summary.electrical.lights > 0 || summary.electrical.switches > 0) && (\n                <div className=\"mb-4\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h4 className=\"text-sm font-medium text-slate-700 flex items-center\">\n                      <Zap className=\"w-4 h-4 text-yellow-600 mr-2\" />\n                      Electrical\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <Edit className=\"w-3 h-3 mr-1\" />\n                      Edit\n                    </Button>\n                  </div>\n                  <div className=\"space-y-2 text-sm\">\n                    {summary.electrical.outlets > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Outlets</span>\n                        <span className=\"font-medium\">{summary.electrical.outlets}</span>\n                      </div>\n                    )}\n                    {summary.electrical.lights > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Light Fixtures</span>\n                        <span className=\"font-medium\">{summary.electrical.lights}</span>\n                      </div>\n                    )}\n                    {summary.electrical.switches > 0 && (\n                      <div className=\"flex justify-between items-center py-1\">\n                        <span className=\"text-slate-600\">Switches</span>\n                        <span className=\"font-medium\">{summary.electrical.switches}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Cost Estimation */}\n            <div className=\"p-4 border-t border-slate-200 bg-slate-50\">\n              <h3 className=\"text-sm font-semibold text-slate-900 mb-3\">Cost Estimation</h3>\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-slate-600\">Materials</span>\n                  <span className=\"font-semibold text-slate-900\">\n                    ${summary.costs.materials.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm text-slate-600\">Labor</span>\n                  <span className=\"font-semibold text-slate-900\">\n                    ${summary.costs.labor.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center pt-2 border-t border-slate-300\">\n                  <span className=\"text-sm font-semibold text-slate-900\">Total Estimate</span>\n                  <span className=\"text-lg font-bold text-blueprint-700\">\n                    ${summary.costs.total.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                  </span>\n                </div>\n              </div>\n              <Button className=\"w-full mt-3 bg-blueprint-600 hover:bg-blueprint-700\">\n                <Calculator className=\"w-4 h-4 mr-2\" />\n                Generate Detailed Quote\n              </Button>\n            </div>\n          </>\n        ) : (\n          <div className=\"flex-1 flex items-center justify-center p-8\">\n            <div className=\"text-center\">\n              <Calculator className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-slate-900 mb-2\">No Takeoff Data</h3>\n              <p className=\"text-sm text-slate-600 mb-4\">\n                {drawing.aiProcessed \n                  ? \"No elements detected in this drawing\"\n                  : \"Upload and process a drawing to see takeoff results\"\n                }\n              </p>\n              {!drawing.aiProcessed && (\n                <Button size=\"sm\" className=\"bg-blueprint-600 hover:bg-blueprint-700\">\n                  Start AI Analysis\n                </Button>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":18251},"client/src/components/takeoff-type-selector.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { \n  Box, \n  Square, \n  Zap, \n  Droplets, \n  DoorOpen, \n  Maximize2, \n  Home,\n  Hammer,\n  Play\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Drawing } from \"@shared/schema\";\n\ninterface TakeoffType {\n  id: string;\n  name: string;\n  icon: any;\n  description: string;\n  category: string;\n  unit: string;\n  color: string;\n}\n\nconst TAKEOFF_TYPES: TakeoffType[] = [\n  {\n    id: \"doors\",\n    name: \"Doors\",\n    icon: DoorOpen,\n    description: \"Interior and exterior doors\",\n    category: \"doors\",\n    unit: \"each\",\n    color: \"bg-blue-500\"\n  },\n  {\n    id: \"windows\",\n    name: \"Windows\", \n    icon: Square,\n    description: \"All window types and sizes\",\n    category: \"windows\",\n    unit: \"each\",\n    color: \"bg-cyan-500\"\n  },\n  {\n    id: \"flooring\",\n    name: \"Flooring\",\n    icon: Box,\n    description: \"Floor area measurements\",\n    category: \"flooring\", \n    unit: \"sq ft\",\n    color: \"bg-amber-500\"\n  },\n  {\n    id: \"walls\",\n    name: \"Walls\",\n    icon: Maximize2,\n    description: \"Wall length and area\",\n    category: \"walls\",\n    unit: \"linear ft\",\n    color: \"bg-slate-500\"\n  },\n  {\n    id: \"electrical\",\n    name: \"Electrical\",\n    icon: Zap,\n    description: \"Outlets, switches, fixtures\",\n    category: \"electrical\",\n    unit: \"each\",\n    color: \"bg-yellow-500\"\n  },\n  {\n    id: \"plumbing\",\n    name: \"Plumbing\",\n    icon: Droplets,\n    description: \"Fixtures and pipe runs\",\n    category: \"plumbing\",\n    unit: \"each\",\n    color: \"bg-blue-600\"\n  },\n  {\n    id: \"hvac\",\n    name: \"HVAC\",\n    icon: Home,\n    description: \"Heating and cooling systems\",\n    category: \"hvac\",\n    unit: \"each\",\n    color: \"bg-green-500\"\n  },\n  {\n    id: \"structural\",\n    name: \"Structural\",\n    icon: Hammer,\n    description: \"Beams, columns, foundations\",\n    category: \"structural\",\n    unit: \"each\",\n    color: \"bg-red-500\"\n  }\n];\n\ninterface TakeoffTypeSelectorProps {\n  drawing: Drawing;\n  onComplete?: () => void;\n}\n\nexport default function TakeoffTypeSelector({ drawing, onComplete }: TakeoffTypeSelectorProps) {\n  const [selectedTypes, setSelectedTypes] = useState<string[]>([]);\n  const { toast } = useToast();\n\n  const runTakeoffMutation = useMutation({\n    mutationFn: async (typeIds: string[]) => {\n      return apiRequest(`/api/drawings/${drawing.id}/run-takeoff`, \"POST\", { elementTypes: typeIds });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Takeoff Started\",\n        description: \"AI analysis is running on selected element types\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/drawings\", drawing.id, \"takeoffs\"] });\n      onComplete?.();\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to start takeoff analysis\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleTypeToggle = (typeId: string) => {\n    setSelectedTypes(prev => \n      prev.includes(typeId) \n        ? prev.filter(id => id !== typeId)\n        : [...prev, typeId]\n    );\n  };\n\n  const handleSelectAll = () => {\n    setSelectedTypes(TAKEOFF_TYPES.map(type => type.id));\n  };\n\n  const handleClearAll = () => {\n    setSelectedTypes([]);\n  };\n\n  const handleRunTakeoff = () => {\n    if (selectedTypes.length === 0) {\n      toast({\n        title: \"No Selection\",\n        description: \"Please select at least one element type to analyze\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    runTakeoffMutation.mutate(selectedTypes);\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle>Select Takeoff Types</CardTitle>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              Choose which building elements to detect and measure\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleSelectAll}>\n              Select All\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleClearAll}>\n              Clear All\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Selection Grid */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n          {TAKEOFF_TYPES.map((type) => {\n            const Icon = type.icon;\n            const isSelected = selectedTypes.includes(type.id);\n            \n            return (\n              <div\n                key={type.id}\n                className={`\n                  relative p-4 rounded-lg border-2 cursor-pointer transition-all\n                  ${isSelected \n                    ? 'border-blueprint-500 bg-blueprint-50' \n                    : 'border-slate-200 hover:border-slate-300 bg-white'\n                  }\n                `}\n                onClick={() => handleTypeToggle(type.id)}\n              >\n                <div className=\"flex flex-col items-center text-center space-y-2\">\n                  <div className={`w-10 h-10 rounded-lg ${type.color} flex items-center justify-center`}>\n                    <Icon className=\"w-5 h-5 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-medium text-sm\">{type.name}</h3>\n                    <p className=\"text-xs text-muted-foreground\">{type.description}</p>\n                    <Badge variant=\"outline\" className=\"mt-1 text-xs\">\n                      {type.unit}\n                    </Badge>\n                  </div>\n                </div>\n                \n                {/* Checkbox indicator */}\n                <div className=\"absolute top-2 right-2\">\n                  <Checkbox checked={isSelected} onChange={() => handleTypeToggle(type.id)} />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Selection Summary */}\n        {selectedTypes.length > 0 && (\n          <div className=\"p-3 bg-slate-50 rounded-lg\">\n            <p className=\"text-sm font-medium mb-2\">\n              Selected: {selectedTypes.length} element type{selectedTypes.length !== 1 ? 's' : ''}\n            </p>\n            <div className=\"flex flex-wrap gap-1\">\n              {selectedTypes.map(typeId => {\n                const type = TAKEOFF_TYPES.find(t => t.id === typeId);\n                return type ? (\n                  <Badge key={typeId} variant=\"secondary\" className=\"text-xs\">\n                    {type.name}\n                  </Badge>\n                ) : null;\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Action Button */}\n        <div className=\"flex justify-end pt-4\">\n          <Button \n            onClick={handleRunTakeoff}\n            disabled={selectedTypes.length === 0 || runTakeoffMutation.isPending}\n            className=\"bg-blueprint-600 hover:bg-blueprint-700\"\n          >\n            <Play className=\"w-4 h-4 mr-2\" />\n            {runTakeoffMutation.isPending ? \"Starting Analysis...\" : \"Run AI Takeoff\"}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":7456},"client/src/components/upload-zone.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { CloudUpload, X, Upload } from \"lucide-react\";\n\ninterface UploadZoneProps {\n  projectId: string;\n  onUploadComplete: () => void;\n  onCancel: () => void;\n}\n\nexport default function UploadZone({ projectId, onUploadComplete, onCancel }: UploadZoneProps) {\n  const [dragActive, setDragActive] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [drawingName, setDrawingName] = useState(\"\");\n  const [scale, setScale] = useState(\"1/4\\\" = 1'\");\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const uploadMutation = useMutation({\n    mutationFn: async (formData: FormData) => {\n      const response = await fetch(`/api/projects/${projectId}/drawings/upload`, {\n        method: \"POST\",\n        body: formData,\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Upload failed\");\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Upload successful\",\n        description: \"Your drawing has been uploaded and AI processing has started.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"drawings\"] });\n      onUploadComplete();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Upload failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFile(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFile(e.target.files[0]);\n    }\n  };\n\n  const handleFile = (file: File) => {\n    // Validate file type\n    const allowedTypes = [\"application/pdf\", \"image/png\", \"image/jpeg\", \"image/jpg\"];\n    if (!allowedTypes.includes(file.type)) {\n      toast({\n        title: \"Invalid file type\",\n        description: \"Only PDF, PNG, and JPG files are allowed.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate file size (50MB)\n    if (file.size > 50 * 1024 * 1024) {\n      toast({\n        title: \"File too large\",\n        description: \"File size must be less than 50MB.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setSelectedFile(file);\n    setDrawingName(file.name.replace(/\\.[^/.]+$/, \"\"));\n  };\n\n  const handleUpload = () => {\n    if (!selectedFile) return;\n\n    const formData = new FormData();\n    formData.append(\"file\", selectedFile);\n    formData.append(\"name\", drawingName);\n    formData.append(\"scale\", scale);\n\n    uploadMutation.mutate(formData);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {!selectedFile ? (\n        <div\n          className={`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${\n            dragActive \n              ? \"border-blueprint-500 bg-blueprint-50\" \n              : \"border-slate-300 hover:border-blueprint-400\"\n          }`}\n          onDragEnter={handleDrag}\n          onDragLeave={handleDrag}\n          onDragOver={handleDrag}\n          onDrop={handleDrop}\n          onClick={() => fileInputRef.current?.click()}\n        >\n          <CloudUpload className=\"w-8 h-8 text-slate-400 mx-auto mb-3\" />\n          <p className=\"text-sm font-medium text-slate-600 mb-1\">\n            Drop files here or click to browse\n          </p>\n          <p className=\"text-xs text-slate-500\">PDF, PNG, JPG up to 50MB</p>\n          \n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            className=\"hidden\"\n            accept=\".pdf,.png,.jpg,.jpeg\"\n            onChange={handleFileSelect}\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          <div className=\"bg-slate-50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                <Upload className=\"w-5 h-5 text-blueprint-600\" />\n                <div>\n                  <p className=\"text-sm font-medium text-slate-900\">{selectedFile.name}</p>\n                  <p className=\"text-xs text-slate-500\">\n                    {(selectedFile.size / 1024 / 1024).toFixed(2)} MB\n                  </p>\n                </div>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setSelectedFile(null)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div>\n              <Label htmlFor=\"drawing-name\">Drawing Name</Label>\n              <Input\n                id=\"drawing-name\"\n                value={drawingName}\n                onChange={(e) => setDrawingName(e.target.value)}\n                placeholder=\"Enter drawing name\"\n              />\n            </div>\n\n            <div>\n              <Label htmlFor=\"scale\">Scale</Label>\n              <select\n                id=\"scale\"\n                value={scale}\n                onChange={(e) => setScale(e.target.value)}\n                className=\"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm\"\n              >\n                <option value=\"1/4&quot; = 1'\">1/4\" = 1'</option>\n                <option value=\"1/8&quot; = 1'\">1/8\" = 1'</option>\n                <option value=\"1/2&quot; = 1'\">1/2\" = 1'</option>\n                <option value=\"1&quot; = 1'\">1\" = 1'</option>\n              </select>\n            </div>\n          </div>\n\n          <div className=\"flex space-x-2\">\n            <Button\n              onClick={handleUpload}\n              disabled={!drawingName.trim() || uploadMutation.isPending}\n              className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n            >\n              {uploadMutation.isPending ? \"Uploading...\" : \"Upload Drawing\"}\n            </Button>\n            <Button variant=\"outline\" onClick={onCancel}>\n              Cancel\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":6897},"client/src/components/vertical-takeoff-selector.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { \n  Building2, \n  SquareStack, \n  Zap, \n  Droplets, \n  Wind, \n  Hammer,\n  ArrowUpDown,\n  Maximize,\n  Settings\n} from \"lucide-react\";\n\ninterface TakeoffType {\n  id: string;\n  name: string;\n  description: string;\n  unit: string;\n  icon: React.ComponentType<{ className?: string }>;\n  color: string;\n}\n\nconst takeoffTypes: TakeoffType[] = [\n  {\n    id: \"doors\",\n    name: \"Doors\",\n    description: \"Interior and exterior doors\",\n    unit: \"each\",\n    icon: Building2,\n    color: \"text-blue-600 bg-blue-50 border-blue-200\"\n  },\n  {\n    id: \"windows\",\n    name: \"Windows\", \n    description: \"All window types and sizes\",\n    unit: \"each\",\n    icon: SquareStack,\n    color: \"text-cyan-600 bg-cyan-50 border-cyan-200\"\n  },\n  {\n    id: \"flooring\",\n    name: \"Flooring\",\n    description: \"Floor area measurements\",\n    unit: \"sq ft\",\n    icon: Maximize,\n    color: \"text-amber-600 bg-amber-50 border-amber-200\"\n  },\n  {\n    id: \"walls\",\n    name: \"Walls\",\n    description: \"Wall length and area\",\n    unit: \"linear ft\",\n    icon: ArrowUpDown,\n    color: \"text-slate-600 bg-slate-50 border-slate-200\"\n  },\n  {\n    id: \"electrical\",\n    name: \"Electrical\",\n    description: \"Outlets, switches, fixtures\",\n    unit: \"each\",\n    icon: Zap,\n    color: \"text-yellow-600 bg-yellow-50 border-yellow-200\"\n  },\n  {\n    id: \"plumbing\",\n    name: \"Plumbing\",\n    description: \"Fixtures and pipe runs\",\n    unit: \"each\",\n    icon: Droplets,\n    color: \"text-blue-600 bg-blue-50 border-blue-200\"\n  },\n  {\n    id: \"hvac\",\n    name: \"HVAC\",\n    description: \"Heating and cooling systems\",\n    unit: \"each\",\n    icon: Wind,\n    color: \"text-green-600 bg-green-50 border-green-200\"\n  },\n  {\n    id: \"structural\",\n    name: \"Structural\",\n    description: \"Beams, columns, foundations\",\n    unit: \"each\",\n    icon: Hammer,\n    color: \"text-red-600 bg-red-50 border-red-200\"\n  }\n];\n\ninterface VerticalTakeoffSelectorProps {\n  selectedTypes: string[];\n  onSelectionChange: (types: string[]) => void;\n  onRunAnalysis: () => void;\n  isAnalyzing?: boolean;\n}\n\nexport default function VerticalTakeoffSelector({ \n  selectedTypes, \n  onSelectionChange, \n  onRunAnalysis,\n  isAnalyzing = false \n}: VerticalTakeoffSelectorProps) {\n  const handleTypeToggle = (typeId: string) => {\n    const newSelection = selectedTypes.includes(typeId)\n      ? selectedTypes.filter(id => id !== typeId)\n      : [...selectedTypes, typeId];\n    onSelectionChange(newSelection);\n  };\n\n  const handleSelectAll = () => {\n    onSelectionChange(takeoffTypes.map(type => type.id));\n  };\n\n  const handleClearAll = () => {\n    onSelectionChange([]);\n  };\n\n  return (\n    <div className=\"w-80 bg-white border-r border-slate-200 flex flex-col h-full\">\n      {/* Header */}\n      <div className=\"p-6 border-b border-slate-200\">\n        <h2 className=\"text-lg font-semibold text-slate-900 mb-2\">Select Takeoff Types</h2>\n        <p className=\"text-sm text-slate-600 mb-4\">Choose which building elements to detect and measure</p>\n        \n        <div className=\"flex gap-2\">\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={handleSelectAll}\n            className=\"flex-1\"\n          >\n            Select All\n          </Button>\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={handleClearAll}\n            className=\"flex-1\"\n          >\n            Clear All\n          </Button>\n        </div>\n      </div>\n\n      {/* Takeoff Types */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\n        {takeoffTypes.map((type) => {\n          const IconComponent = type.icon;\n          const isSelected = selectedTypes.includes(type.id);\n          \n          return (\n            <Card \n              key={type.id} \n              className={`cursor-pointer transition-all duration-200 ${\n                isSelected \n                  ? `${type.color} border-2 shadow-sm` \n                  : 'border border-slate-200 hover:border-slate-300'\n              }`}\n              onClick={() => handleTypeToggle(type.id)}\n            >\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className={`p-2 rounded-lg ${isSelected ? 'bg-white/80' : type.color}`}>\n                    <IconComponent className=\"w-5 h-5\" />\n                  </div>\n                  \n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center justify-between mb-1\">\n                      <h3 className=\"font-medium text-sm text-slate-900\">{type.name}</h3>\n                      <Checkbox \n                        checked={isSelected}\n                        onCheckedChange={() => handleTypeToggle(type.id)}\n                        className=\"ml-2\"\n                      />\n                    </div>\n                    <p className=\"text-xs text-slate-600 mb-2\">{type.description}</p>\n                    <div className=\"text-xs font-medium text-slate-500 uppercase tracking-wide\">\n                      {type.unit}\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      {/* Action Button */}\n      <div className=\"p-4 border-t border-slate-200 space-y-3\">\n        <Button \n          onClick={onRunAnalysis}\n          disabled={selectedTypes.length === 0 || isAnalyzing}\n          className=\"w-full bg-purple-600 hover:bg-purple-700 text-white\"\n        >\n          {isAnalyzing ? (\n            <>\n              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n              Analyzing...\n            </>\n          ) : (\n            `Run AI Analysis (${selectedTypes.length} selected)`\n          )}\n        </Button>\n        \n        {selectedTypes.length === 0 && (\n          <p className=\"text-xs text-slate-500 text-center\">\n            Select at least one element type to analyze\n          </p>\n        )}\n\n        {/* Settings Button */}\n        <Button \n          variant=\"outline\" \n          className=\"w-full text-slate-600 hover:text-slate-900\"\n          onClick={() => window.location.href = '/settings'}\n        >\n          <Settings className=\"w-4 h-4 mr-2\" />\n          Settings\n        </Button>\n      </div>\n    </div>\n  );\n}","size_bytes":6523},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  url: string,\n  method: string,\n  data?: unknown | undefined,\n): Promise<any> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  \n  // Handle 204 No Content responses (empty body)\n  if (res.status === 204) {\n    return null;\n  }\n  \n  // Only try to parse JSON if there's content\n  const contentType = res.headers.get(\"content-type\");\n  if (contentType && contentType.includes(\"application/json\")) {\n    return res.json();\n  }\n  \n  return res.text();\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1687},"client/src/lib/reportGenerator.ts":{"content":"import jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\nimport html2canvas from 'html2canvas';\nimport type { Project, Takeoff, Drawing, SavedAnalysis } from '@shared/schema';\n\ninterface ReportData {\n  project: Project;\n  takeoffs: Takeoff[];\n  drawings: Drawing[];\n  analyses?: SavedAnalysis[];\n}\n\ninterface CompanyInfo {\n  name: string;\n  address: string;\n  phone: string;\n  email: string;\n  logo?: string;\n}\n\nexport class ReportGenerator {\n  private doc: jsPDF;\n  private pageWidth: number;\n  private pageHeight: number;\n  private margin: number = 20;\n\n  constructor() {\n    this.doc = new jsPDF();\n    this.pageWidth = this.doc.internal.pageSize.getWidth();\n    this.pageHeight = this.doc.internal.pageSize.getHeight();\n  }\n\n  // Add chart to PDF (for visual reports)\n  async addChartToPDF(chartElement: HTMLCanvasElement, yPos: number, title?: string): Promise<number> {\n    try {\n      const canvas = await html2canvas(chartElement, {\n        backgroundColor: '#ffffff',\n        scale: 1\n      });\n      \n      const imgData = canvas.toDataURL('image/png');\n      const imgWidth = 160; // PDF units\n      const imgHeight = (canvas.height * imgWidth) / canvas.width;\n      \n      if (title) {\n        this.doc.setFontSize(14);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text(title, this.margin, yPos);\n        yPos += 15;\n      }\n      \n      this.doc.addImage(imgData, 'PNG', this.margin, yPos, imgWidth, imgHeight);\n      return yPos + imgHeight + 10;\n    } catch (error) {\n      console.error('Error adding chart to PDF:', error);\n      return yPos;\n    }\n  }\n\n  // Generate Executive Summary Report\n  async generateExecutiveSummary(data: ReportData, companyInfo: CompanyInfo): Promise<Blob> {\n    this.doc = new jsPDF();\n    \n    // Header with company branding\n    this.addHeader(companyInfo);\n    \n    // Project title and basic info\n    let yPos = 60;\n    this.doc.setFontSize(24);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('PROJECT EXECUTIVE SUMMARY', this.margin, yPos);\n    \n    yPos += 20;\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'normal');\n    this.doc.text(data.project.name, this.margin, yPos);\n    \n    // Project overview section\n    yPos = this.addProjectOverview(data.project, yPos + 15);\n    \n    // Cost summary section\n    yPos = this.addCostSummary(data.takeoffs, yPos + 15);\n    \n    // Key metrics section\n    yPos = this.addKeyMetrics(data.takeoffs, yPos + 15);\n    \n    // Footer\n    this.addFooter();\n    \n    return this.doc.output('blob');\n  }\n\n  // Generate Detailed Cost Report\n  async generateDetailedCostReport(data: ReportData, companyInfo: CompanyInfo): Promise<Blob> {\n    this.doc = new jsPDF();\n    \n    // Header\n    this.addHeader(companyInfo);\n    \n    let yPos = 60;\n    this.doc.setFontSize(20);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('DETAILED COST BREAKDOWN', this.margin, yPos);\n    \n    yPos += 20;\n    this.doc.setFontSize(14);\n    this.doc.setFont('helvetica', 'normal');\n    this.doc.text(`Project: ${data.project.name}`, this.margin, yPos);\n    this.doc.text(`Date: ${new Date().toLocaleDateString()}`, this.pageWidth - 60, yPos);\n    \n    // Group takeoffs by element type\n    const groupedTakeoffs = this.groupTakeoffsByType(data.takeoffs);\n    \n    yPos += 20;\n    \n    // Create detailed tables for each element type\n    for (const [elementType, takeoffs] of Object.entries(groupedTakeoffs)) {\n      if (yPos > this.pageHeight - 100) {\n        this.doc.addPage();\n        yPos = this.margin + 10;\n      }\n      \n      // Section header\n      this.doc.setFontSize(16);\n      this.doc.setFont('helvetica', 'bold');\n      this.doc.text(elementType.toUpperCase(), this.margin, yPos);\n      yPos += 10;\n      \n      // Create table data\n      const tableData = takeoffs.map(takeoff => [\n        takeoff.elementName,\n        takeoff.quantity?.toString() || '0',\n        takeoff.unit,\n        takeoff.area ? takeoff.area.toFixed(1) : '-',\n        takeoff.length ? takeoff.length.toFixed(1) : '-',\n        `$${(takeoff.costPerUnit || 0).toFixed(2)}`,\n        `$${(takeoff.totalCost || 0).toLocaleString()}`,\n        takeoff.verified ? 'âœ“' : '-'\n      ]);\n      \n      autoTable(this.doc, {\n        startY: yPos,\n        head: [['Item', 'Qty', 'Unit', 'Area', 'Length', 'Unit Cost', 'Total', 'Verified']],\n        body: tableData,\n        theme: 'striped',\n        headStyles: { fillColor: [41, 128, 185] },\n        styles: { fontSize: 9, cellPadding: 3 },\n        columnStyles: {\n          6: { halign: 'right' },\n          5: { halign: 'right' }\n        }\n      });\n      \n      yPos = (this.doc as any).lastAutoTable.finalY + 15;\n      \n      // Subtotal for this section\n      const subtotal = takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n      this.doc.setFont('helvetica', 'bold');\n      this.doc.text(`${elementType} Subtotal: $${subtotal.toLocaleString()}`, this.pageWidth - 80, yPos - 5);\n      this.doc.setFont('helvetica', 'normal');\n    }\n    \n    // Add grand total\n    this.addGrandTotal(data.takeoffs);\n    \n    this.addFooter();\n    return this.doc.output('blob');\n  }\n\n  // Generate Comparison Report\n  async generateComparisonReport(\n    originalData: ReportData, \n    revisedData: ReportData, \n    companyInfo: CompanyInfo\n  ): Promise<Blob> {\n    this.doc = new jsPDF();\n    \n    this.addHeader(companyInfo);\n    \n    let yPos = 60;\n    this.doc.setFontSize(20);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('ESTIMATE COMPARISON REPORT', this.margin, yPos);\n    \n    yPos += 20;\n    this.doc.setFontSize(14);\n    this.doc.setFont('helvetica', 'normal');\n    this.doc.text(`Project: ${originalData.project.name}`, this.margin, yPos);\n    this.doc.text(`Comparison Date: ${new Date().toLocaleDateString()}`, this.pageWidth - 80, yPos);\n    \n    // Summary comparison\n    const originalTotal = this.calculateTotalCost(originalData.takeoffs);\n    const revisedTotal = this.calculateTotalCost(revisedData.takeoffs);\n    const difference = revisedTotal - originalTotal;\n    const percentageChange = originalTotal > 0 ? (difference / originalTotal) * 100 : 0;\n    \n    yPos += 30;\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('COST COMPARISON SUMMARY', this.margin, yPos);\n    \n    yPos += 20;\n    const summaryData = [\n      ['Original Estimate', `$${originalTotal.toLocaleString()}`],\n      ['Revised Estimate', `$${revisedTotal.toLocaleString()}`],\n      ['Difference', `$${Math.abs(difference).toLocaleString()} ${difference >= 0 ? 'increase' : 'decrease'}`],\n      ['Percentage Change', `${Math.abs(percentageChange).toFixed(1)}% ${percentageChange >= 0 ? 'increase' : 'decrease'}`]\n    ];\n    \n    autoTable(this.doc, {\n      startY: yPos,\n      head: [['Description', 'Amount']],\n      body: summaryData,\n      theme: 'grid',\n      headStyles: { fillColor: [52, 73, 94] },\n      styles: { fontSize: 12, cellPadding: 5 },\n      columnStyles: {\n        1: { halign: 'right', fontStyle: 'bold' }\n      }\n    });\n    \n    yPos = (this.doc as any).lastAutoTable.finalY + 20;\n    \n    // Detailed comparison by element type\n    this.addDetailedComparison(originalData.takeoffs, revisedData.takeoffs, yPos);\n    \n    this.addFooter();\n    return this.doc.output('blob');\n  }\n\n  // Helper methods\n  private addHeader(companyInfo: CompanyInfo) {\n    // Company logo placeholder (if provided)\n    if (companyInfo.logo) {\n      // Add logo logic here\n    }\n    \n    // Company info\n    this.doc.setFontSize(12);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text(companyInfo.name, this.pageWidth - 80, 20);\n    this.doc.setFont('helvetica', 'normal');\n    this.doc.setFontSize(10);\n    this.doc.text(companyInfo.address, this.pageWidth - 80, 28);\n    this.doc.text(companyInfo.phone, this.pageWidth - 80, 36);\n    this.doc.text(companyInfo.email, this.pageWidth - 80, 44);\n    \n    // Line separator\n    this.doc.setDrawColor(200, 200, 200);\n    this.doc.line(this.margin, 50, this.pageWidth - this.margin, 50);\n  }\n\n  private addProjectOverview(project: Project, yPos: number): number {\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('PROJECT OVERVIEW', this.margin, yPos);\n    \n    yPos += 15;\n    this.doc.setFontSize(11);\n    this.doc.setFont('helvetica', 'normal');\n    \n    const overviewData = [\n      ['Project Name', project.name],\n      ['Location', project.location || 'Not specified'],\n      ['Client', project.client || 'Not specified'],\n      ['Status', project.status],\n      ['Created Date', new Date(project.createdAt!).toLocaleDateString()]\n    ];\n    \n    autoTable(this.doc, {\n      startY: yPos,\n      body: overviewData,\n      theme: 'plain',\n      styles: { fontSize: 11, cellPadding: 3 },\n      columnStyles: {\n        0: { fontStyle: 'bold', cellWidth: 40 },\n        1: { cellWidth: 100 }\n      }\n    });\n    \n    return (this.doc as any).lastAutoTable.finalY + 10;\n  }\n\n  private addCostSummary(takeoffs: Takeoff[], yPos: number): number {\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('COST SUMMARY', this.margin, yPos);\n    \n    // Group costs by element type\n    const groupedCosts = this.groupTakeoffsByType(takeoffs);\n    const summaryData = Object.entries(groupedCosts).map(([type, items]) => {\n      const total = items.reduce((sum, item) => sum + (item.totalCost || 0), 0);\n      const itemCount = items.length;\n      return [type.charAt(0).toUpperCase() + type.slice(1), itemCount.toString(), `$${total.toLocaleString()}`];\n    });\n    \n    // Add grand total\n    const grandTotal = takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n    summaryData.push(['TOTAL', takeoffs.length.toString(), `$${grandTotal.toLocaleString()}`]);\n    \n    yPos += 15;\n    autoTable(this.doc, {\n      startY: yPos,\n      head: [['Element Type', 'Items', 'Cost']],\n      body: summaryData,\n      theme: 'striped',\n      headStyles: { fillColor: [41, 128, 185] },\n      styles: { fontSize: 11, cellPadding: 4 },\n      columnStyles: {\n        2: { halign: 'right', fontStyle: 'bold' }\n      }\n    });\n    \n    return (this.doc as any).lastAutoTable.finalY + 10;\n  }\n\n  private addKeyMetrics(takeoffs: Takeoff[], yPos: number): number {\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('KEY METRICS', this.margin, yPos);\n    \n    yPos += 15;\n    \n    const totalItems = takeoffs.length;\n    const verifiedItems = takeoffs.filter(t => t.verified).length;\n    const aiDetectedItems = takeoffs.filter(t => t.detectedByAi).length;\n    const manuallyEditedItems = takeoffs.filter(t => t.manuallyEdited).length;\n    \n    const metricsData = [\n      ['Total Items', totalItems.toString()],\n      ['Verified Items', `${verifiedItems} (${((verifiedItems / totalItems) * 100).toFixed(1)}%)`],\n      ['AI Detected', `${aiDetectedItems} (${((aiDetectedItems / totalItems) * 100).toFixed(1)}%)`],\n      ['Manually Edited', `${manuallyEditedItems} (${((manuallyEditedItems / totalItems) * 100).toFixed(1)}%)`]\n    ];\n    \n    autoTable(this.doc, {\n      startY: yPos,\n      body: metricsData,\n      theme: 'plain',\n      styles: { fontSize: 11, cellPadding: 4 },\n      columnStyles: {\n        0: { fontStyle: 'bold', cellWidth: 60 },\n        1: { cellWidth: 80 }\n      }\n    });\n    \n    return (this.doc as any).lastAutoTable.finalY + 10;\n  }\n\n  private addDetailedComparison(originalTakeoffs: Takeoff[], revisedTakeoffs: Takeoff[], yPos: number) {\n    this.doc.setFontSize(16);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.text('DETAILED COMPARISON BY ELEMENT TYPE', this.margin, yPos);\n    \n    yPos += 15;\n    \n    const originalGrouped = this.groupTakeoffsByType(originalTakeoffs);\n    const revisedGrouped = this.groupTakeoffsByType(revisedTakeoffs);\n    \n    // Get all unique element types\n    const allTypes = new Set([...Object.keys(originalGrouped), ...Object.keys(revisedGrouped)]);\n    \n    const comparisonData = Array.from(allTypes).map(type => {\n      const originalCost = this.calculateTypeCost(originalGrouped[type] || []);\n      const revisedCost = this.calculateTypeCost(revisedGrouped[type] || []);\n      const difference = revisedCost - originalCost;\n      \n      return [\n        type.charAt(0).toUpperCase() + type.slice(1),\n        `$${originalCost.toLocaleString()}`,\n        `$${revisedCost.toLocaleString()}`,\n        `$${Math.abs(difference).toLocaleString()}`,\n        difference >= 0 ? 'Increase' : 'Decrease'\n      ];\n    });\n    \n    autoTable(this.doc, {\n      startY: yPos,\n      head: [['Element Type', 'Original', 'Revised', 'Difference', 'Change']],\n      body: comparisonData,\n      theme: 'striped',\n      headStyles: { fillColor: [52, 73, 94] },\n      styles: { fontSize: 10, cellPadding: 3 },\n      columnStyles: {\n        1: { halign: 'right' },\n        2: { halign: 'right' },\n        3: { halign: 'right' },\n        4: { halign: 'center' }\n      }\n    });\n  }\n\n  private addGrandTotal(takeoffs: Takeoff[]) {\n    const total = this.calculateTotalCost(takeoffs);\n    \n    // Add new page if needed\n    if ((this.doc as any).lastAutoTable.finalY > this.pageHeight - 60) {\n      this.doc.addPage();\n    }\n    \n    const yPos = (this.doc as any).lastAutoTable.finalY + 20;\n    \n    this.doc.setFontSize(14);\n    this.doc.setFont('helvetica', 'bold');\n    this.doc.setFillColor(240, 240, 240);\n    this.doc.rect(this.pageWidth - 100, yPos - 5, 80, 15, 'F');\n    this.doc.text(`GRAND TOTAL: $${total.toLocaleString()}`, this.pageWidth - 95, yPos + 5);\n  }\n\n  private addFooter() {\n    const pageCount = this.doc.getNumberOfPages();\n    for (let i = 1; i <= pageCount; i++) {\n      this.doc.setPage(i);\n      this.doc.setFontSize(8);\n      this.doc.setFont('helvetica', 'normal');\n      this.doc.text(`Page ${i} of ${pageCount}`, this.pageWidth - 30, this.pageHeight - 10);\n      this.doc.text(`Generated on ${new Date().toLocaleDateString()}`, this.margin, this.pageHeight - 10);\n    }\n  }\n\n  private groupTakeoffsByType(takeoffs: Takeoff[]): Record<string, Takeoff[]> {\n    return takeoffs.reduce((groups, takeoff) => {\n      const type = takeoff.elementType;\n      if (!groups[type]) {\n        groups[type] = [];\n      }\n      groups[type].push(takeoff);\n      return groups;\n    }, {} as Record<string, Takeoff[]>);\n  }\n\n  private calculateTotalCost(takeoffs: Takeoff[]): number {\n    return takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n  }\n\n  private calculateTypeCost(takeoffs: Takeoff[]): number {\n    return takeoffs.reduce((sum, t) => sum + (t.totalCost || 0), 0);\n  }\n}","size_bytes":14621},"client/src/lib/types.ts":{"content":"export interface AIDetection {\n  id: string;\n  type: 'door' | 'window' | 'room' | 'electrical' | 'plumbing';\n  name: string;\n  coordinates: {\n    x: number;\n    y: number;\n    width?: number;\n    height?: number;\n  };\n  measurements?: {\n    width?: number;\n    height?: number;\n    area?: number;\n    quantity?: number;\n  };\n  confidence: number;\n}\n\nexport interface TakeoffSummaryData {\n  totalDoors: number;\n  totalWindows: number;\n  floorArea: number;\n  wallLength: number;\n  electricalCount: number;\n  plumbingCount: number;\n  estimatedCost: number;\n}\n\nexport interface ProjectStats {\n  totalDrawings: number;\n  processedDrawings: number;\n  pendingDrawings: number;\n  lastUpdated: Date;\n}\n","size_bytes":693},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/advanced-cost-management.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Building2, TrendingUp, DollarSign, Users, Package, AlertTriangle, CheckCircle2 } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface RegionalCost {\n  id: string;\n  region: string;\n  state: string;\n  city: string;\n  zipCode: string;\n  costIndex: number;\n  laborRate: number;\n  materialMarkup: number;\n  lastUpdated: string;\n}\n\ninterface Supplier {\n  id: string;\n  name: string;\n  contactName: string;\n  email: string;\n  phone: string;\n  address: string;\n  specialties: string[];\n  paymentTerms: string;\n  leadTimeDays: number;\n  isActive: boolean;\n  rating?: number;\n}\n\ninterface MaterialPricing {\n  id: string;\n  skuId: string;\n  supplierId: string;\n  currentPrice: number;\n  previousPrice?: number;\n  priceChange?: number;\n  lastUpdated: string;\n}\n\ninterface ChangeOrder {\n  id: string;\n  projectId: string;\n  changeOrderNumber: string;\n  title: string;\n  description: string;\n  status: string;\n  costImpact: number;\n  scheduleImpactDays: number;\n  createdAt: string;\n}\n\ninterface ProfitMarginSettings {\n  id: string;\n  scope: string;\n  materialMarkup: number;\n  laborMarkup: number;\n  generalConditions: number;\n  profit: number;\n  isActive: boolean;\n}\n\ninterface CostHistory {\n  id: string;\n  skuId: string;\n  recordDate: string;\n  currentPrice: number;\n  dataSource: string;\n}\n\ninterface CostEscalation {\n  id: string;\n  projectId: string;\n  escalationType: string;\n  factorPercentage: number;\n  effectiveDate: string;\n  reason: string;\n  isActive: boolean;\n}\n\nexport default function AdvancedCostManagement() {\n  const [selectedRegion, setSelectedRegion] = useState<string>(\"\");\n  const [selectedSupplier, setSelectedSupplier] = useState<string>(\"\");\n\n  // Fetch all advanced cost management data\n  const { data: regionalCosts = [] } = useQuery<RegionalCost[]>({\n    queryKey: [\"/api/regional-costs\"],\n  });\n\n  const { data: suppliers = [] } = useQuery<Supplier[]>({\n    queryKey: [\"/api/suppliers\"],\n  });\n\n  const { data: materialPricing = [] } = useQuery<MaterialPricing[]>({\n    queryKey: [\"/api/material-pricing\"],\n  });\n\n  const { data: changeOrders = [] } = useQuery<ChangeOrder[]>({\n    queryKey: [\"/api/change-orders\"],\n  });\n\n  const { data: profitMargins = [] } = useQuery<ProfitMarginSettings[]>({\n    queryKey: [\"/api/profit-margins\"],\n  });\n\n  const { data: costHistory = [] } = useQuery<CostHistory[]>({\n    queryKey: [\"/api/cost-history\"],\n  });\n\n  const { data: costEscalation = [] } = useQuery<CostEscalation[]>({\n    queryKey: [\"/api/cost-escalation\"],\n  });\n\n  // Calculate summary statistics\n  const totalSuppliers = suppliers.length;\n  const activeSuppliers = suppliers.filter(s => s.isActive).length;\n  const pendingChangeOrders = changeOrders.filter(co => co.status === 'pending').length;\n  const totalChangeOrderValue = changeOrders.reduce((sum, co) => sum + co.costImpact, 0);\n  const avgCostIndex = regionalCosts.reduce((sum, rc) => sum + rc.costIndex, 0) / regionalCosts.length || 0;\n\n  return (\n    <div className=\"container mx-auto p-6 space-y-6\" data-testid=\"advanced-cost-management\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Advanced Cost Management</h1>\n          <p className=\"text-muted-foreground\">\n            Comprehensive cost analysis, supplier management, and pricing optimization\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" data-testid=\"button-sync-pricing\">\n            <TrendingUp className=\"h-4 w-4 mr-2\" />\n            Sync Pricing\n          </Button>\n          <Button data-testid=\"button-generate-report\">\n            <DollarSign className=\"h-4 w-4 mr-2\" />\n            Generate Report\n          </Button>\n        </div>\n      </div>\n\n      {/* Overview Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card data-testid=\"card-total-suppliers\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Suppliers</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{totalSuppliers}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {activeSuppliers} active\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-change-orders\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Change Orders</CardTitle>\n            <AlertTriangle className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{changeOrders.length}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {pendingChangeOrders} pending\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-change-order-value\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Change Order Value</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">${totalChangeOrderValue.toLocaleString()}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              Total impact\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-avg-cost-index\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Avg Cost Index</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{avgCostIndex.toFixed(2)}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              Regional average\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Main Content Tabs */}\n      <Tabs defaultValue=\"regional-costs\" className=\"space-y-4\">\n        <TabsList className=\"grid w-full grid-cols-6\">\n          <TabsTrigger value=\"regional-costs\" data-testid=\"tab-regional-costs\">Regional Costs</TabsTrigger>\n          <TabsTrigger value=\"suppliers\" data-testid=\"tab-suppliers\">Suppliers</TabsTrigger>\n          <TabsTrigger value=\"pricing\" data-testid=\"tab-pricing\">Material Pricing</TabsTrigger>\n          <TabsTrigger value=\"change-orders\" data-testid=\"tab-change-orders\">Change Orders</TabsTrigger>\n          <TabsTrigger value=\"profit-margins\" data-testid=\"tab-profit-margins\">Profit Margins</TabsTrigger>\n          <TabsTrigger value=\"escalation\" data-testid=\"tab-escalation\">Cost Escalation</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"regional-costs\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Regional Cost Database</CardTitle>\n              <CardDescription>\n                Location-based cost indices and labor rates for accurate regional pricing\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"mb-4\">\n                <Label htmlFor=\"region-filter\">Filter by Region</Label>\n                <Select value={selectedRegion} onValueChange={setSelectedRegion}>\n                  <SelectTrigger data-testid=\"select-region-filter\">\n                    <SelectValue placeholder=\"All regions\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All regions</SelectItem>\n                    {Array.from(new Set(regionalCosts.map(rc => rc.region))).map(region => (\n                      <SelectItem key={region} value={region}>{region}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Region</TableHead>\n                    <TableHead>State</TableHead>\n                    <TableHead>City</TableHead>\n                    <TableHead>Cost Index</TableHead>\n                    <TableHead>Labor Rate</TableHead>\n                    <TableHead>Material Markup</TableHead>\n                    <TableHead>Last Updated</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {regionalCosts\n                    .filter(rc => !selectedRegion || selectedRegion === \"all\" || rc.region === selectedRegion)\n                    .map((cost) => (\n                    <TableRow key={cost.id} data-testid={`row-regional-cost-${cost.id}`}>\n                      <TableCell className=\"font-medium\">{cost.region}</TableCell>\n                      <TableCell>{cost.state}</TableCell>\n                      <TableCell>{cost.city}</TableCell>\n                      <TableCell>\n                        <Badge variant={cost.costIndex > 1.5 ? \"destructive\" : \"secondary\"}>\n                          {cost.costIndex.toFixed(2)}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>${cost.laborRate.toFixed(2)}/hr</TableCell>\n                      <TableCell>{cost.materialMarkup.toFixed(1)}%</TableCell>\n                      <TableCell>{new Date(cost.lastUpdated).toLocaleDateString()}</TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"suppliers\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Supplier Management</CardTitle>\n              <CardDescription>\n                Manage your supplier network and track performance metrics\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Supplier</TableHead>\n                    <TableHead>Contact</TableHead>\n                    <TableHead>Specialties</TableHead>\n                    <TableHead>Payment Terms</TableHead>\n                    <TableHead>Lead Time</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Rating</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {suppliers.map((supplier) => (\n                    <TableRow key={supplier.id} data-testid={`row-supplier-${supplier.id}`}>\n                      <TableCell>\n                        <div>\n                          <div className=\"font-medium\">{supplier.name}</div>\n                          <div className=\"text-sm text-muted-foreground\">{supplier.address}</div>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div>\n                          <div className=\"font-medium\">{supplier.contactName}</div>\n                          <div className=\"text-sm text-muted-foreground\">{supplier.email}</div>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex flex-wrap gap-1\">\n                          {supplier.specialties.slice(0, 2).map((specialty) => (\n                            <Badge key={specialty} variant=\"outline\" className=\"text-xs\">\n                              {specialty}\n                            </Badge>\n                          ))}\n                          {supplier.specialties.length > 2 && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              +{supplier.specialties.length - 2}\n                            </Badge>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>{supplier.paymentTerms}</TableCell>\n                      <TableCell>{supplier.leadTimeDays} days</TableCell>\n                      <TableCell>\n                        <Badge variant={supplier.isActive ? \"default\" : \"secondary\"}>\n                          {supplier.isActive ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        {supplier.rating ? (\n                          <div className=\"flex items-center\">\n                            <span className=\"font-medium\">{supplier.rating.toFixed(1)}</span>\n                            <span className=\"text-muted-foreground ml-1\">/5</span>\n                          </div>\n                        ) : (\n                          <span className=\"text-muted-foreground\">No rating</span>\n                        )}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"pricing\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Material Pricing Analysis</CardTitle>\n              <CardDescription>\n                Real-time material pricing and supplier comparisons\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>SKU</TableHead>\n                    <TableHead>Supplier</TableHead>\n                    <TableHead>Current Price</TableHead>\n                    <TableHead>Previous Price</TableHead>\n                    <TableHead>Change</TableHead>\n                    <TableHead>Last Updated</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {materialPricing.map((pricing) => (\n                    <TableRow key={pricing.id} data-testid={`row-pricing-${pricing.id}`}>\n                      <TableCell className=\"font-medium\">{pricing.skuId}</TableCell>\n                      <TableCell>{pricing.supplierId}</TableCell>\n                      <TableCell>${pricing.currentPrice.toFixed(2)}</TableCell>\n                      <TableCell>\n                        {pricing.previousPrice ? `$${pricing.previousPrice.toFixed(2)}` : \"â€”\"}\n                      </TableCell>\n                      <TableCell>\n                        {pricing.priceChange && (\n                          <Badge variant={pricing.priceChange > 0 ? \"destructive\" : \"default\"}>\n                            {pricing.priceChange > 0 ? \"+\" : \"\"}{pricing.priceChange.toFixed(1)}%\n                          </Badge>\n                        )}\n                      </TableCell>\n                      <TableCell>{new Date(pricing.lastUpdated).toLocaleDateString()}</TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"change-orders\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Change Order Management</CardTitle>\n              <CardDescription>\n                Track project changes and their cost impact\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Number</TableHead>\n                    <TableHead>Title</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Cost Impact</TableHead>\n                    <TableHead>Schedule Impact</TableHead>\n                    <TableHead>Created</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {changeOrders.map((changeOrder) => (\n                    <TableRow key={changeOrder.id} data-testid={`row-change-order-${changeOrder.id}`}>\n                      <TableCell className=\"font-medium\">{changeOrder.changeOrderNumber}</TableCell>\n                      <TableCell>\n                        <div>\n                          <div className=\"font-medium\">{changeOrder.title}</div>\n                          <div className=\"text-sm text-muted-foreground truncate max-w-xs\">\n                            {changeOrder.description}\n                          </div>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <Badge variant={\n                          changeOrder.status === \"approved\" ? \"default\" :\n                          changeOrder.status === \"pending\" ? \"secondary\" :\n                          \"destructive\"\n                        }>\n                          {changeOrder.status}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        <span className={changeOrder.costImpact > 0 ? \"text-red-600\" : \"text-green-600\"}>\n                          ${changeOrder.costImpact.toLocaleString()}\n                        </span>\n                      </TableCell>\n                      <TableCell>\n                        {changeOrder.scheduleImpactDays > 0 ? \n                          `+${changeOrder.scheduleImpactDays} days` : \n                          \"No impact\"\n                        }\n                      </TableCell>\n                      <TableCell>{new Date(changeOrder.createdAt).toLocaleDateString()}</TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"profit-margins\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Profit Margin Configuration</CardTitle>\n              <CardDescription>\n                Configure profit margins by scope and trade type\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Scope</TableHead>\n                    <TableHead>Material Markup</TableHead>\n                    <TableHead>Labor Markup</TableHead>\n                    <TableHead>General Conditions</TableHead>\n                    <TableHead>Profit</TableHead>\n                    <TableHead>Status</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {profitMargins.map((margin) => (\n                    <TableRow key={margin.id} data-testid={`row-profit-margin-${margin.id}`}>\n                      <TableCell>\n                        <Badge variant=\"outline\">{margin.scope}</Badge>\n                      </TableCell>\n                      <TableCell>{margin.materialMarkup.toFixed(1)}%</TableCell>\n                      <TableCell>{margin.laborMarkup.toFixed(1)}%</TableCell>\n                      <TableCell>{margin.generalConditions.toFixed(1)}%</TableCell>\n                      <TableCell>{margin.profit.toFixed(1)}%</TableCell>\n                      <TableCell>\n                        {margin.isActive ? (\n                          <CheckCircle2 className=\"h-4 w-4 text-green-600\" />\n                        ) : (\n                          <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\n                        )}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"escalation\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Cost Escalation Factors</CardTitle>\n              <CardDescription>\n                Track and apply cost escalation factors for accurate forecasting\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Project</TableHead>\n                    <TableHead>Type</TableHead>\n                    <TableHead>Factor</TableHead>\n                    <TableHead>Effective Date</TableHead>\n                    <TableHead>Reason</TableHead>\n                    <TableHead>Status</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {costEscalation.map((escalation) => (\n                    <TableRow key={escalation.id} data-testid={`row-escalation-${escalation.id}`}>\n                      <TableCell>{escalation.projectId}</TableCell>\n                      <TableCell>\n                        <Badge variant=\"outline\">{escalation.escalationType}</Badge>\n                      </TableCell>\n                      <TableCell>\n                        <span className=\"text-red-600 font-medium\">\n                          +{escalation.factorPercentage.toFixed(1)}%\n                        </span>\n                      </TableCell>\n                      <TableCell>{new Date(escalation.effectiveDate).toLocaleDateString()}</TableCell>\n                      <TableCell className=\"max-w-xs truncate\">{escalation.reason}</TableCell>\n                      <TableCell>\n                        <Badge variant={escalation.isActive ? \"default\" : \"secondary\"}>\n                          {escalation.isActive ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","size_bytes":22655},"client/src/pages/dashboard-new.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport Layout from \"@/components/layout\";\nimport DrawingViewer from \"@/components/drawing-viewer\";\nimport InteractiveFloorPlan from \"@/components/interactive-floor-plan\";\nimport VerticalTakeoffSelector from \"@/components/vertical-takeoff-selector\";\nimport AIChatWidget from \"@/components/ai-chat-widget\";\nimport RealtimeAnalysisPanel from \"@/components/realtime-analysis-panel\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { \n  Download,\n  Ruler,\n  Square,\n  Hash,\n  MessageSquare,\n  Settings\n} from \"lucide-react\";\nimport type { Drawing, Project } from \"@shared/schema\";\n\nexport default function Dashboard() {\n  const [, setLocation] = useLocation();\n  const [selectedTakeoffTypes, setSelectedTakeoffTypes] = useState<string[]>([]);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [currentDrawing, setCurrentDrawing] = useState<Drawing | null>(null);\n  const [currentProject, setCurrentProject] = useState<Project | null>(null);\n  const [highlightedElement, setHighlightedElement] = useState<string | null>(null);\n  const [activeViewMode, setActiveViewMode] = useState<'view' | 'annotate'>('view');\n  const [activeTool, setActiveTool] = useState<'ruler' | 'area' | 'count' | null>(null);\n  const [selectedScale, setSelectedScale] = useState(\"1/4\\\" = 1'\");\n\n  const { toast } = useToast();\n\n  const handleRunAnalysis = () => {\n    // Use default types if none selected\n    const typesToAnalyze = selectedTakeoffTypes.length > 0 \n      ? selectedTakeoffTypes \n      : ['doors', 'windows', 'flooring', 'electrical'];\n    \n    if (typesToAnalyze.length === 0) {\n      toast({\n        title: \"No takeoff types available\",\n        description: \"Unable to start analysis without element types.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    setIsAnalyzing(true);\n    \n    // Update selected types if we're using defaults\n    if (selectedTakeoffTypes.length === 0) {\n      setSelectedTakeoffTypes(typesToAnalyze);\n    }\n    \n    // Simulate analysis process\n    setTimeout(() => {\n      setIsAnalyzing(false);\n      toast({\n        title: \"Analysis Complete\",\n        description: `Successfully analyzed ${typesToAnalyze.length} element types.`,\n      });\n    }, 8000); // Longer duration to show the progress steps\n  };\n\n  const createNewProject = async (drawingName: string): Promise<Project> => {\n    try {\n      const projectData = {\n        name: `Project - ${drawingName}`,\n        description: `Auto-generated project from uploaded drawing: ${drawingName}`,\n        status: \"active\"\n      };\n      \n      const project = await apiRequest(\"/api/projects\", \"POST\", projectData);\n      \n      // Invalidate projects cache so the new project appears on the projects page\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      \n      return project;\n    } catch (error) {\n      console.error(\"Failed to create project:\", error);\n      throw error;\n    }\n  };\n\n  const handleFileUpload = async (drawing: Drawing) => {\n    try {\n      let projectToUse = currentProject;\n      \n      // Create a new project if none exists\n      if (!currentProject) {\n        projectToUse = await createNewProject(drawing.name);\n        setCurrentProject(projectToUse);\n        \n        toast({\n          title: \"Project created\",\n          description: `Created new project: ${projectToUse.name}`,\n        });\n      }\n      \n      // Save the drawing to the database with the correct project ID\n      const drawingData = {\n        projectId: projectToUse!.id,\n        name: drawing.name,\n        filename: drawing.filename,\n        fileUrl: drawing.fileUrl,\n        fileType: drawing.fileType,\n        status: \"complete\",\n        scale: drawing.scale || \"1/4\\\" = 1'\",\n        aiProcessed: true,\n      };\n      \n      const savedDrawing = await apiRequest(`/api/projects/${projectToUse!.id}/drawings`, \"POST\", drawingData);\n      setCurrentDrawing(savedDrawing);\n      \n      // Auto-select common takeoff types if none are selected\n      if (selectedTakeoffTypes.length === 0) {\n        setSelectedTakeoffTypes(['doors', 'windows', 'flooring', 'electrical']);\n      }\n      \n      // Automatically start analysis after a brief delay\n      setTimeout(() => {\n        handleRunAnalysis();\n      }, 1000);\n      \n      toast({\n        title: \"File uploaded successfully\",\n        description: \"Starting automatic AI analysis...\",\n      });\n    } catch (error) {\n      console.error(\"File upload error:\", error);\n      toast({\n        title: \"Upload failed\",\n        description: error instanceof Error ? error.message : \"Failed to create project or upload drawing\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"flex h-[calc(100vh-73px)] overflow-hidden\">\n        {/* Vertical Takeoff Selector - Left Sidebar */}\n        <VerticalTakeoffSelector\n          selectedTypes={selectedTakeoffTypes}\n          onSelectionChange={setSelectedTakeoffTypes}\n          onRunAnalysis={handleRunAnalysis}\n          isAnalyzing={isAnalyzing}\n        />\n\n        {/* Main Content */}\n        <main className=\"flex-1 flex flex-col overflow-hidden\">\n          {/* Simple Header */}\n          <div className=\"bg-white border-b border-slate-200 px-6 py-3\">\n            <div className=\"flex items-center\">\n              <span className=\"text-sm text-slate-500\">\n                {currentProject ? `${currentProject.name} - ` : \"\"}{currentDrawing?.name || \"Upload a drawing to begin\"}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"flex-1 flex overflow-hidden\">\n            {/* Left side: Drawing area with toolbar */}\n            <div className=\"flex-1 flex flex-col overflow-hidden\">\n              {/* Drawing Toolbar */}\n              <div className=\"bg-slate-50 border-b border-slate-200 p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-4\">\n                    <h3 className=\"text-sm font-medium text-slate-900\">\n                      {currentDrawing?.name || \"No drawing selected\"}\n                    </h3>\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-xs text-slate-500\">Scale:</span>\n                      <select \n                        className=\"text-xs border border-slate-300 rounded px-2 py-1\"\n                        value={selectedScale}\n                        onChange={(e) => setSelectedScale(e.target.value)}\n                      >\n                        <option>1/4\" = 1'</option>\n                        <option>1/8\" = 1'</option>\n                        <option>1/2\" = 1'</option>\n                        <option>1\" = 1'</option>\n                      </select>\n                    </div>\n                    \n                    {/* Manual Measurement Tools */}\n                    <div className=\"flex items-center space-x-1 border-l border-slate-300 pl-3\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        title=\"Linear measurement\"\n                        className={activeTool === 'ruler' ? 'bg-blue-100 text-blue-700' : ''}\n                        onClick={() => setActiveTool(activeTool === 'ruler' ? null : 'ruler')}\n                      >\n                        <Ruler className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        title=\"Area measurement\"\n                        className={activeTool === 'area' ? 'bg-blue-100 text-blue-700' : ''}\n                        onClick={() => setActiveTool(activeTool === 'area' ? null : 'area')}\n                      >\n                        <Square className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        title=\"Count items\"\n                        className={activeTool === 'count' ? 'bg-blue-100 text-blue-700' : ''}\n                        onClick={() => setActiveTool(activeTool === 'count' ? null : 'count')}\n                      >\n                        <Hash className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n\n                    {/* View Controls - Moved next to measurement tools */}\n                    <div className=\"flex items-center bg-white rounded-lg p-1 border\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        className={`text-xs ${activeViewMode === 'view' ? 'bg-blue-100 text-blue-700' : 'text-slate-600'}`}\n                        onClick={() => {\n                          setActiveViewMode('view');\n                          setActiveTool(null);\n                          toast({\n                            title: \"View Mode\",\n                            description: \"Navigate and zoom the drawing\",\n                          });\n                        }}\n                      >\n                        View\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        className={`text-xs ${activeViewMode === 'annotate' ? 'bg-blue-100 text-blue-700' : 'text-slate-600'}`}\n                        onClick={() => {\n                          setActiveViewMode('annotate');\n                          setActiveTool(null);\n                          toast({\n                            title: \"Annotate Mode\",\n                            description: \"Click to add annotations and measurements\",\n                          });\n                        }}\n                      >\n                        Annotate\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \n              {/* Interactive Floor Plan */}\n              <InteractiveFloorPlan \n                drawing={currentDrawing} \n                highlightedElement={highlightedElement}\n                activeViewMode={activeViewMode}\n                activeTool={activeTool}\n                selectedScale={selectedScale}\n                onElementClick={(elementId) => {\n                  if (activeTool === 'count') {\n                    toast({\n                      title: \"Element Counted\",\n                      description: `Added ${elementId} to count`,\n                    });\n                  } else {\n                    console.log('Element clicked:', elementId);\n                  }\n                }}\n                onMeasurement={(measurement) => {\n                  toast({\n                    title: \"Measurement Added\",\n                    description: `${measurement.type}: ${measurement.value}`,\n                  });\n                }}\n              />\n              \n              {/* Fallback to original DrawingViewer for file upload when no drawing */}\n              {!currentDrawing && (\n                <DrawingViewer drawing={currentDrawing} onFileUpload={handleFileUpload} />\n              )}\n            </div>\n\n            {/* Right side: Buttons + AI Analysis Panel */}\n            <div className=\"w-96 flex flex-col\">\n              {/* Header buttons positioned above AI Analysis panel */}\n              <div className=\"bg-white p-4 border-b border-slate-200\">\n                <div className=\"flex items-center space-x-3\">\n                  {/* Export Report - Aligned with AI Analysis panel */}\n                  <Button className=\"bg-green-600 hover:bg-green-700\" size=\"sm\">\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Export Report\n                  </Button>\n                  \n                  {/* AI Assistant - Positioned after Export Report */}\n                  <Button className=\"bg-purple-600 hover:bg-purple-700 text-white\" size=\"sm\">\n                    <MessageSquare className=\"w-4 h-4 mr-2\" />\n                    AI Assistant\n                  </Button>\n                  \n                  {/* Quick Settings Access */}\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setLocation('/settings')}>\n                    <Settings className=\"w-4 h-4 mr-2\" />\n                    Catalog\n                  </Button>\n                </div>\n              </div>\n              \n              {/* AI Analysis Panel */}\n              <RealtimeAnalysisPanel \n                drawing={currentDrawing}\n                selectedTypes={selectedTakeoffTypes}\n                isAnalyzing={isAnalyzing}\n                onStartAnalysis={handleRunAnalysis}\n                onElementHover={setHighlightedElement}\n              />\n            </div>\n          </div>\n\n\n        </main>\n      </div>\n    </Layout>\n  );\n}","size_bytes":13055},"client/src/pages/dashboard.tsx":{"content":"import { useState } from \"react\";\nimport Layout from \"@/components/layout\";\nimport DrawingViewer from \"@/components/drawing-viewer\";\nimport VerticalTakeoffSelector from \"@/components/vertical-takeoff-selector\";\nimport LLMTakeoffProcessor from \"@/components/llm-takeoff-processor\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Download,\n  Ruler,\n  Square,\n  Hash\n} from \"lucide-react\";\nimport type { Drawing } from \"@shared/schema\";\n\nexport default function Dashboard() {\n  const [selectedTakeoffTypes, setSelectedTakeoffTypes] = useState<string[]>([]);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n\n  const { toast } = useToast();\n\n  const handleRunAnalysis = () => {\n    if (selectedTakeoffTypes.length === 0) {\n      toast({\n        title: \"No takeoff types selected\",\n        description: \"Please select at least one element type to analyze.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    setIsAnalyzing(true);\n    // Simulate analysis process\n    setTimeout(() => {\n      setIsAnalyzing(false);\n      toast({\n        title: \"Analysis Complete\",\n        description: `Successfully analyzed ${selectedTakeoffTypes.length} element types.`,\n      });\n    }, 5000);\n  };\n\n  // Use a sample drawing for demonstration\n  const sampleDrawing: Drawing = {\n    id: \"sample-1\",\n    projectId: \"proj-1\", \n    name: \"Ground Floor Plan\",\n    filename: \"ground-floor.pdf\",\n    fileSize: 2048000,\n    uploadedAt: new Date().toISOString(),\n    status: \"complete\",\n    aiProcessed: true\n  };\n\n  return (\n    <Layout>\n      <div className=\"flex h-[calc(100vh-73px)] overflow-hidden\">\n        {/* Vertical Takeoff Selector - Left Sidebar */}\n        <VerticalTakeoffSelector\n          selectedTypes={selectedTakeoffTypes}\n          onSelectionChange={setSelectedTakeoffTypes}\n          onRunAnalysis={handleRunAnalysis}\n          isAnalyzing={isAnalyzing}\n        />\n\n        {/* Main Content */}\n        <main className=\"flex-1 flex flex-col overflow-hidden\">\n          {/* Project Actions Bar */}\n          <div className=\"bg-white border-b border-slate-200 px-6 py-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <h2 className=\"text-lg font-semibold text-slate-900\">\n                  {currentProject?.name || \"No Project Selected\"}\n                </h2>\n                {currentProject && (\n                  <span className=\"text-sm text-slate-500\">\n                    {drawings.length} drawing{drawings.length !== 1 ? 's' : ''}\n                  </span>\n                )}\n              </div>\n              \n              <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n                <DialogTrigger asChild>\n                  <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" size=\"sm\">\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Create Project\n                  </Button>\n                </DialogTrigger>\n                <DialogContent>\n                  <DialogHeader>\n                    <DialogTitle>Create New Project</DialogTitle>\n                  </DialogHeader>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <Label htmlFor=\"dashboard-project-name\">Project Name</Label>\n                      <Input\n                        id=\"dashboard-project-name\"\n                        value={newProject.name}\n                        onChange={(e) => setNewProject({ ...newProject, name: e.target.value })}\n                        placeholder=\"Enter project name\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"dashboard-project-location\">Location</Label>\n                      <Input\n                        id=\"dashboard-project-location\"\n                        value={newProject.location || \"\"}\n                        onChange={(e) => setNewProject({ ...newProject, location: e.target.value })}\n                        placeholder=\"Enter project location\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"dashboard-project-client\">Client</Label>\n                      <Input\n                        id=\"dashboard-project-client\"\n                        value={newProject.client || \"\"}\n                        onChange={(e) => setNewProject({ ...newProject, client: e.target.value })}\n                        placeholder=\"Enter client name\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"dashboard-project-description\">Description</Label>\n                      <Input\n                        id=\"dashboard-project-description\"\n                        value={newProject.description || \"\"}\n                        onChange={(e) => setNewProject({ ...newProject, description: e.target.value })}\n                        placeholder=\"Enter project description\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"dashboard-project-status\">Status</Label>\n                      <select\n                        id=\"dashboard-project-status\"\n                        value={newProject.status}\n                        onChange={(e) => setNewProject({ ...newProject, status: e.target.value })}\n                        className=\"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm\"\n                      >\n                        <option value=\"active\">Active</option>\n                        <option value=\"on-hold\">On Hold</option>\n                        <option value=\"completed\">Completed</option>\n                      </select>\n                    </div>\n                    <div className=\"flex space-x-2 pt-4\">\n                      <Button\n                        onClick={handleCreateProject}\n                        disabled={createProjectMutation.isPending}\n                        className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                      >\n                        {createProjectMutation.isPending ? \"Creating...\" : \"Create Project\"}\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        onClick={() => setIsCreateDialogOpen(false)}\n                      >\n                        Cancel\n                      </Button>\n                    </div>\n                  </div>\n                </DialogContent>\n              </Dialog>\n            </div>\n          </div>\n\n          {/* Drawing Toolbar */}\n          <div className=\"bg-slate-50 border-b border-slate-200 p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <h3 className=\"text-sm font-medium text-slate-900\">\n                  {selectedDrawing?.name || \"Select a drawing\"}\n                </h3>\n                <div className=\"flex items-center space-x-2\">\n                  <span className=\"text-xs text-slate-500\">Scale:</span>\n                  <select className=\"text-xs border border-slate-300 rounded px-2 py-1\">\n                    <option>1/4\" = 1'</option>\n                    <option>1/8\" = 1'</option>\n                    <option>1/2\" = 1'</option>\n                  </select>\n                </div>\n                \n                {/* Manual Measurement Tools */}\n                <div className=\"flex items-center space-x-1 border-l border-slate-300 pl-3\">\n                  <Button variant=\"ghost\" size=\"sm\" title=\"Linear measurement\">\n                    <Ruler className=\"w-4 h-4\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\" title=\"Area measurement\">\n                    <Square className=\"w-4 h-4\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\" title=\"Count items\">\n                    <Hash className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-3\">\n                {/* View Controls */}\n                <div className=\"flex items-center bg-white rounded-lg p-1 border\">\n                  <Button variant=\"ghost\" size=\"sm\" className=\"bg-blueprint-50 text-blueprint-700 text-xs\">\n                    View\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\" className=\"text-slate-600 text-xs\">\n                    Annotate\n                  </Button>\n                </div>\n                \n                {/* AI Takeoff Button */}\n                <Dialog open={isTakeoffDialogOpen} onOpenChange={setIsTakeoffDialogOpen}>\n                  <DialogTrigger asChild>\n                    <Button \n                      className=\"bg-purple-600 hover:bg-purple-700\" \n                      size=\"sm\"\n                      disabled={!selectedDrawing}\n                    >\n                      <Brain className=\"w-4 h-4 mr-2\" />\n                      Run AI Takeoff\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n                    <DialogHeader>\n                      <DialogTitle>AI Takeoff Analysis</DialogTitle>\n                    </DialogHeader>\n                    {selectedDrawing && (\n                      <TakeoffTypeSelector \n                        drawing={selectedDrawing} \n                        onComplete={() => setIsTakeoffDialogOpen(false)}\n                      />\n                    )}\n                  </DialogContent>\n                </Dialog>\n\n                {/* Export */}\n                <Button className=\"bg-green-600 hover:bg-green-700\" size=\"sm\">\n                  <Download className=\"w-4 h-4 mr-2\" />\n                  Export Report\n                </Button>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex-1 flex overflow-hidden\">\n            {/* Drawing Viewer */}\n            <DrawingViewer drawing={selectedDrawing} />\n\n            {/* Enhanced LLM Takeoff Panel */}\n            <div className=\"w-96 bg-white border-l border-slate-200 flex flex-col overflow-hidden\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <h2 className=\"text-lg font-semibold text-slate-900\">AI Takeoff Analysis</h2>\n                <p className=\"text-sm text-slate-600\">Advanced LLM-powered floorplan analysis</p>\n              </div>\n              <div className=\"flex-1 overflow-y-auto p-4\">\n                {selectedDrawing ? (\n                  <LLMTakeoffProcessor \n                    drawing={selectedDrawing} \n                    onAnalysisComplete={() => {\n                      // Refresh takeoff data after analysis\n                    }}\n                  />\n                ) : (\n                  <div className=\"flex-1 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <Brain className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                      <p className=\"text-sm text-slate-600\">Select a drawing to begin AI analysis</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </main>\n      </div>\n    </Layout>\n  );\n}\n","size_bytes":11431},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/project-detail.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport Layout from \"@/components/layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport { ReportGeneratorComponent } from \"@/components/report-generator\";\nimport { ReportsDashboard } from \"@/components/reports-dashboard\";\nimport { \n  ArrowLeft,\n  Building, \n  Calendar,\n  MapPin,\n  FileImage,\n  Activity,\n  Edit,\n  Trash2,\n  MoreVertical,\n  Save,\n  Download,\n  Plus,\n  RotateCcw,\n  CheckSquare,\n  Square,\n  Copy,\n  Eye,\n  Calculator,\n  FileText,\n  DollarSign,\n  Check,\n  X\n} from \"lucide-react\";\nimport type { Project, SavedAnalysis, Takeoff, Drawing } from \"@shared/schema\";\n\nexport default function ProjectDetail() {\n  const [match, params] = useRoute(\"/projects/:id\");\n  const projectId = params?.id;\n  const [, setLocation] = useLocation();\n  const [isEditingTakeoff, setIsEditingTakeoff] = useState<string | null>(null);\n  const [editValues, setEditValues] = useState<{ \n    quantity: number; \n    costPerUnit: number; \n    notes: string; \n    area: number | null; \n    length: number | null; \n  }>({\n    quantity: 0,\n    costPerUnit: 0,\n    notes: \"\",\n    area: null,\n    length: null\n  });\n  const [isSaveAnalysisOpen, setIsSaveAnalysisOpen] = useState(false);\n  const [analysisName, setAnalysisName] = useState(\"\");\n  const [analysisDescription, setAnalysisDescription] = useState(\"\");\n  const [isDeleteAnalysisOpen, setIsDeleteAnalysisOpen] = useState(false);\n  const [selectedAnalysis, setSelectedAnalysis] = useState<SavedAnalysis | null>(null);\n  const [selectedTakeoffs, setSelectedTakeoffs] = useState<Set<string>>(new Set());\n  const [batchEditMode, setBatchEditMode] = useState(false);\n  \n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch project data\n  const { data: project, isLoading: projectLoading } = useQuery<Project>({\n    queryKey: [\"/api/projects\", projectId],\n    enabled: !!projectId,\n  });\n\n  // Fetch project drawings\n  const { data: drawings = [], isLoading: drawingsLoading } = useQuery<Drawing[]>({\n    queryKey: [\"/api/projects\", projectId, \"drawings\"],\n    enabled: !!projectId,\n  });\n\n  // Fetch takeoffs for all drawings\n  const { data: takeoffs = [], isLoading: takeoffsLoading } = useQuery<Takeoff[]>({\n    queryKey: [\"/api/projects\", projectId, \"takeoffs\"],\n    enabled: !!projectId,\n  });\n\n  // Fetch saved analyses\n  const { data: savedAnalyses = [] } = useQuery<SavedAnalysis[]>({\n    queryKey: [\"/api/projects\", projectId, \"saved-analyses\"],\n    enabled: !!projectId,\n  });\n\n  // Update takeoff mutation\n  const updateTakeoffMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) =>\n      apiRequest(`/api/takeoffs/${id}`, \"PATCH\", data),\n    onSuccess: () => {\n      toast({\n        title: \"Takeoff updated\",\n        description: \"Takeoff has been updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"takeoffs\"] });\n      setIsEditingTakeoff(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to update takeoff\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Save analysis mutation\n  const saveAnalysisMutation = useMutation({\n    mutationFn: (data: any) => apiRequest(`/api/projects/${projectId}/save-analysis`, \"POST\", data),\n    onSuccess: () => {\n      toast({\n        title: \"Analysis saved\",\n        description: \"Analysis has been saved successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"saved-analyses\"] });\n      setIsSaveAnalysisOpen(false);\n      setAnalysisName(\"\");\n      setAnalysisDescription(\"\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to save analysis\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete analysis mutation\n  const deleteAnalysisMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(`/api/saved-analyses/${id}`, \"DELETE\"),\n    onSuccess: () => {\n      toast({\n        title: \"Analysis deleted\",\n        description: \"Analysis has been deleted successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"saved-analyses\"] });\n      setIsDeleteAnalysisOpen(false);\n      setSelectedAnalysis(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to delete analysis\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleEditTakeoff = (takeoff: Takeoff) => {\n    setIsEditingTakeoff(takeoff.id);\n    setEditValues({\n      quantity: takeoff.quantity || 0,\n      costPerUnit: takeoff.costPerUnit || 0,\n      notes: takeoff.notes || \"\",\n      area: takeoff.area,\n      length: takeoff.length\n    });\n  };\n\n  const handleSaveTakeoff = (takeoffId: string) => {\n    const totalCost = editValues.quantity * editValues.costPerUnit;\n    updateTakeoffMutation.mutate({\n      id: takeoffId,\n      data: {\n        quantity: editValues.quantity,\n        costPerUnit: editValues.costPerUnit,\n        area: editValues.area,\n        length: editValues.length,\n        totalCost,\n        notes: editValues.notes,\n        verified: true,\n        manuallyEdited: true\n      }\n    });\n  };\n\n  const handleSaveAnalysis = () => {\n    if (!analysisName.trim()) {\n      toast({\n        title: \"Analysis name required\",\n        description: \"Please enter a name for the analysis.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const totalItems = takeoffs.length;\n    const totalCost = takeoffs.reduce((sum: number, takeoff: Takeoff) => sum + (takeoff.totalCost || 0), 0);\n    const elementTypes = Array.from(new Set(takeoffs.map((t: Takeoff) => t.elementType)));\n\n    saveAnalysisMutation.mutate({\n      name: analysisName,\n      description: analysisDescription,\n      analysisData: {\n        takeoffs,\n        drawings,\n        timestamp: new Date().toISOString()\n      },\n      totalItems,\n      totalCost,\n      elementTypes\n    });\n  };\n\n  const handleDeleteAnalysis = (analysis: SavedAnalysis) => {\n    setSelectedAnalysis(analysis);\n    setIsDeleteAnalysisOpen(true);\n  };\n\n  const confirmDeleteAnalysis = () => {\n    if (selectedAnalysis) {\n      deleteAnalysisMutation.mutate(selectedAnalysis.id);\n    }\n  };\n\n  // Batch operations\n  const toggleTakeoffSelection = (takeoffId: string) => {\n    const newSelected = new Set(selectedTakeoffs);\n    if (newSelected.has(takeoffId)) {\n      newSelected.delete(takeoffId);\n    } else {\n      newSelected.add(takeoffId);\n    }\n    setSelectedTakeoffs(newSelected);\n  };\n\n  const selectAllTakeoffs = () => {\n    setSelectedTakeoffs(new Set(takeoffs.map(t => t.id)));\n  };\n\n  const clearTakeoffSelection = () => {\n    setSelectedTakeoffs(new Set());\n  };\n\n  // Batch operations using the batch API endpoint\n  const batchUpdateMutation = useMutation({\n    mutationFn: ({ takeoffIds, updates }: { takeoffIds: string[]; updates: any }) =>\n      apiRequest(\"/api/takeoffs/batch\", \"PATCH\", { takeoffIds, updates }),\n    onSuccess: () => {\n      toast({\n        title: \"Batch update completed\",\n        description: \"Selected takeoffs have been updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"takeoffs\"] });\n      clearTakeoffSelection();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Batch update failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const batchMarkAsVerified = () => {\n    batchUpdateMutation.mutate({\n      takeoffIds: Array.from(selectedTakeoffs),\n      updates: { verified: true }\n    });\n  };\n\n  const batchApplyPricing = (costPerUnit: number) => {\n    const updates: any = { \n      costPerUnit,\n      manuallyEdited: true\n    };\n    \n    // Calculate totalCost for each takeoff individually would require individual updates\n    // For now, we'll use individual mutations to handle quantity-specific calculations\n    selectedTakeoffs.forEach(takeoffId => {\n      const takeoff = takeoffs.find(t => t.id === takeoffId);\n      if (takeoff) {\n        updateTakeoffMutation.mutate({\n          id: takeoffId,\n          data: { \n            costPerUnit,\n            totalCost: (takeoff.quantity || 0) * costPerUnit,\n            manuallyEdited: true\n          }\n        });\n      }\n    });\n    clearTakeoffSelection();\n  };\n\n  const exportTakeoffs = () => {\n    // Enhanced CSV with material/labor separation and additional details\n    const headers = [\n      \"Element Type\", \n      \"Item Name\", \n      \"Quantity\", \n      \"Unit\", \n      \"Area (sq ft)\", \n      \"Length (ft)\",\n      \"Material Cost/Unit\", \n      \"Labor Cost/Unit\", \n      \"Total Cost/Unit\",\n      \"Total Material Cost\",\n      \"Total Labor Cost\", \n      \"Total Cost\", \n      \"AI Detected\",\n      \"Manually Edited\",\n      \"Original Quantity\",\n      \"Verified\", \n      \"Notes\"\n    ];\n    \n    const rows = takeoffs.map((takeoff: Takeoff) => {\n      // Estimate material/labor split (typically 60/40 for construction)\n      const totalCostPerUnit = takeoff.costPerUnit || 0;\n      const materialCostPerUnit = totalCostPerUnit * 0.6;\n      const laborCostPerUnit = totalCostPerUnit * 0.4;\n      const quantity = takeoff.quantity || 0;\n      \n      return [\n        takeoff.elementType,\n        takeoff.elementName,\n        quantity.toString(),\n        takeoff.unit,\n        takeoff.area?.toString() || \"\",\n        takeoff.length?.toString() || \"\",\n        materialCostPerUnit.toFixed(2),\n        laborCostPerUnit.toFixed(2),\n        totalCostPerUnit.toString(),\n        (materialCostPerUnit * quantity).toFixed(2),\n        (laborCostPerUnit * quantity).toFixed(2),\n        takeoff.totalCost?.toString() || \"0\",\n        takeoff.detectedByAi ? \"Yes\" : \"No\",\n        takeoff.manuallyEdited ? \"Yes\" : \"No\",\n        takeoff.originalQuantity?.toString() || \"\",\n        takeoff.verified ? \"Yes\" : \"No\",\n        takeoff.notes || \"\"\n      ];\n    });\n\n    const csvContent = [headers, ...rows]\n      .map(row => row.map((cell: string) => `\"${cell}\"`).join(\",\"))\n      .join(\"\\n\");\n\n    // Download enhanced CSV\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `${project?.name || \"project\"}-detailed-takeoffs.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n\n    toast({\n      title: \"Export Complete\",\n      description: \"Detailed takeoff report with material/labor breakdown has been downloaded.\",\n    });\n  };\n\n  if (!match || !projectId) {\n    return null;\n  }\n\n  if (projectLoading) {\n    return (\n      <Layout>\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blueprint-600\"></div>\n        </div>\n      </Layout>\n    );\n  }\n\n  if (!project) {\n    return (\n      <Layout>\n        <div className=\"text-center py-12\">\n          <h3 className=\"text-lg font-medium text-slate-900 mb-2\">Project Not Found</h3>\n          <p className=\"text-slate-600 mb-6\">The requested project could not be found.</p>\n          <Button onClick={() => setLocation(\"/projects\")}>\n            Back to Projects\n          </Button>\n        </div>\n      </Layout>\n    );\n  }\n\n  const totalCost = takeoffs.reduce((sum: number, takeoff: Takeoff) => sum + (takeoff.totalCost || 0), 0);\n  const totalItems = takeoffs.length;\n  const verifiedItems = takeoffs.filter((t: Takeoff) => t.verified).length;\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              onClick={() => setLocation(\"/projects\")}\n              className=\"text-slate-600 hover:text-slate-900\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Projects\n            </Button>\n            <div>\n              <h1 className=\"text-2xl font-bold text-slate-900\">{project?.name}</h1>\n              <p className=\"text-slate-600 mt-1\">{project?.description || \"No description provided\"}</p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center space-x-3\">\n            <Dialog open={isSaveAnalysisOpen} onOpenChange={setIsSaveAnalysisOpen}>\n              <DialogTrigger asChild>\n                <Button variant=\"outline\">\n                  <Save className=\"w-4 h-4 mr-2\" />\n                  Save Analysis\n                </Button>\n              </DialogTrigger>\n              <DialogContent>\n                <DialogHeader>\n                  <DialogTitle>Save Current Analysis</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label htmlFor=\"analysis-name\">Analysis Name</Label>\n                    <Input\n                      id=\"analysis-name\"\n                      value={analysisName}\n                      onChange={(e) => setAnalysisName(e.target.value)}\n                      placeholder=\"Enter analysis name\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"analysis-description\">Description (Optional)</Label>\n                    <Textarea\n                      id=\"analysis-description\"\n                      value={analysisDescription}\n                      onChange={(e) => setAnalysisDescription(e.target.value)}\n                      placeholder=\"Enter analysis description\"\n                      rows={3}\n                    />\n                  </div>\n                  <div className=\"flex space-x-2 pt-4\">\n                    <Button\n                      onClick={handleSaveAnalysis}\n                      disabled={saveAnalysisMutation.isPending}\n                      className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                    >\n                      {saveAnalysisMutation.isPending ? \"Saving...\" : \"Save Analysis\"}\n                    </Button>\n                    <Button variant=\"outline\" onClick={() => setIsSaveAnalysisOpen(false)}>\n                      Cancel\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n\n            <ReportGeneratorComponent\n              project={project}\n              takeoffs={takeoffs}\n              drawings={drawings}\n              analyses={savedAnalyses}\n            />\n\n            <Button onClick={exportTakeoffs} variant=\"outline\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export CSV\n            </Button>\n          </div>\n        </div>\n\n        {/* Project Info */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6 pt-6 border-t border-slate-200\">\n          <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n            <MapPin className=\"w-4 h-4\" />\n            <span>{project?.location || \"No location specified\"}</span>\n          </div>\n          <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n            <Building className=\"w-4 h-4\" />\n            <span>{project?.client || \"No client specified\"}</span>\n          </div>\n          <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n            <Calendar className=\"w-4 h-4\" />\n            <span>Created {project?.createdAt ? new Date(project.createdAt).toLocaleDateString() : 'Unknown'}</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Badge \n              variant=\"secondary\" \n              className={\n                project?.status === \"active\" \n                  ? \"bg-green-100 text-green-700\"\n                  : project?.status === \"on-hold\"\n                  ? \"bg-yellow-100 text-yellow-700\"\n                  : \"bg-slate-100 text-slate-700\"\n              }\n            >\n              {project?.status}\n            </Badge>\n          </div>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"p-6 border-b border-slate-200\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"p-2 bg-blue-100 rounded-lg\">\n                  <FileImage className=\"w-5 h-5 text-blue-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-slate-900\">{drawings.length}</p>\n                  <p className=\"text-xs text-slate-500\">Drawings</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"p-2 bg-green-100 rounded-lg\">\n                  <Calculator className=\"w-5 h-5 text-green-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-slate-900\">{totalItems}</p>\n                  <p className=\"text-xs text-slate-500\">Total Items</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"p-2 bg-purple-100 rounded-lg\">\n                  <Check className=\"w-5 h-5 text-purple-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-slate-900\">{verifiedItems}/{totalItems}</p>\n                  <p className=\"text-xs text-slate-500\">Verified</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"p-2 bg-yellow-100 rounded-lg\">\n                  <DollarSign className=\"w-5 h-5 text-yellow-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-slate-900\">${totalCost.toLocaleString()}</p>\n                  <p className=\"text-xs text-slate-500\">Total Cost</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"p-6\">\n        <Tabs defaultValue=\"takeoffs\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-6\">\n            <TabsTrigger value=\"takeoffs\">Takeoffs</TabsTrigger>\n            <TabsTrigger value=\"saved-analyses\">Saved Analyses</TabsTrigger>\n            <TabsTrigger value=\"drawings\">Drawings</TabsTrigger>\n            <TabsTrigger value=\"pricing\">Pricing</TabsTrigger>\n            <TabsTrigger value=\"skus\">SKUs</TabsTrigger>\n            <TabsTrigger value=\"reports\">Reports</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"takeoffs\" className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg border border-slate-200\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-slate-900\">Takeoff Items</h3>\n                    <p className=\"text-sm text-slate-600\">Review and edit extracted quantities and costs</p>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => setBatchEditMode(!batchEditMode)}\n                      className={batchEditMode ? \"bg-blue-50 border-blue-200\" : \"\"}\n                    >\n                      {batchEditMode ? <CheckSquare className=\"w-4 h-4 mr-1\" /> : <Square className=\"w-4 h-4 mr-1\" />}\n                      Batch Mode\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Batch Operations Toolbar */}\n                {batchEditMode && (\n                  <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg border\">\n                    <div className=\"flex items-center space-x-4 text-sm\">\n                      <span className=\"text-slate-600\">\n                        {selectedTakeoffs.size} of {takeoffs.length} selected\n                      </span>\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={selectAllTakeoffs}\n                        disabled={selectedTakeoffs.size === takeoffs.length}\n                      >\n                        Select All\n                      </Button>\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={clearTakeoffSelection}\n                        disabled={selectedTakeoffs.size === 0}\n                      >\n                        Clear\n                      </Button>\n                    </div>\n\n                    {selectedTakeoffs.size > 0 && (\n                      <div className=\"flex items-center space-x-2\">\n                        <Button\n                          size=\"sm\"\n                          onClick={batchMarkAsVerified}\n                          disabled={updateTakeoffMutation.isPending}\n                        >\n                          <Check className=\"w-4 h-4 mr-1\" />\n                          Mark Verified\n                        </Button>\n                        <DropdownMenu>\n                          <DropdownMenuTrigger asChild>\n                            <Button size=\"sm\" variant=\"outline\">\n                              <DollarSign className=\"w-4 h-4 mr-1\" />\n                              Apply Pricing\n                            </Button>\n                          </DropdownMenuTrigger>\n                          <DropdownMenuContent align=\"end\">\n                            <DropdownMenuItem onClick={() => batchApplyPricing(10)}>\n                              $10.00 per unit\n                            </DropdownMenuItem>\n                            <DropdownMenuItem onClick={() => batchApplyPricing(25)}>\n                              $25.00 per unit\n                            </DropdownMenuItem>\n                            <DropdownMenuItem onClick={() => batchApplyPricing(50)}>\n                              $50.00 per unit\n                            </DropdownMenuItem>\n                            <DropdownMenuItem onClick={() => batchApplyPricing(100)}>\n                              $100.00 per unit\n                            </DropdownMenuItem>\n                          </DropdownMenuContent>\n                        </DropdownMenu>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n              \n              {takeoffsLoading ? (\n                <div className=\"p-8 text-center\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blueprint-600 mx-auto\"></div>\n                  <p className=\"text-slate-600 mt-2\">Loading takeoffs...</p>\n                </div>\n              ) : takeoffs.length === 0 ? (\n                <div className=\"p-8 text-center\">\n                  <Calculator className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                  <h4 className=\"text-lg font-medium text-slate-900 mb-2\">No Takeoffs Yet</h4>\n                  <p className=\"text-slate-600\">Upload drawings and run AI analysis to see takeoff items here.</p>\n                </div>\n              ) : (\n                <div className=\"divide-y divide-slate-200\">\n                  {takeoffs.map((takeoff) => (\n                    <div key={takeoff.id} className=\"p-4\">\n                      {isEditingTakeoff === takeoff.id ? (\n                        <div className=\"space-y-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <h4 className=\"font-medium text-slate-900\">{takeoff.elementName}</h4>\n                              <p className=\"text-sm text-slate-600\">{takeoff.elementType}</p>\n                            </div>\n                            <div className=\"flex items-center space-x-2\">\n                              <Button\n                                size=\"sm\"\n                                onClick={() => handleSaveTakeoff(takeoff.id)}\n                                disabled={updateTakeoffMutation.isPending}\n                              >\n                                <Check className=\"w-4 h-4 mr-1\" />\n                                Save\n                              </Button>\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => setIsEditingTakeoff(null)}\n                              >\n                                <X className=\"w-4 h-4 mr-1\" />\n                                Cancel\n                              </Button>\n                            </div>\n                          </div>\n                          \n                          {/* Core Measurements */}\n                          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                            <div>\n                              <Label htmlFor={`quantity-${takeoff.id}`}>\n                                Quantity\n                                {takeoff.originalQuantity && takeoff.originalQuantity !== editValues.quantity && (\n                                  <span className=\"text-xs text-slate-500 ml-1\">(AI: {takeoff.originalQuantity})</span>\n                                )}\n                              </Label>\n                              <Input\n                                id={`quantity-${takeoff.id}`}\n                                type=\"number\"\n                                value={editValues.quantity}\n                                onChange={(e) => setEditValues({\n                                  ...editValues,\n                                  quantity: parseInt(e.target.value) || 0\n                                })}\n                                className={takeoff.originalQuantity && takeoff.originalQuantity !== editValues.quantity ? \n                                  \"border-yellow-300 bg-yellow-50\" : \"\"}\n                              />\n                            </div>\n                            \n                            {takeoff.area !== null && (\n                              <div>\n                                <Label htmlFor={`area-${takeoff.id}`}>\n                                  Area (sq ft)\n                                  {takeoff.originalArea && takeoff.originalArea !== editValues.area && (\n                                    <span className=\"text-xs text-slate-500 ml-1\">(AI: {takeoff.originalArea})</span>\n                                  )}\n                                </Label>\n                                <Input\n                                  id={`area-${takeoff.id}`}\n                                  type=\"number\"\n                                  step=\"0.1\"\n                                  value={editValues.area || ''}\n                                  onChange={(e) => setEditValues({\n                                    ...editValues,\n                                    area: parseFloat(e.target.value) || null\n                                  })}\n                                  className={takeoff.originalArea && takeoff.originalArea !== editValues.area ? \n                                    \"border-yellow-300 bg-yellow-50\" : \"\"}\n                                />\n                              </div>\n                            )}\n                            \n                            {takeoff.length !== null && (\n                              <div>\n                                <Label htmlFor={`length-${takeoff.id}`}>\n                                  Length (ft)\n                                  {takeoff.originalLength && takeoff.originalLength !== editValues.length && (\n                                    <span className=\"text-xs text-slate-500 ml-1\">(AI: {takeoff.originalLength})</span>\n                                  )}\n                                </Label>\n                                <Input\n                                  id={`length-${takeoff.id}`}\n                                  type=\"number\"\n                                  step=\"0.1\"\n                                  value={editValues.length || ''}\n                                  onChange={(e) => setEditValues({\n                                    ...editValues,\n                                    length: parseFloat(e.target.value) || null\n                                  })}\n                                  className={takeoff.originalLength && takeoff.originalLength !== editValues.length ? \n                                    \"border-yellow-300 bg-yellow-50\" : \"\"}\n                                />\n                              </div>\n                            )}\n                            \n                            <div>\n                              <Label htmlFor={`cost-${takeoff.id}`}>\n                                Cost Per Unit ($)\n                                {takeoff.originalCostPerUnit && takeoff.originalCostPerUnit !== editValues.costPerUnit && (\n                                  <span className=\"text-xs text-slate-500 ml-1\">(Original: ${takeoff.originalCostPerUnit})</span>\n                                )}\n                              </Label>\n                              <Input\n                                id={`cost-${takeoff.id}`}\n                                type=\"number\"\n                                step=\"0.01\"\n                                value={editValues.costPerUnit}\n                                onChange={(e) => setEditValues({\n                                  ...editValues,\n                                  costPerUnit: parseFloat(e.target.value) || 0\n                                })}\n                                className={takeoff.originalCostPerUnit && takeoff.originalCostPerUnit !== editValues.costPerUnit ? \n                                  \"border-yellow-300 bg-yellow-50\" : \"\"}\n                              />\n                            </div>\n                          </div>\n\n                          {/* Calculated Values */}\n                          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-3 bg-slate-50 rounded-lg\">\n                            <div>\n                              <Label className=\"text-xs text-slate-600\">Unit</Label>\n                              <p className=\"font-medium\">{takeoff.unit}</p>\n                            </div>\n                            <div>\n                              <Label className=\"text-xs text-slate-600\">Calculated Total Cost</Label>\n                              <p className=\"font-medium text-lg text-slate-900\">\n                                ${(editValues.quantity * editValues.costPerUnit).toLocaleString()}\n                              </p>\n                            </div>\n                            <div className=\"flex items-end\">\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => {\n                                  if (takeoff.originalQuantity) setEditValues({...editValues, quantity: takeoff.originalQuantity});\n                                  if (takeoff.originalArea) setEditValues({...editValues, area: takeoff.originalArea});\n                                  if (takeoff.originalLength) setEditValues({...editValues, length: takeoff.originalLength});\n                                  if (takeoff.originalCostPerUnit) setEditValues({...editValues, costPerUnit: takeoff.originalCostPerUnit});\n                                }}\n                                disabled={!takeoff.originalQuantity && !takeoff.originalCostPerUnit}\n                              >\n                                <RotateCcw className=\"w-4 h-4 mr-1\" />\n                                Reset to AI\n                              </Button>\n                            </div>\n                          </div>\n                          \n                          <div>\n                            <Label htmlFor={`notes-${takeoff.id}`}>Notes (Optional)</Label>\n                            <Textarea\n                              id={`notes-${takeoff.id}`}\n                              value={editValues.notes}\n                              onChange={(e) => setEditValues({\n                                ...editValues,\n                                notes: e.target.value\n                              })}\n                              placeholder=\"Add any notes about this item...\"\n                              rows={2}\n                            />\n                          </div>\n                        </div>\n                      ) : (\n                        <div className=\"flex items-center justify-between\">\n                          {batchEditMode && (\n                            <div className=\"mr-4\">\n                              <input\n                                type=\"checkbox\"\n                                checked={selectedTakeoffs.has(takeoff.id)}\n                                onChange={() => toggleTakeoffSelection(takeoff.id)}\n                                className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500\"\n                              />\n                            </div>\n                          )}\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <h4 className=\"font-medium text-slate-900\">{takeoff.elementName}</h4>\n                              <div className=\"flex items-center space-x-2\">\n                                {takeoff.verified && (\n                                  <Badge variant=\"secondary\" className=\"bg-green-100 text-green-700\">\n                                    <Check className=\"w-3 h-3 mr-1\" />\n                                    Verified\n                                  </Badge>\n                                )}\n                                {takeoff.manuallyEdited && (\n                                  <Badge variant=\"outline\" className=\"bg-yellow-50 text-yellow-700 border-yellow-200\">\n                                    <Edit className=\"w-3 h-3 mr-1\" />\n                                    Modified\n                                  </Badge>\n                                )}\n                                {takeoff.detectedByAi && !takeoff.manuallyEdited && (\n                                  <Badge variant=\"outline\" className=\"text-blue-600 border-blue-200\">\n                                    AI Detected\n                                  </Badge>\n                                )}\n                              </div>\n                            </div>\n                            \n                            <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm\">\n                              <div>\n                                <p className=\"text-slate-500\">Type</p>\n                                <p className=\"font-medium\">{takeoff.elementType}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-slate-500\">\n                                  Quantity\n                                  {takeoff.originalQuantity && takeoff.originalQuantity !== takeoff.quantity && (\n                                    <span className=\"text-xs text-yellow-600 ml-1\">(was {takeoff.originalQuantity})</span>\n                                  )}\n                                </p>\n                                <p className=\"font-medium\">{takeoff.quantity} {takeoff.unit}</p>\n                              </div>\n                              {takeoff.area && (\n                                <div>\n                                  <p className=\"text-slate-500\">\n                                    Area\n                                    {takeoff.originalArea && takeoff.originalArea !== takeoff.area && (\n                                      <span className=\"text-xs text-yellow-600 ml-1\">(was {takeoff.originalArea})</span>\n                                    )}\n                                  </p>\n                                  <p className=\"font-medium\">{takeoff.area} sq ft</p>\n                                </div>\n                              )}\n                              <div>\n                                <p className=\"text-slate-500\">\n                                  Cost/Unit\n                                  {takeoff.originalCostPerUnit && takeoff.originalCostPerUnit !== takeoff.costPerUnit && (\n                                    <span className=\"text-xs text-yellow-600 ml-1\">(was ${takeoff.originalCostPerUnit})</span>\n                                  )}\n                                </p>\n                                <p className=\"font-medium\">${takeoff.costPerUnit?.toLocaleString() || \"0\"}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-slate-500\">Total Cost</p>\n                                <p className=\"font-medium text-slate-900\">${takeoff.totalCost?.toLocaleString() || \"0\"}</p>\n                              </div>\n                              <div className=\"flex items-center justify-end space-x-2\">\n                                <div className=\"flex items-center space-x-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => {\n                                      const newQuantity = (takeoff.quantity || 0) - 1;\n                                      if (newQuantity >= 0) {\n                                        updateTakeoffMutation.mutate({\n                                          id: takeoff.id,\n                                          data: { \n                                            quantity: newQuantity,\n                                            totalCost: newQuantity * (takeoff.costPerUnit || 0),\n                                            manuallyEdited: true\n                                          }\n                                        });\n                                      }\n                                    }}\n                                    className=\"w-6 h-6 p-0\"\n                                    disabled={!takeoff.quantity || takeoff.quantity <= 0}\n                                  >\n                                    -\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => {\n                                      const newQuantity = (takeoff.quantity || 0) + 1;\n                                      updateTakeoffMutation.mutate({\n                                        id: takeoff.id,\n                                        data: { \n                                          quantity: newQuantity,\n                                          totalCost: newQuantity * (takeoff.costPerUnit || 0),\n                                          manuallyEdited: true\n                                        }\n                                      });\n                                    }}\n                                    className=\"w-6 h-6 p-0\"\n                                  >\n                                    +\n                                  </Button>\n                                </div>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => handleEditTakeoff(takeoff)}\n                                >\n                                  <Edit className=\"w-4 h-4 mr-1\" />\n                                  Edit\n                                </Button>\n                              </div>\n                            </div>\n                            \n                            {takeoff.notes && (\n                              <div className=\"mt-2 p-2 bg-slate-50 rounded text-sm\">\n                                <p className=\"text-slate-600\">{takeoff.notes}</p>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"saved-analyses\" className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg border border-slate-200\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <h3 className=\"text-lg font-semibold text-slate-900\">Saved Analyses</h3>\n                <p className=\"text-sm text-slate-600\">Previous analysis results and snapshots</p>\n              </div>\n              \n              {savedAnalyses.length === 0 ? (\n                <div className=\"p-8 text-center\">\n                  <FileText className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                  <h4 className=\"text-lg font-medium text-slate-900 mb-2\">No Saved Analyses</h4>\n                  <p className=\"text-slate-600\">Save your current analysis to create a snapshot of takeoff results.</p>\n                </div>\n              ) : (\n                <div className=\"divide-y divide-slate-200\">\n                  {savedAnalyses.map((analysis) => (\n                    <div key={analysis.id} className=\"p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <h4 className=\"font-medium text-slate-900\">{analysis.name}</h4>\n                            <DropdownMenu>\n                              <DropdownMenuTrigger asChild>\n                                <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\n                                  <MoreVertical className=\"h-4 w-4\" />\n                                </Button>\n                              </DropdownMenuTrigger>\n                              <DropdownMenuContent align=\"end\" className=\"w-40\">\n                                <DropdownMenuItem>\n                                  <Eye className=\"mr-2 h-4 w-4\" />\n                                  View Details\n                                </DropdownMenuItem>\n                                <DropdownMenuItem>\n                                  <Download className=\"mr-2 h-4 w-4\" />\n                                  Export\n                                </DropdownMenuItem>\n                                <DropdownMenuSeparator />\n                                <DropdownMenuItem \n                                  onClick={() => handleDeleteAnalysis(analysis)}\n                                  className=\"text-red-600 focus:text-red-600\"\n                                >\n                                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                                  Delete\n                                </DropdownMenuItem>\n                              </DropdownMenuContent>\n                            </DropdownMenu>\n                          </div>\n                          \n                          {analysis.description && (\n                            <p className=\"text-sm text-slate-600 mb-2\">{analysis.description}</p>\n                          )}\n                          \n                          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                            <div>\n                              <p className=\"text-slate-500\">Items</p>\n                              <p className=\"font-medium\">{analysis.totalItems}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-slate-500\">Total Cost</p>\n                              <p className=\"font-medium\">${analysis.totalCost?.toLocaleString() || \"0\"}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-slate-500\">Elements</p>\n                              <p className=\"font-medium\">{Array.isArray(analysis.elementTypes) ? analysis.elementTypes.length : 0} types</p>\n                            </div>\n                            <div>\n                              <p className=\"text-slate-500\">Created</p>\n                              <p className=\"font-medium\">{analysis.createdAt ? new Date(analysis.createdAt).toLocaleDateString() : 'Unknown'}</p>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"drawings\" className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg border border-slate-200\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <h3 className=\"text-lg font-semibold text-slate-900\">Project Drawings</h3>\n                <p className=\"text-sm text-slate-600\">Uploaded blueprints and floor plans</p>\n              </div>\n              \n              {drawingsLoading ? (\n                <div className=\"p-8 text-center\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blueprint-600 mx-auto\"></div>\n                  <p className=\"text-slate-600 mt-2\">Loading drawings...</p>\n                </div>\n              ) : drawings.length === 0 ? (\n                <div className=\"p-8 text-center\">\n                  <FileImage className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                  <h4 className=\"text-lg font-medium text-slate-900 mb-2\">No Drawings</h4>\n                  <p className=\"text-slate-600\">Upload drawings to this project to get started with AI analysis.</p>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4\">\n                  {drawings.map((drawing) => (\n                    <Card key={drawing.id} className=\"hover:shadow-lg transition-shadow\">\n                      <CardHeader className=\"pb-3\">\n                        <CardTitle className=\"text-lg\">{drawing.name}</CardTitle>\n                      </CardHeader>\n                      <CardContent className=\"space-y-3\">\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <span className=\"text-slate-500\">Type:</span>\n                          <span className=\"font-medium\">{drawing.fileType}</span>\n                        </div>\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <span className=\"text-slate-500\">Status:</span>\n                          <Badge \n                            variant=\"secondary\"\n                            className={\n                              drawing.status === \"complete\"\n                                ? \"bg-green-100 text-green-700\"\n                                : drawing.status === \"processing\"\n                                ? \"bg-yellow-100 text-yellow-700\"\n                                : drawing.status === \"error\"\n                                ? \"bg-red-100 text-red-700\"\n                                : \"bg-slate-100 text-slate-700\"\n                            }\n                          >\n                            {drawing.status}\n                          </Badge>\n                        </div>\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <span className=\"text-slate-500\">AI Processed:</span>\n                          <Badge variant={drawing.aiProcessed ? \"default\" : \"outline\"}>\n                            {drawing.aiProcessed ? \"Yes\" : \"No\"}\n                          </Badge>\n                        </div>\n                        <div className=\"text-xs text-slate-500\">\n                          Uploaded {drawing.uploadedAt ? new Date(drawing.uploadedAt).toLocaleDateString() : 'Unknown'}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"pricing\" className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg border border-slate-200\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-slate-900\">Project Pricing</h3>\n                    <p className=\"text-sm text-slate-600\">Manage custom pricing for this project</p>\n                  </div>\n                  <Button>\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Add Custom Pricing\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"p-8 text-center\">\n                <DollarSign className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                <h4 className=\"text-lg font-medium text-slate-900 mb-2\">Custom Project Pricing</h4>\n                <p className=\"text-slate-600 mb-4\">\n                  Override default SKU pricing for this specific project. Custom pricing will be used in all calculations and reports for this project.\n                </p>\n                <p className=\"text-sm text-slate-500\">\n                  No custom pricing configured yet. This project uses default SKU pricing.\n                </p>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"skus\" className=\"space-y-4\">\n            <div className=\"bg-white rounded-lg border border-slate-200\">\n              <div className=\"p-4 border-b border-slate-200\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-slate-900\">Available SKUs</h3>\n                    <p className=\"text-sm text-slate-600\">Browse and manage product catalog</p>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button variant=\"outline\">\n                      <FileText className=\"w-4 h-4 mr-2\" />\n                      Import SKUs\n                    </Button>\n                    <Button>\n                      <Plus className=\"w-4 h-4 mr-2\" />\n                      Add SKU\n                    </Button>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"p-8 text-center\">\n                <Calculator className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                <h4 className=\"text-lg font-medium text-slate-900 mb-2\">Product SKU Catalog</h4>\n                <p className=\"text-slate-600 mb-4\">\n                  Manage your product catalog with pricing, trade classes, and vendor information. SKUs are used throughout the system for accurate cost estimation.\n                </p>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto text-sm\">\n                  <div className=\"p-3 bg-slate-50 rounded-lg\">\n                    <p className=\"font-medium text-slate-900\">General Construction</p>\n                    <p className=\"text-slate-500\">24 SKUs</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg\">\n                    <p className=\"font-medium text-slate-900\">Electrical</p>\n                    <p className=\"text-slate-500\">18 SKUs</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg\">\n                    <p className=\"font-medium text-slate-900\">Plumbing</p>\n                    <p className=\"text-slate-500\">15 SKUs</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg\">\n                    <p className=\"font-medium text-slate-900\">HVAC</p>\n                    <p className=\"text-slate-500\">12 SKUs</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"reports\" className=\"space-y-4\">\n            <ReportsDashboard\n              project={project}\n              takeoffs={takeoffs}\n              drawings={drawings}\n              analyses={savedAnalyses}\n            />\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Delete Analysis Dialog */}\n      <AlertDialog open={isDeleteAnalysisOpen} onOpenChange={setIsDeleteAnalysisOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Analysis</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{selectedAnalysis?.name}\"? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={confirmDeleteAnalysis}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              Delete Analysis\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </Layout>\n  );\n}","size_bytes":55339},"client/src/pages/projects-backup.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport Layout from \"@/components/layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { \n  Plus, \n  Building, \n  Calendar,\n  MapPin,\n  FileImage,\n  Activity,\n  Edit,\n  Trash2,\n  MoreVertical,\n  Search,\n  Filter,\n  SortAsc,\n  CheckSquare,\n  Square,\n  TrendingUp,\n  AlertTriangle,\n  CheckCircle2,\n  Clock\n} from \"lucide-react\";\nimport type { Project, InsertProject } from \"@shared/schema\";\n\nexport default function Projects() {\n  const [, setLocation] = useLocation();\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [selectedProject, setSelectedProject] = useState<Project | null>(null);\n  const [selectedProjects, setSelectedProjects] = useState<Set<string>>(new Set());\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [sortBy, setSortBy] = useState<string>(\"name\");\n  const [newProject, setNewProject] = useState<InsertProject>({\n    name: \"\",\n    description: \"\",\n    location: \"\",\n    client: \"\",\n    status: \"active\",\n  });\n  const [editProject, setEditProject] = useState<InsertProject>({\n    name: \"\",\n    description: \"\",\n    location: \"\",\n    client: \"\",\n    status: \"active\",\n  });\n  \n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: projects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects\"],\n  });\n\n  // Project health status based on AI analysis (simulated)\n  const getProjectHealth = (project: Project) => {\n    const createdDate = project.createdAt ? new Date(project.createdAt) : new Date();\n    const daysSinceCreated = Math.floor((Date.now() - createdDate.getTime()) / (1000 * 60 * 60 * 24));\n    if (daysSinceCreated < 7) return { status: 'excellent', color: 'bg-green-500', icon: CheckCircle2 };\n    if (daysSinceCreated < 30) return { status: 'good', color: 'bg-blue-500', icon: TrendingUp };\n    if (daysSinceCreated < 90) return { status: 'warning', color: 'bg-yellow-500', icon: Clock };\n    return { status: 'critical', color: 'bg-red-500', icon: AlertTriangle };\n  };\n\n  // Filtered and sorted projects\n  const filteredProjects = useMemo(() => {\n    let filtered = projects.filter(project => {\n      const matchesSearch = project.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           project.client?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           project.location?.toLowerCase().includes(searchTerm.toLowerCase());\n      const matchesStatus = statusFilter === \"all\" || project.status === statusFilter;\n      return matchesSearch && matchesStatus;\n    });\n\n    // Sort projects\n    filtered.sort((a, b) => {\n      switch (sortBy) {\n        case \"name\":\n          return a.name.localeCompare(b.name);\n        case \"client\":\n          return (a.client || \"\").localeCompare(b.client || \"\");\n        case \"created\":\n          const dateA = a.createdAt ? new Date(a.createdAt) : new Date(0);\n          const dateB = b.createdAt ? new Date(b.createdAt) : new Date(0);\n          return dateB.getTime() - dateA.getTime();\n        case \"status\":\n          return a.status.localeCompare(b.status);\n        default:\n          return 0;\n      }\n    });\n\n    return filtered;\n  }, [projects, searchTerm, statusFilter, sortBy]);\n\n  // Bulk selection handlers\n  const toggleProjectSelection = (projectId: string) => {\n    const newSelected = new Set(selectedProjects);\n    if (newSelected.has(projectId)) {\n      newSelected.delete(projectId);\n    } else {\n      newSelected.add(projectId);\n    }\n    setSelectedProjects(newSelected);\n  };\n\n  const selectAllVisible = () => {\n    setSelectedProjects(new Set(filteredProjects.map(p => p.id)));\n  };\n\n  const clearSelection = () => {\n    setSelectedProjects(new Set());\n  };\n\n  const isAllSelected = filteredProjects.length > 0 && filteredProjects.every(p => selectedProjects.has(p.id));\n\n  const createProjectMutation = useMutation({\n    mutationFn: (projectData: InsertProject) =>\n      apiRequest(\"/api/projects\", \"POST\", projectData),\n    onSuccess: () => {\n      toast({\n        title: \"Project created\",\n        description: \"New project has been created successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsCreateDialogOpen(false);\n      setNewProject({ name: \"\", description: \"\", location: \"\", client: \"\", status: \"active\" });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to create project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateProjectMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: InsertProject }) =>\n      apiRequest(`/api/projects/${id}`, \"PATCH\", data),\n    onSuccess: () => {\n      toast({\n        title: \"Project updated\",\n        description: \"Project has been updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsEditDialogOpen(false);\n      setSelectedProject(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to update project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteProjectMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(`/api/projects/${id}`, \"DELETE\"),\n    onSuccess: () => {\n      toast({\n        title: \"Project deleted\",\n        description: \"Project has been deleted successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDeleteDialogOpen(false);\n      setSelectedProject(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to delete project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateProject = () => {\n    if (!newProject.name.trim()) {\n      toast({\n        title: \"Project name required\",\n        description: \"Please enter a project name.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    createProjectMutation.mutate(newProject);\n  };\n\n  const handleEditProject = (project: Project) => {\n    setSelectedProject(project);\n    setEditProject({\n      name: project.name,\n      description: project.description || \"\",\n      location: project.location || \"\", \n      client: project.client || \"\",\n      status: project.status,\n    });\n    setIsEditDialogOpen(true);\n  };\n\n  const handleUpdateProject = () => {\n    if (!editProject.name.trim()) {\n      toast({\n        title: \"Project name required\",\n        description: \"Please enter a project name.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (selectedProject) {\n      updateProjectMutation.mutate({ id: selectedProject.id, data: editProject });\n    }\n  };\n\n  const handleDeleteProject = (project: Project) => {\n    setSelectedProject(project);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const confirmDeleteProject = () => {\n    if (selectedProject) {\n      deleteProjectMutation.mutate(selectedProject.id);\n    }\n  };\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">Projects</h1>\n            <p className=\"text-slate-600 mt-1\">Manage your construction projects and takeoffs</p>\n          </div>\n          \n          <div className=\"flex space-x-3\">\n            <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n              <DialogTrigger asChild>\n                <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" data-testid=\"button-create-project\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create Project\n                </Button>\n              </DialogTrigger>\n            </Dialog>\n          </div>\n        </div>\n\n        {/* Search and Filter Controls */}\n        <div className=\"mt-6 flex flex-col lg:flex-row gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4\" />\n              <Input\n                placeholder=\"Search projects by name, client, or location...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search-projects\"\n              />\n            </div>\n          </div>\n          \n          <div className=\"flex gap-3\">\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-32\" data-testid=\"select-status-filter\">\n                <Filter className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"active\">Active</SelectItem>\n                <SelectItem value=\"completed\">Completed</SelectItem>\n                <SelectItem value=\"on-hold\">On Hold</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={sortBy} onValueChange={setSortBy}>\n              <SelectTrigger className=\"w-32\" data-testid=\"select-sort-by\">\n                <SortAsc className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Sort\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"name\">Name</SelectItem>\n                <SelectItem value=\"client\">Client</SelectItem>\n                <SelectItem value=\"created\">Date Created</SelectItem>\n                <SelectItem value=\"status\">Status</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n\n        {/* Bulk Actions Bar */}\n        {selectedProjects.size > 0 && (\n          <div className=\"mt-4 bg-slate-50 border border-slate-200 rounded-lg p-4 flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <span className=\"text-sm font-medium text-slate-700\">\n                {selectedProjects.size} project{selectedProjects.size !== 1 ? 's' : ''} selected\n              </span>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={clearSelection}\n                data-testid=\"button-clear-selection\"\n              >\n                Clear Selection\n              </Button>\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\" disabled data-testid=\"button-bulk-export\">\n                Export Selected\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" disabled data-testid=\"button-bulk-archive\">\n                Archive Selected\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"p-6\">\n        {/* Stats Overview */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Building className=\"w-8 h-8 text-blueprint-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Total Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{projects.length}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Activity className=\"w-8 h-8 text-green-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Active Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => p.status === 'active').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <CheckCircle2 className=\"w-8 h-8 text-blue-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Completed</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => p.status === 'completed').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <TrendingUp className=\"w-8 h-8 text-purple-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Healthy Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => getProjectHealth(p).status === 'excellent' || getProjectHealth(p).status === 'good').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Bulk Selection Controls */}\n        {filteredProjects.length > 0 && (\n          <div className=\"flex items-center gap-4 mb-4\">\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={isAllSelected}\n                onCheckedChange={isAllSelected ? clearSelection : selectAllVisible}\n                data-testid=\"checkbox-select-all\"\n              />\n              <span className=\"text-sm text-slate-600\">\n                Select all visible ({filteredProjects.length})\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* Projects Grid */}\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardContent className=\"p-6\">\n                  <div className=\"h-4 bg-slate-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-3 bg-slate-200 rounded w-1/2\"></div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <Building className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-slate-900 mb-2\">No projects found</h3>\n            <p className=\"text-slate-600 mb-4\">\n              {searchTerm || statusFilter !== \"all\" ? \n                \"No projects match your current filters.\" :\n                \"Get started by creating your first project.\"\n              }\n            </p>\n            {(!searchTerm && statusFilter === \"all\") && (\n              <Button\n                onClick={() => setIsCreateDialogOpen(true)}\n                className=\"bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-create-first-project\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Create Your First Project\n              </Button>\n            )}\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project) => {\n              const health = getProjectHealth(project);\n              const HealthIcon = health.icon;\n              \n              return (\n                <Card \n                  key={project.id} \n                  className=\"cursor-pointer hover:shadow-lg transition-shadow border border-slate-200\"\n                  onClick={(e) => {\n                    // Only navigate if not clicking on interactive elements\n                    if (!(e.target as Element).closest('[data-interactive]')) {\n                      setLocation(`/projects/${project.id}`);\n                    }\n                  }}\n                  data-testid={`card-project-${project.id}`}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Checkbox\n                          checked={selectedProjects.has(project.id)}\n                          onCheckedChange={() => toggleProjectSelection(project.id)}\n                          onClick={(e) => e.stopPropagation()}\n                          data-interactive=\"true\"\n                          data-testid={`checkbox-project-${project.id}`}\n                        />\n                        <div>\n                          <CardTitle className=\"text-lg font-semibold text-slate-900 line-clamp-1\">\n                            {project.name}\n                          </CardTitle>\n                          <div className=\"flex items-center gap-2 mt-1\">\n                            <div className={`w-2 h-2 rounded-full ${health.color}`}></div>\n                            <HealthIcon className=\"w-4 h-4 text-slate-500\" />\n                            <span className=\"text-sm text-slate-500 capitalize\">{health.status}</span>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\"\n                            data-interactive=\"true\"\n                            data-testid={`button-menu-${project.id}`}\n                          >\n                            <MoreVertical className=\"w-4 h-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem \n                            onClick={() => setLocation(`/projects/${project.id}`)}\n                            data-testid={`menu-view-${project.id}`}\n                          >\n                            <FileImage className=\"w-4 h-4 mr-2\" />\n                            View Details\n                          </DropdownMenuItem>\n                          <DropdownMenuItem \n                            onClick={() => handleEditProject(project)}\n                            data-testid={`menu-edit-${project.id}`}\n                          >\n                            <Edit className=\"w-4 h-4 mr-2\" />\n                            Edit Project\n                          </DropdownMenuItem>\n                          <DropdownMenuSeparator />\n                          <DropdownMenuItem \n                            onClick={() => handleDeleteProject(project)}\n                            className=\"text-red-600\"\n                            data-testid={`menu-delete-${project.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 mr-2\" />\n                            Delete Project\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                  </CardHeader>\n                  \n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-3\">\n                      {project.client && (\n                        <div className=\"flex items-center text-sm text-slate-600\">\n                          <Building className=\"w-4 h-4 mr-2\" />\n                          {project.client}\n                        </div>\n                      )}\n                      \n                      {project.location && (\n                        <div className=\"flex items-center text-sm text-slate-600\">\n                          <MapPin className=\"w-4 h-4 mr-2\" />\n                          {project.location}\n                        </div>\n                      )}\n                      \n                      <div className=\"flex items-center text-sm text-slate-600\">\n                        <Calendar className=\"w-4 h-4 mr-2\" />\n                        {project.createdAt ? new Date(project.createdAt).toLocaleDateString() : 'No date'}\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <Badge \n                          variant={project.status === \"active\" ? \"default\" : \n                                 project.status === \"completed\" ? \"secondary\" : \"outline\"}\n                          className=\"capitalize\"\n                        >\n                          {project.status}\n                        </Badge>\n                        \n                        <div className=\"flex items-center text-sm text-slate-500\">\n                          <Activity className=\"w-4 h-4 mr-1\" />\n                          Active\n                        </div>\n                      </div>\n                      \n                      {project.description && (\n                        <p className=\"text-sm text-slate-600 line-clamp-2 mt-2\">\n                          {project.description}\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Create Project Dialog */}\n      <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Create New Project</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"project-name\">Project Name</Label>\n              <Input\n                id=\"project-name\"\n                value={newProject.name}\n                onChange={(e) => setNewProject({ ...newProject, name: e.target.value })}\n                placeholder=\"Enter project name\"\n                data-testid=\"input-new-project-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-location\">Location</Label>\n              <Input\n                id=\"project-location\"\n                value={newProject.location || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, location: e.target.value })}\n                placeholder=\"Enter project location\"\n                data-testid=\"input-new-project-location\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-client\">Client</Label>\n              <Input\n                id=\"project-client\"\n                value={newProject.client || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, client: e.target.value })}\n                placeholder=\"Enter client name\"\n                data-testid=\"input-new-project-client\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-description\">Description</Label>\n              <Input\n                id=\"project-description\"\n                value={newProject.description || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, description: e.target.value })}\n                placeholder=\"Enter project description\"\n                data-testid=\"input-new-project-description\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-status\">Status</Label>\n              <Select value={newProject.status} onValueChange={(value) => setNewProject({ ...newProject, status: value })}>\n                <SelectTrigger data-testid=\"select-new-project-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"active\">Active</SelectItem>\n                  <SelectItem value=\"on-hold\">On Hold</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"flex space-x-2 pt-4\">\n              <Button\n                onClick={handleCreateProject}\n                disabled={createProjectMutation.isPending}\n                className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-confirm-create-project\"\n              >\n                {createProjectMutation.isPending ? \"Creating...\" : \"Create Project\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsCreateDialogOpen(false)}\n                data-testid=\"button-cancel-create-project\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Project Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Project</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"edit-project-name\">Project Name</Label>\n              <Input\n                id=\"edit-project-name\"\n                value={editProject.name}\n                onChange={(e) => setEditProject({ ...editProject, name: e.target.value })}\n                placeholder=\"Enter project name\"\n                data-testid=\"input-edit-project-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-location\">Location</Label>\n              <Input\n                id=\"edit-project-location\"\n                value={editProject.location || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, location: e.target.value })}\n                placeholder=\"Enter project location\"\n                data-testid=\"input-edit-project-location\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-client\">Client</Label>\n              <Input\n                id=\"edit-project-client\"\n                value={editProject.client || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, client: e.target.value })}\n                placeholder=\"Enter client name\"\n                data-testid=\"input-edit-project-client\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-description\">Description</Label>\n              <Input\n                id=\"edit-project-description\"\n                value={editProject.description || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, description: e.target.value })}\n                placeholder=\"Enter project description\"\n                data-testid=\"input-edit-project-description\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-status\">Status</Label>\n              <Select value={editProject.status} onValueChange={(value) => setEditProject({ ...editProject, status: value })}>\n                <SelectTrigger data-testid=\"select-edit-project-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"active\">Active</SelectItem>\n                  <SelectItem value=\"on-hold\">On Hold</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"flex space-x-2 pt-4\">\n              <Button\n                onClick={handleUpdateProject}\n                disabled={updateProjectMutation.isPending}\n                className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-confirm-update-project\"\n              >\n                {updateProjectMutation.isPending ? \"Updating...\" : \"Update Project\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditDialogOpen(false)}\n                data-testid=\"button-cancel-update-project\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{selectedProject?.name}\"? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete-project\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={confirmDeleteProject}\n              disabled={deleteProjectMutation.isPending}\n              className=\"bg-red-600 hover:bg-red-700\"\n              data-testid=\"button-confirm-delete-project\"\n            >\n              {deleteProjectMutation.isPending ? \"Deleting...\" : \"Delete Project\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </Layout>\n  );\n}\n                            onClick={(e) => e.stopPropagation()}\n                          >\n                            <MoreVertical className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\" className=\"w-40\">\n                          <DropdownMenuItem onClick={(e) => {\n                            e.stopPropagation();\n                            handleEditProject(project);\n                          }}>\n                            <Edit className=\"mr-2 h-4 w-4\" />\n                            Edit\n                          </DropdownMenuItem>\n                          <DropdownMenuSeparator />\n                          <DropdownMenuItem \n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleDeleteProject(project);\n                            }}\n                            className=\"text-red-600 focus:text-red-600\"\n                          >\n                            <Trash2 className=\"mr-2 h-4 w-4\" />\n                            Delete\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {project.location && (\n                    <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n                      <MapPin className=\"w-4 h-4\" />\n                      <span>{project.location}</span>\n                    </div>\n                  )}\n                  \n                  {project.client && (\n                    <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n                      <Building className=\"w-4 h-4\" />\n                      <span>{project.client}</span>\n                    </div>\n                  )}\n                  \n                  <div className=\"flex items-center space-x-2 text-sm text-slate-600\">\n                    <Calendar className=\"w-4 h-4\" />\n                    <span>Created {project.createdAt ? new Date(project.createdAt).toLocaleDateString() : 'Unknown'}</span>\n                  </div>\n\n                  <div className=\"grid grid-cols-3 gap-4 pt-4 border-t border-slate-200\">\n                    <div className=\"text-center\">\n                      <div className=\"flex items-center justify-center mb-1\">\n                        <FileImage className=\"w-4 h-4 text-slate-400\" />\n                      </div>\n                      <div className=\"text-sm font-medium text-slate-900\">3</div>\n                      <div className=\"text-xs text-slate-500\">Drawings</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"flex items-center justify-center mb-1\">\n                        <Activity className=\"w-4 h-4 text-slate-400\" />\n                      </div>\n                      <div className=\"text-sm font-medium text-slate-900\">85%</div>\n                      <div className=\"text-xs text-slate-500\">Processed</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"flex items-center justify-center mb-1\">\n                        <Building className=\"w-4 h-4 text-slate-400\" />\n                      </div>\n                      <div className=\"text-sm font-medium text-slate-900\">$247K</div>\n                      <div className=\"text-xs text-slate-500\">Estimated</div>\n                    </div>\n                  </div>\n\n\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n\n        {!isLoading && projects.length === 0 && (\n          <div className=\"text-center py-12\">\n            <Building className=\"w-16 h-16 text-slate-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-slate-900 mb-2\">No Projects Yet</h3>\n            <p className=\"text-slate-600 mb-6\">Create your first construction project to get started with AI takeoffs.</p>\n            <Button \n              onClick={() => setIsCreateDialogOpen(true)}\n              className=\"bg-blueprint-600 hover:bg-blueprint-700\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Create First Project\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* Edit Project Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Project</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"edit-project-name\">Project Name</Label>\n              <Input\n                id=\"edit-project-name\"\n                value={editProject.name}\n                onChange={(e) => setEditProject({ ...editProject, name: e.target.value })}\n                placeholder=\"Enter project name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-location\">Location</Label>\n              <Input\n                id=\"edit-project-location\"\n                value={editProject.location || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, location: e.target.value })}\n                placeholder=\"Enter project location\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-client\">Client</Label>\n              <Input\n                id=\"edit-project-client\"\n                value={editProject.client || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, client: e.target.value })}\n                placeholder=\"Enter client name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-description\">Description</Label>\n              <Input\n                id=\"edit-project-description\"\n                value={editProject.description || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, description: e.target.value })}\n                placeholder=\"Enter project description\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-status\">Status</Label>\n              <select\n                id=\"edit-project-status\"\n                value={editProject.status}\n                onChange={(e) => setEditProject({ ...editProject, status: e.target.value })}\n                className=\"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm\"\n              >\n                <option value=\"active\">Active</option>\n                <option value=\"on-hold\">On Hold</option>\n                <option value=\"completed\">Completed</option>\n              </select>\n            </div>\n            <div className=\"flex space-x-2 pt-4\">\n              <Button\n                onClick={handleUpdateProject}\n                disabled={updateProjectMutation.isPending}\n                className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n              >\n                {updateProjectMutation.isPending ? \"Updating...\" : \"Update Project\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditDialogOpen(false)}\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{selectedProject?.name}\"? \n              This action cannot be undone and will permanently delete all project data, \n              drawings, and takeoffs.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={confirmDeleteProject}\n              className=\"bg-red-600 hover:bg-red-700 text-white\"\n              disabled={deleteProjectMutation.isPending}\n            >\n              {deleteProjectMutation.isPending ? \"Deleting...\" : \"Delete Project\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </Layout>\n  );\n}","size_bytes":39403},"client/src/pages/projects.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport Layout from \"@/components/layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { \n  Plus, \n  Building, \n  Calendar,\n  MapPin,\n  FileImage,\n  Activity,\n  Edit,\n  Trash2,\n  MoreVertical,\n  Search,\n  Filter,\n  SortAsc,\n  CheckSquare,\n  Square,\n  TrendingUp,\n  AlertTriangle,\n  CheckCircle2,\n  Clock\n} from \"lucide-react\";\nimport type { Project, InsertProject } from \"@shared/schema\";\n\nexport default function Projects() {\n  const [, setLocation] = useLocation();\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [selectedProject, setSelectedProject] = useState<Project | null>(null);\n  const [selectedProjects, setSelectedProjects] = useState<Set<string>>(new Set());\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [sortBy, setSortBy] = useState<string>(\"name\");\n  const [newProject, setNewProject] = useState<InsertProject>({\n    name: \"\",\n    description: \"\",\n    location: \"\",\n    client: \"\",\n    status: \"active\",\n  });\n  const [editProject, setEditProject] = useState<InsertProject>({\n    name: \"\",\n    description: \"\",\n    location: \"\",\n    client: \"\",\n    status: \"active\",\n  });\n  \n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: projects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects\"],\n  });\n\n  // Project health status based on AI analysis (simulated)\n  const getProjectHealth = (project: Project) => {\n    const createdDate = project.createdAt ? new Date(project.createdAt) : new Date();\n    const daysSinceCreated = Math.floor((Date.now() - createdDate.getTime()) / (1000 * 60 * 60 * 24));\n    if (daysSinceCreated < 7) return { status: 'excellent', color: 'bg-green-500', icon: CheckCircle2 };\n    if (daysSinceCreated < 30) return { status: 'good', color: 'bg-blue-500', icon: TrendingUp };\n    if (daysSinceCreated < 90) return { status: 'warning', color: 'bg-yellow-500', icon: Clock };\n    return { status: 'critical', color: 'bg-red-500', icon: AlertTriangle };\n  };\n\n  // Filtered and sorted projects\n  const filteredProjects = useMemo(() => {\n    let filtered = projects.filter(project => {\n      const matchesSearch = project.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           project.client?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           project.location?.toLowerCase().includes(searchTerm.toLowerCase());\n      const matchesStatus = statusFilter === \"all\" || project.status === statusFilter;\n      return matchesSearch && matchesStatus;\n    });\n\n    // Sort projects\n    filtered.sort((a, b) => {\n      switch (sortBy) {\n        case \"name\":\n          return a.name.localeCompare(b.name);\n        case \"client\":\n          return (a.client || \"\").localeCompare(b.client || \"\");\n        case \"created\":\n          const dateA = a.createdAt ? new Date(a.createdAt) : new Date(0);\n          const dateB = b.createdAt ? new Date(b.createdAt) : new Date(0);\n          return dateB.getTime() - dateA.getTime();\n        case \"status\":\n          return a.status.localeCompare(b.status);\n        default:\n          return 0;\n      }\n    });\n\n    return filtered;\n  }, [projects, searchTerm, statusFilter, sortBy]);\n\n  // Bulk selection handlers\n  const toggleProjectSelection = (projectId: string) => {\n    const newSelected = new Set(selectedProjects);\n    if (newSelected.has(projectId)) {\n      newSelected.delete(projectId);\n    } else {\n      newSelected.add(projectId);\n    }\n    setSelectedProjects(newSelected);\n  };\n\n  const selectAllVisible = () => {\n    setSelectedProjects(new Set(filteredProjects.map(p => p.id)));\n  };\n\n  const clearSelection = () => {\n    setSelectedProjects(new Set());\n  };\n\n  const isAllSelected = filteredProjects.length > 0 && filteredProjects.every(p => selectedProjects.has(p.id));\n\n  const createProjectMutation = useMutation({\n    mutationFn: (data: InsertProject) => apiRequest(\"/api/projects\", \"POST\", data),\n    onSuccess: () => {\n      toast({\n        title: \"Project created\",\n        description: \"Project has been created successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsCreateDialogOpen(false);\n      setNewProject({\n        name: \"\",\n        description: \"\",\n        location: \"\",\n        client: \"\",\n        status: \"active\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to create project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateProjectMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: InsertProject }) =>\n      apiRequest(`/api/projects/${id}`, \"PATCH\", data),\n    onSuccess: () => {\n      toast({\n        title: \"Project updated\",\n        description: \"Project has been updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsEditDialogOpen(false);\n      setSelectedProject(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to update project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteProjectMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(`/api/projects/${id}`, \"DELETE\"),\n    onSuccess: () => {\n      toast({\n        title: \"Project deleted\",\n        description: \"Project has been deleted successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDeleteDialogOpen(false);\n      setSelectedProject(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Failed to delete project\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateProject = () => {\n    if (!newProject.name.trim()) {\n      toast({\n        title: \"Project name required\",\n        description: \"Please enter a project name.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    createProjectMutation.mutate(newProject);\n  };\n\n  const handleEditProject = (project: Project) => {\n    setSelectedProject(project);\n    setEditProject({\n      name: project.name,\n      description: project.description || \"\",\n      location: project.location || \"\", \n      client: project.client || \"\",\n      status: project.status,\n    });\n    setIsEditDialogOpen(true);\n  };\n\n  const handleUpdateProject = () => {\n    if (!editProject.name.trim()) {\n      toast({\n        title: \"Project name required\",\n        description: \"Please enter a project name.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (selectedProject) {\n      updateProjectMutation.mutate({ id: selectedProject.id, data: editProject });\n    }\n  };\n\n  const handleDeleteProject = (project: Project) => {\n    setSelectedProject(project);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const confirmDeleteProject = () => {\n    if (selectedProject) {\n      deleteProjectMutation.mutate(selectedProject.id);\n    }\n  };\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">Projects</h1>\n            <p className=\"text-slate-600 mt-1\">Manage your construction projects and takeoffs</p>\n          </div>\n          \n          <div className=\"flex space-x-3\">\n            <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n              <DialogTrigger asChild>\n                <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" data-testid=\"button-create-project\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create Project\n                </Button>\n              </DialogTrigger>\n            </Dialog>\n          </div>\n        </div>\n\n        {/* Search and Filter Controls */}\n        <div className=\"mt-6 flex flex-col lg:flex-row gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4\" />\n              <Input\n                placeholder=\"Search projects by name, client, or location...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search-projects\"\n              />\n            </div>\n          </div>\n          \n          <div className=\"flex gap-3\">\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-32\" data-testid=\"select-status-filter\">\n                <Filter className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"active\">Active</SelectItem>\n                <SelectItem value=\"completed\">Completed</SelectItem>\n                <SelectItem value=\"on-hold\">On Hold</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={sortBy} onValueChange={setSortBy}>\n              <SelectTrigger className=\"w-32\" data-testid=\"select-sort-by\">\n                <SortAsc className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Sort\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"name\">Name</SelectItem>\n                <SelectItem value=\"client\">Client</SelectItem>\n                <SelectItem value=\"created\">Date Created</SelectItem>\n                <SelectItem value=\"status\">Status</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n\n        {/* Bulk Actions Bar */}\n        {selectedProjects.size > 0 && (\n          <div className=\"mt-4 bg-slate-50 border border-slate-200 rounded-lg p-4 flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <span className=\"text-sm font-medium text-slate-700\">\n                {selectedProjects.size} project{selectedProjects.size !== 1 ? 's' : ''} selected\n              </span>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={clearSelection}\n                data-testid=\"button-clear-selection\"\n              >\n                Clear Selection\n              </Button>\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\" disabled data-testid=\"button-bulk-export\">\n                Export Selected\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" disabled data-testid=\"button-bulk-archive\">\n                Archive Selected\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"p-6\">\n        {/* Stats Overview */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Building className=\"w-8 h-8 text-blueprint-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Total Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{projects.length}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Activity className=\"w-8 h-8 text-green-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Active Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => p.status === 'active').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <CheckCircle2 className=\"w-8 h-8 text-blue-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Completed</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => p.status === 'completed').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <TrendingUp className=\"w-8 h-8 text-purple-600\" />\n                <div className=\"ml-3\">\n                  <p className=\"text-sm font-medium text-slate-600\">Healthy Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    {projects.filter(p => getProjectHealth(p).status === 'excellent' || getProjectHealth(p).status === 'good').length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Bulk Selection Controls */}\n        {filteredProjects.length > 0 && (\n          <div className=\"flex items-center gap-4 mb-4\">\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                checked={isAllSelected}\n                onCheckedChange={isAllSelected ? clearSelection : selectAllVisible}\n                data-testid=\"checkbox-select-all\"\n              />\n              <span className=\"text-sm text-slate-600\">\n                Select all visible ({filteredProjects.length})\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* Projects Grid */}\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardContent className=\"p-6\">\n                  <div className=\"h-4 bg-slate-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-3 bg-slate-200 rounded w-1/2\"></div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <Building className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-slate-900 mb-2\">No projects found</h3>\n            <p className=\"text-slate-600 mb-4\">\n              {searchTerm || statusFilter !== \"all\" ? \n                \"No projects match your current filters.\" :\n                \"Get started by creating your first project.\"\n              }\n            </p>\n            {(!searchTerm && statusFilter === \"all\") && (\n              <Button\n                onClick={() => setIsCreateDialogOpen(true)}\n                className=\"bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-create-first-project\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Create Your First Project\n              </Button>\n            )}\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project) => {\n              const health = getProjectHealth(project);\n              const HealthIcon = health.icon;\n              \n              return (\n                <Card \n                  key={project.id} \n                  className=\"cursor-pointer hover:shadow-lg transition-shadow border border-slate-200\"\n                  onClick={(e) => {\n                    // Only navigate if not clicking on interactive elements\n                    if (!(e.target as Element).closest('[data-interactive]')) {\n                      setLocation(`/projects/${project.id}`);\n                    }\n                  }}\n                  data-testid={`card-project-${project.id}`}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Checkbox\n                          checked={selectedProjects.has(project.id)}\n                          onCheckedChange={() => toggleProjectSelection(project.id)}\n                          onClick={(e) => e.stopPropagation()}\n                          data-interactive=\"true\"\n                          data-testid={`checkbox-project-${project.id}`}\n                        />\n                        <div>\n                          <CardTitle className=\"text-lg font-semibold text-slate-900 line-clamp-1\">\n                            {project.name}\n                          </CardTitle>\n                          <div className=\"flex items-center gap-2 mt-1\">\n                            <div className={`w-2 h-2 rounded-full ${health.color}`}></div>\n                            <HealthIcon className=\"w-4 h-4 text-slate-500\" />\n                            <span className=\"text-sm text-slate-500 capitalize\">{health.status}</span>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\"\n                            data-interactive=\"true\"\n                            data-testid={`button-menu-${project.id}`}\n                          >\n                            <MoreVertical className=\"w-4 h-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem \n                            onClick={() => setLocation(`/projects/${project.id}`)}\n                            data-testid={`menu-view-${project.id}`}\n                          >\n                            <FileImage className=\"w-4 h-4 mr-2\" />\n                            View Details\n                          </DropdownMenuItem>\n                          <DropdownMenuItem \n                            onClick={() => handleEditProject(project)}\n                            data-testid={`menu-edit-${project.id}`}\n                          >\n                            <Edit className=\"w-4 h-4 mr-2\" />\n                            Edit Project\n                          </DropdownMenuItem>\n                          <DropdownMenuSeparator />\n                          <DropdownMenuItem \n                            onClick={() => handleDeleteProject(project)}\n                            className=\"text-red-600\"\n                            data-testid={`menu-delete-${project.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 mr-2\" />\n                            Delete Project\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                  </CardHeader>\n                  \n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-3\">\n                      {project.client && (\n                        <div className=\"flex items-center text-sm text-slate-600\">\n                          <Building className=\"w-4 h-4 mr-2\" />\n                          {project.client}\n                        </div>\n                      )}\n                      \n                      {project.location && (\n                        <div className=\"flex items-center text-sm text-slate-600\">\n                          <MapPin className=\"w-4 h-4 mr-2\" />\n                          {project.location}\n                        </div>\n                      )}\n                      \n                      <div className=\"flex items-center text-sm text-slate-600\">\n                        <Calendar className=\"w-4 h-4 mr-2\" />\n                        {project.createdAt ? new Date(project.createdAt).toLocaleDateString() : 'No date'}\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <Badge \n                          variant={project.status === \"active\" ? \"default\" : \n                                 project.status === \"completed\" ? \"secondary\" : \"outline\"}\n                          className=\"capitalize\"\n                        >\n                          {project.status}\n                        </Badge>\n                        \n                        <div className=\"flex items-center text-sm text-slate-500\">\n                          <Activity className=\"w-4 h-4 mr-1\" />\n                          Active\n                        </div>\n                      </div>\n                      \n                      {project.description && (\n                        <p className=\"text-sm text-slate-600 line-clamp-2 mt-2\">\n                          {project.description}\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Create Project Dialog */}\n      <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Create New Project</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"project-name\">Project Name</Label>\n              <Input\n                id=\"project-name\"\n                value={newProject.name}\n                onChange={(e) => setNewProject({ ...newProject, name: e.target.value })}\n                placeholder=\"Enter project name\"\n                data-testid=\"input-new-project-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-location\">Location</Label>\n              <Input\n                id=\"project-location\"\n                value={newProject.location || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, location: e.target.value })}\n                placeholder=\"Enter project location\"\n                data-testid=\"input-new-project-location\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-client\">Client</Label>\n              <Input\n                id=\"project-client\"\n                value={newProject.client || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, client: e.target.value })}\n                placeholder=\"Enter client name\"\n                data-testid=\"input-new-project-client\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-description\">Description</Label>\n              <Input\n                id=\"project-description\"\n                value={newProject.description || \"\"}\n                onChange={(e) => setNewProject({ ...newProject, description: e.target.value })}\n                placeholder=\"Enter project description\"\n                data-testid=\"input-new-project-description\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"project-status\">Status</Label>\n              <Select value={newProject.status} onValueChange={(value) => setNewProject({ ...newProject, status: value })}>\n                <SelectTrigger data-testid=\"select-new-project-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"active\">Active</SelectItem>\n                  <SelectItem value=\"on-hold\">On Hold</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"flex space-x-2 pt-4\">\n              <Button\n                onClick={handleCreateProject}\n                disabled={createProjectMutation.isPending}\n                className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-confirm-create-project\"\n              >\n                {createProjectMutation.isPending ? \"Creating...\" : \"Create Project\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsCreateDialogOpen(false)}\n                data-testid=\"button-cancel-create-project\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Project Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Project</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"edit-project-name\">Project Name</Label>\n              <Input\n                id=\"edit-project-name\"\n                value={editProject.name}\n                onChange={(e) => setEditProject({ ...editProject, name: e.target.value })}\n                placeholder=\"Enter project name\"\n                data-testid=\"input-edit-project-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-location\">Location</Label>\n              <Input\n                id=\"edit-project-location\"\n                value={editProject.location || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, location: e.target.value })}\n                placeholder=\"Enter project location\"\n                data-testid=\"input-edit-project-location\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-client\">Client</Label>\n              <Input\n                id=\"edit-project-client\"\n                value={editProject.client || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, client: e.target.value })}\n                placeholder=\"Enter client name\"\n                data-testid=\"input-edit-project-client\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-description\">Description</Label>\n              <Input\n                id=\"edit-project-description\"\n                value={editProject.description || \"\"}\n                onChange={(e) => setEditProject({ ...editProject, description: e.target.value })}\n                placeholder=\"Enter project description\"\n                data-testid=\"input-edit-project-description\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"edit-project-status\">Status</Label>\n              <Select value={editProject.status} onValueChange={(value) => setEditProject({ ...editProject, status: value })}>\n                <SelectTrigger data-testid=\"select-edit-project-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"active\">Active</SelectItem>\n                  <SelectItem value=\"on-hold\">On Hold</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"flex space-x-2 pt-4\">\n              <Button\n                onClick={handleUpdateProject}\n                disabled={updateProjectMutation.isPending}\n                className=\"flex-1 bg-blueprint-600 hover:bg-blueprint-700\"\n                data-testid=\"button-confirm-update-project\"\n              >\n                {updateProjectMutation.isPending ? \"Updating...\" : \"Update Project\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditDialogOpen(false)}\n                data-testid=\"button-cancel-update-project\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{selectedProject?.name}\"? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete-project\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={confirmDeleteProject}\n              disabled={deleteProjectMutation.isPending}\n              className=\"bg-red-600 hover:bg-red-700\"\n              data-testid=\"button-confirm-delete-project\"\n            >\n              {deleteProjectMutation.isPending ? \"Deleting...\" : \"Delete Project\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </Layout>\n  );\n}","size_bytes":30851},"client/src/pages/reports-backup.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport Layout from \"@/components/layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { \n  BarChart3, \n  Download, \n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  Building,\n  Calendar,\n  FileText,\n  PieChart,\n  AlertTriangle,\n  CheckCircle2,\n  Target,\n  Shield,\n  Activity,\n  Filter\n} from \"lucide-react\";\nimport type { Project } from \"@shared/schema\";\n\nexport default function Reports() {\n  const [selectedTimeRange, setSelectedTimeRange] = useState(\"30\");\n  const [selectedProject, setSelectedProject] = useState<string>(\"all\");\n\n  const { data: projects = [] } = useQuery({\n    queryKey: [\"/api/projects\"],\n  });\n\n  // Get cost analysis for each project using our AI backend\n  const projectAnalyses = useQuery({\n    queryKey: [\"/api/project-analyses\", projects.map(p => p.id)],\n    queryFn: async () => {\n      const analyses = await Promise.all(\n        projects.map(async (project) => {\n          try {\n            const [costAnalysis, riskAssessment, costTrends] = await Promise.all([\n              fetch(`/api/projects/${project.id}/cost-analysis`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/risk-assessment`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/cost-trends?months=6`).then(r => r.json())\n            ]);\n            return {\n              project,\n              costAnalysis,\n              riskAssessment,\n              costTrends\n            };\n          } catch (error) {\n            console.error(`Failed to get analysis for project ${project.id}:`, error);\n            return null;\n          }\n        })\n      );\n      return analyses.filter(Boolean);\n    },\n    enabled: projects.length > 0,\n  });\n\n  const analysisData = projectAnalyses.data || [];\n\n  // Calculate aggregate metrics from AI analysis\n  const aggregateMetrics = {\n    totalProjects: projects.length,\n    totalCost: analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.totalCost || 0), 0),\n    avgEfficiencyScore: analysisData.length > 0 ? \n      analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.overallScore || 0), 0) / analysisData.length : 0,\n    highRiskProjects: analysisData.filter(item => \n      item?.riskAssessment?.riskLevel === 'high' || item?.riskAssessment?.riskLevel === 'critical'\n    ).length,\n    costSavingsOpportunities: analysisData.reduce((sum, item) => {\n      const savings = item?.costAnalysis?.insights?.filter(insight => \n        insight.includes('savings') || insight.includes('bulk purchasing')\n      ).length || 0;\n      return sum + savings;\n    }, 0)\n  };\n\n  // Category breakdown from cost analysis\n  const categoryBreakdown = analysisData.reduce((acc, item) => {\n    if (item?.costAnalysis?.costByCategory) {\n      item.costAnalysis.costByCategory.forEach(category => {\n        const existing = acc.find(c => c.category === category.category);\n        if (existing) {\n          existing.total += category.total;\n          existing.percentage = ((existing.total / aggregateMetrics.totalCost) * 100);\n        } else {\n          acc.push({\n            category: category.category,\n            total: category.total,\n            percentage: (category.total / aggregateMetrics.totalCost) * 100\n          });\n        }\n      });\n    }\n    return acc;\n  }, [] as Array<{category: string, total: number, percentage: number}>);\n\n  // Efficiency distribution\n  const efficiencyDistribution = {\n    excellent: analysisData.filter(item => item?.costAnalysis?.efficiency === 'excellent').length,\n    good: analysisData.filter(item => item?.costAnalysis?.efficiency === 'good').length,\n    average: analysisData.filter(item => item?.costAnalysis?.efficiency === 'average').length,\n    poor: analysisData.filter(item => item?.costAnalysis?.efficiency === 'poor').length,\n  };\n\n  // Risk level distribution\n  const riskDistribution = {\n    low: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'low').length,\n    medium: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'medium').length,\n    high: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'high').length,\n    critical: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'critical').length,\n  };\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">AI-Powered Reports & Analytics</h1>\n            <p className=\"text-slate-600 mt-1\">Intelligence-driven cost analysis and project insights</p>\n          </div>\n          \n          <div className=\"flex space-x-3\">\n            <Select value={selectedTimeRange} onValueChange={setSelectedTimeRange}>\n              <SelectTrigger className=\"w-40\" data-testid=\"select-time-range\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Time Range\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"7\">Last 7 Days</SelectItem>\n                <SelectItem value=\"30\">Last 30 Days</SelectItem>\n                <SelectItem value=\"90\">Last 90 Days</SelectItem>\n                <SelectItem value=\"365\">Last Year</SelectItem>\n              </SelectContent>\n            </Select>\n            \n            <Select value={selectedProject} onValueChange={setSelectedProject}>\n              <SelectTrigger className=\"w-48\" data-testid=\"select-project-filter\">\n                <Filter className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"All Projects\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Projects</SelectItem>\n                {projects.map(project => (\n                  <SelectItem key={project.id} value={project.id}>\n                    {project.name}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            \n            <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" data-testid=\"button-export-reports\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export Analytics\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6 space-y-6\">\n        {projectAnalyses.isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardContent className=\"p-6\">\n                  <div className=\"h-4 bg-slate-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-8 bg-slate-200 rounded w-1/2\"></div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <>\n            {/* AI-Powered Key Metrics */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card data-testid=\"card-total-cost\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <DollarSign className=\"w-8 h-8 text-green-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Total Project Cost</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        ${aggregateMetrics.totalCost.toLocaleString()}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-efficiency-score\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <Target className=\"w-8 h-8 text-blue-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Avg Efficiency Score</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.avgEfficiencyScore.toFixed(1)}/100\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-high-risk\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">High Risk Projects</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.highRiskProjects}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-savings-opportunities\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <TrendingUp className=\"w-8 h-8 text-purple-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Cost Savings Opportunities</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.costSavingsOpportunities}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* AI Analysis Charts */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Total Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{reportData.totalProjects}</p>\n                </div>\n                <div className=\"w-8 h-8 bg-blueprint-100 rounded-lg flex items-center justify-center\">\n                  <Building className=\"w-4 h-4 text-blueprint-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+12% from last month</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Completed Takeoffs</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{reportData.completedTakeoffs}</p>\n                </div>\n                <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\">\n                  <BarChart3 className=\"w-4 h-4 text-green-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+8% accuracy improvement</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Total Estimated Value</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    ${reportData.totalEstimatedValue.toLocaleString()}\n                  </p>\n                </div>\n                <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center\">\n                  <DollarSign className=\"w-4 h-4 text-emerald-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+23% from last quarter</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Avg Project Value</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    ${Math.round(reportData.avgProjectValue).toLocaleString()}\n                  </p>\n                </div>\n                <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\">\n                  <PieChart className=\"w-4 h-4 text-purple-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+5% from last period</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Monthly Trend Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <BarChart3 className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Monthly Estimating Volume\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {reportData.monthlyTrend.map((item, index) => (\n                  <div key={index} className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium text-slate-600\">{item.month}</span>\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"w-24 bg-slate-200 rounded-full h-2\">\n                        <div \n                          className=\"bg-blueprint-600 h-2 rounded-full\" \n                          style={{ width: `${(item.value / 700000) * 100}%` }}\n                        ></div>\n                      </div>\n                      <span className=\"text-sm font-bold text-slate-900 w-16 text-right\">\n                        ${Math.round(item.value / 1000)}K\n                      </span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Category Breakdown */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <PieChart className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Project Categories\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {reportData.categoryBreakdown.map((category, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                    <div>\n                      <p className=\"font-medium text-slate-900\">{category.category}</p>\n                      <p className=\"text-sm text-slate-600\">{category.count} projects</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-lg font-bold text-slate-900\">\n                        ${category.value.toLocaleString()}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">\n                        {Math.round((category.value / reportData.totalEstimatedValue) * 100)}%\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Reports */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <FileText className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Recent Reports\n              </div>\n              <Button variant=\"outline\" size=\"sm\">\n                View All\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {reportData.recentReports.map((report) => (\n                <div key={report.id} className=\"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50\">\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"w-10 h-10 bg-blueprint-100 rounded-lg flex items-center justify-center\">\n                      <FileText className=\"w-5 h-5 text-blueprint-600\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-slate-900\">{report.name}</p>\n                      <div className=\"flex items-center space-x-3 mt-1\">\n                        <span className=\"text-sm text-slate-600\">{report.date}</span>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {report.type}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                      <p className=\"font-bold text-slate-900\">\n                        ${report.value.toLocaleString()}\n                      </p>\n                    </div>\n                    <Button variant=\"ghost\" size=\"sm\">\n                      <Download className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </Layout>\n  );\n}","size_bytes":18314},"client/src/pages/reports-broken.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport Layout from \"@/components/layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { \n  BarChart3, \n  Download, \n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  Building,\n  Calendar,\n  FileText,\n  PieChart,\n  AlertTriangle,\n  CheckCircle2,\n  Target,\n  Shield,\n  Activity,\n  Filter\n} from \"lucide-react\";\nimport type { Project } from \"@shared/schema\";\n\nexport default function Reports() {\n  const [selectedTimeRange, setSelectedTimeRange] = useState(\"30\");\n  const [selectedProject, setSelectedProject] = useState<string>(\"all\");\n\n  const { data: projects = [] } = useQuery({\n    queryKey: [\"/api/projects\"],\n  });\n\n  // Get cost analysis for each project using our AI backend\n  const projectAnalyses = useQuery({\n    queryKey: [\"/api/project-analyses\", projects.map(p => p.id)],\n    queryFn: async () => {\n      const analyses = await Promise.all(\n        projects.map(async (project) => {\n          try {\n            const [costAnalysis, riskAssessment, costTrends] = await Promise.all([\n              fetch(`/api/projects/${project.id}/cost-analysis`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/risk-assessment`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/cost-trends?months=6`).then(r => r.json())\n            ]);\n            return {\n              project,\n              costAnalysis,\n              riskAssessment,\n              costTrends\n            };\n          } catch (error) {\n            console.error(`Failed to get analysis for project ${project.id}:`, error);\n            return null;\n          }\n        })\n      );\n      return analyses.filter(Boolean);\n    },\n    enabled: projects.length > 0,\n  });\n\n  const analysisData = projectAnalyses.data || [];\n\n  // Calculate aggregate metrics from AI analysis\n  const aggregateMetrics = {\n    totalProjects: projects.length,\n    totalCost: analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.totalCost || 0), 0),\n    avgEfficiencyScore: analysisData.length > 0 ? \n      analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.overallScore || 0), 0) / analysisData.length : 0,\n    highRiskProjects: analysisData.filter(item => \n      item?.riskAssessment?.riskLevel === 'high' || item?.riskAssessment?.riskLevel === 'critical'\n    ).length,\n    costSavingsOpportunities: analysisData.reduce((sum, item) => {\n      const savings = item?.costAnalysis?.insights?.filter(insight => \n        insight.includes('savings') || insight.includes('bulk purchasing')\n      ).length || 0;\n      return sum + savings;\n    }, 0)\n  };\n\n  // Category breakdown from cost analysis\n  const categoryBreakdown = analysisData.reduce((acc, item) => {\n    if (item?.costAnalysis?.costByCategory) {\n      item.costAnalysis.costByCategory.forEach(category => {\n        const existing = acc.find(c => c.category === category.category);\n        if (existing) {\n          existing.total += category.total;\n          existing.percentage = ((existing.total / aggregateMetrics.totalCost) * 100);\n        } else {\n          acc.push({\n            category: category.category,\n            total: category.total,\n            percentage: (category.total / aggregateMetrics.totalCost) * 100\n          });\n        }\n      });\n    }\n    return acc;\n  }, [] as Array<{category: string, total: number, percentage: number}>);\n\n  // Efficiency distribution\n  const efficiencyDistribution = {\n    excellent: analysisData.filter(item => item?.costAnalysis?.efficiency === 'excellent').length,\n    good: analysisData.filter(item => item?.costAnalysis?.efficiency === 'good').length,\n    average: analysisData.filter(item => item?.costAnalysis?.efficiency === 'average').length,\n    poor: analysisData.filter(item => item?.costAnalysis?.efficiency === 'poor').length,\n  };\n\n  // Risk level distribution\n  const riskDistribution = {\n    low: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'low').length,\n    medium: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'medium').length,\n    high: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'high').length,\n    critical: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'critical').length,\n  };\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">AI-Powered Reports & Analytics</h1>\n            <p className=\"text-slate-600 mt-1\">Intelligence-driven cost analysis and project insights</p>\n          </div>\n          \n          <div className=\"flex space-x-3\">\n            <Select value={selectedTimeRange} onValueChange={setSelectedTimeRange}>\n              <SelectTrigger className=\"w-40\" data-testid=\"select-time-range\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Time Range\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"7\">Last 7 Days</SelectItem>\n                <SelectItem value=\"30\">Last 30 Days</SelectItem>\n                <SelectItem value=\"90\">Last 90 Days</SelectItem>\n                <SelectItem value=\"365\">Last Year</SelectItem>\n              </SelectContent>\n            </Select>\n            \n            <Select value={selectedProject} onValueChange={setSelectedProject}>\n              <SelectTrigger className=\"w-48\" data-testid=\"select-project-filter\">\n                <Filter className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"All Projects\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Projects</SelectItem>\n                {projects.map(project => (\n                  <SelectItem key={project.id} value={project.id}>\n                    {project.name}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            \n            <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" data-testid=\"button-export-reports\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export Analytics\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6 space-y-6\">\n        {projectAnalyses.isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardContent className=\"p-6\">\n                  <div className=\"h-4 bg-slate-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-8 bg-slate-200 rounded w-1/2\"></div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <>\n            {/* AI-Powered Key Metrics */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card data-testid=\"card-total-cost\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <DollarSign className=\"w-8 h-8 text-green-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Total Project Cost</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        ${aggregateMetrics.totalCost.toLocaleString()}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-efficiency-score\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <Target className=\"w-8 h-8 text-blue-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Avg Efficiency Score</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.avgEfficiencyScore.toFixed(1)}/100\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-high-risk\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">High Risk Projects</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.highRiskProjects}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-savings-opportunities\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <TrendingUp className=\"w-8 h-8 text-purple-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Cost Savings Opportunities</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.costSavingsOpportunities}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* AI Analysis Charts */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Total Projects</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{reportData.totalProjects}</p>\n                </div>\n                <div className=\"w-8 h-8 bg-blueprint-100 rounded-lg flex items-center justify-center\">\n                  <Building className=\"w-4 h-4 text-blueprint-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+12% from last month</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Completed Takeoffs</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">{reportData.completedTakeoffs}</p>\n                </div>\n                <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\">\n                  <BarChart3 className=\"w-4 h-4 text-green-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+8% accuracy improvement</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Total Estimated Value</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    ${reportData.totalEstimatedValue.toLocaleString()}\n                  </p>\n                </div>\n                <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center\">\n                  <DollarSign className=\"w-4 h-4 text-emerald-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+23% from last quarter</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-slate-600\">Avg Project Value</p>\n                  <p className=\"text-2xl font-bold text-slate-900\">\n                    ${Math.round(reportData.avgProjectValue).toLocaleString()}\n                  </p>\n                </div>\n                <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\">\n                  <PieChart className=\"w-4 h-4 text-purple-600\" />\n                </div>\n              </div>\n              <div className=\"flex items-center mt-4\">\n                <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\n                <span className=\"text-sm text-green-600\">+5% from last period</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Monthly Trend Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <BarChart3 className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Monthly Estimating Volume\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {reportData.monthlyTrend.map((item, index) => (\n                  <div key={index} className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium text-slate-600\">{item.month}</span>\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"w-24 bg-slate-200 rounded-full h-2\">\n                        <div \n                          className=\"bg-blueprint-600 h-2 rounded-full\" \n                          style={{ width: `${(item.value / 700000) * 100}%` }}\n                        ></div>\n                      </div>\n                      <span className=\"text-sm font-bold text-slate-900 w-16 text-right\">\n                        ${Math.round(item.value / 1000)}K\n                      </span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Category Breakdown */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <PieChart className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Project Categories\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {reportData.categoryBreakdown.map((category, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                    <div>\n                      <p className=\"font-medium text-slate-900\">{category.category}</p>\n                      <p className=\"text-sm text-slate-600\">{category.count} projects</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-lg font-bold text-slate-900\">\n                        ${category.value.toLocaleString()}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">\n                        {Math.round((category.value / reportData.totalEstimatedValue) * 100)}%\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Reports */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <FileText className=\"w-5 h-5 text-blueprint-600 mr-2\" />\n                Recent Reports\n              </div>\n              <Button variant=\"outline\" size=\"sm\">\n                View All\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {reportData.recentReports.map((report) => (\n                <div key={report.id} className=\"flex items-center justify-between p-4 border border-slate-200 rounded-lg hover:bg-slate-50\">\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"w-10 h-10 bg-blueprint-100 rounded-lg flex items-center justify-center\">\n                      <FileText className=\"w-5 h-5 text-blueprint-600\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-slate-900\">{report.name}</p>\n                      <div className=\"flex items-center space-x-3 mt-1\">\n                        <span className=\"text-sm text-slate-600\">{report.date}</span>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {report.type}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                      <p className=\"font-bold text-slate-900\">\n                        ${report.value.toLocaleString()}\n                      </p>\n                    </div>\n                    <Button variant=\"ghost\" size=\"sm\">\n                      <Download className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </Layout>\n  );\n}","size_bytes":18314},"client/src/pages/reports.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport Layout from \"@/components/layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { \n  BarChart3, \n  Download, \n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  Building,\n  Calendar,\n  FileText,\n  PieChart,\n  AlertTriangle,\n  CheckCircle2,\n  Target,\n  Shield,\n  Activity,\n  Filter\n} from \"lucide-react\";\nimport type { Project } from \"@shared/schema\";\n\nexport default function Reports() {\n  const [selectedTimeRange, setSelectedTimeRange] = useState(\"30\");\n  const [selectedProject, setSelectedProject] = useState<string>(\"all\");\n\n  const { data: projects = [] } = useQuery({\n    queryKey: [\"/api/projects\"],\n  });\n\n  // Get cost analysis for each project using our AI backend\n  const projectAnalyses = useQuery({\n    queryKey: [\"/api/project-analyses\", projects.map(p => p.id)],\n    queryFn: async () => {\n      const analyses = await Promise.all(\n        projects.map(async (project) => {\n          try {\n            const [costAnalysis, riskAssessment, costTrends] = await Promise.all([\n              fetch(`/api/projects/${project.id}/cost-analysis`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/risk-assessment`).then(r => r.json()),\n              fetch(`/api/projects/${project.id}/cost-trends?months=6`).then(r => r.json())\n            ]);\n            return {\n              project,\n              costAnalysis,\n              riskAssessment,\n              costTrends\n            };\n          } catch (error) {\n            console.error(`Failed to get analysis for project ${project.id}:`, error);\n            return null;\n          }\n        })\n      );\n      return analyses.filter(Boolean);\n    },\n    enabled: projects.length > 0,\n  });\n\n  const analysisData = projectAnalyses.data || [];\n\n  // Calculate aggregate metrics from AI analysis\n  const aggregateMetrics = {\n    totalProjects: projects.length,\n    totalCost: analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.totalCost || 0), 0),\n    avgEfficiencyScore: analysisData.length > 0 ? \n      analysisData.reduce((sum, item) => sum + (item?.costAnalysis?.overallScore || 0), 0) / analysisData.length : 0,\n    highRiskProjects: analysisData.filter(item => \n      item?.riskAssessment?.riskLevel === 'high' || item?.riskAssessment?.riskLevel === 'critical'\n    ).length,\n    costSavingsOpportunities: analysisData.reduce((sum, item) => {\n      const savings = item?.costAnalysis?.insights?.filter(insight => \n        insight.includes('savings') || insight.includes('bulk purchasing')\n      ).length || 0;\n      return sum + savings;\n    }, 0)\n  };\n\n  // Category breakdown from cost analysis\n  const categoryBreakdown = analysisData.reduce((acc, item) => {\n    if (item?.costAnalysis?.costByCategory) {\n      item.costAnalysis.costByCategory.forEach(category => {\n        const existing = acc.find(c => c.category === category.category);\n        if (existing) {\n          existing.total += category.total;\n          existing.percentage = ((existing.total / aggregateMetrics.totalCost) * 100);\n        } else {\n          acc.push({\n            category: category.category,\n            total: category.total,\n            percentage: (category.total / aggregateMetrics.totalCost) * 100\n          });\n        }\n      });\n    }\n    return acc;\n  }, [] as Array<{category: string, total: number, percentage: number}>);\n\n  // Efficiency distribution\n  const efficiencyDistribution = {\n    excellent: analysisData.filter(item => item?.costAnalysis?.efficiency === 'excellent').length,\n    good: analysisData.filter(item => item?.costAnalysis?.efficiency === 'good').length,\n    average: analysisData.filter(item => item?.costAnalysis?.efficiency === 'average').length,\n    poor: analysisData.filter(item => item?.costAnalysis?.efficiency === 'poor').length,\n  };\n\n  // Risk level distribution\n  const riskDistribution = {\n    low: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'low').length,\n    medium: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'medium').length,\n    high: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'high').length,\n    critical: analysisData.filter(item => item?.riskAssessment?.riskLevel === 'critical').length,\n  };\n\n  return (\n    <Layout>\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">AI-Powered Reports & Analytics</h1>\n            <p className=\"text-slate-600 mt-1\">Intelligence-driven cost analysis and project insights</p>\n          </div>\n          \n          <div className=\"flex space-x-3\">\n            <Select value={selectedTimeRange} onValueChange={setSelectedTimeRange}>\n              <SelectTrigger className=\"w-40\" data-testid=\"select-time-range\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"Time Range\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"7\">Last 7 Days</SelectItem>\n                <SelectItem value=\"30\">Last 30 Days</SelectItem>\n                <SelectItem value=\"90\">Last 90 Days</SelectItem>\n                <SelectItem value=\"365\">Last Year</SelectItem>\n              </SelectContent>\n            </Select>\n            \n            <Select value={selectedProject} onValueChange={setSelectedProject}>\n              <SelectTrigger className=\"w-48\" data-testid=\"select-project-filter\">\n                <Filter className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"All Projects\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Projects</SelectItem>\n                {projects.map(project => (\n                  <SelectItem key={project.id} value={project.id}>\n                    {project.name}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            \n            <Button className=\"bg-blueprint-600 hover:bg-blueprint-700\" data-testid=\"button-export-reports\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export Analytics\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6 space-y-6\">\n        {projectAnalyses.isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardContent className=\"p-6\">\n                  <div className=\"h-4 bg-slate-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-8 bg-slate-200 rounded w-1/2\"></div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <>\n            {/* AI-Powered Key Metrics */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card data-testid=\"card-total-cost\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <DollarSign className=\"w-8 h-8 text-green-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Total Project Cost</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        ${aggregateMetrics.totalCost.toLocaleString()}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-efficiency-score\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <Target className=\"w-8 h-8 text-blue-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Avg Efficiency Score</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.avgEfficiencyScore.toFixed(1)}/100\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-high-risk\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">High Risk Projects</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.highRiskProjects}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card data-testid=\"card-savings-opportunities\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <TrendingUp className=\"w-8 h-8 text-purple-600\" />\n                    <div className=\"ml-3\">\n                      <p className=\"text-sm font-medium text-slate-600\">Cost Savings Opportunities</p>\n                      <p className=\"text-2xl font-bold text-slate-900\">\n                        {aggregateMetrics.costSavingsOpportunities}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* AI Analysis Charts */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* Project Efficiency Distribution */}\n              <Card data-testid=\"card-efficiency-distribution\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <Target className=\"w-5 h-5 mr-2 text-blue-600\" />\n                    AI Efficiency Analysis\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {Object.entries(efficiencyDistribution).map(([level, count]) => {\n                      const percentage = projects.length > 0 ? (count / projects.length) * 100 : 0;\n                      const colors = {\n                        excellent: 'bg-green-500',\n                        good: 'bg-blue-500', \n                        average: 'bg-yellow-500',\n                        poor: 'bg-red-500'\n                      };\n                      \n                      return (\n                        <div key={level} className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center space-x-3\">\n                            <div className={`w-3 h-3 rounded-full ${colors[level as keyof typeof colors]}`} />\n                            <span className=\"text-sm font-medium text-slate-700 capitalize\">{level}</span>\n                          </div>\n                          <div className=\"flex items-center space-x-3\">\n                            <div className=\"w-20 h-2 bg-slate-200 rounded\">\n                              <div \n                                className={`h-2 rounded ${colors[level as keyof typeof colors]}`}\n                                style={{ width: `${percentage}%` }}\n                              />\n                            </div>\n                            <span className=\"text-sm font-bold text-slate-900 w-12 text-right\">\n                              {count}\n                            </span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Risk Assessment Distribution */}\n              <Card data-testid=\"card-risk-distribution\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <Shield className=\"w-5 h-5 mr-2 text-red-600\" />\n                    AI Risk Assessment\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {Object.entries(riskDistribution).map(([level, count]) => {\n                      const percentage = projects.length > 0 ? (count / projects.length) * 100 : 0;\n                      const colors = {\n                        low: 'bg-green-500',\n                        medium: 'bg-yellow-500',\n                        high: 'bg-orange-500',\n                        critical: 'bg-red-500'\n                      };\n                      \n                      return (\n                        <div key={level} className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center space-x-3\">\n                            <div className={`w-3 h-3 rounded-full ${colors[level as keyof typeof colors]}`} />\n                            <span className=\"text-sm font-medium text-slate-700 capitalize\">{level} Risk</span>\n                          </div>\n                          <div className=\"flex items-center space-x-3\">\n                            <div className=\"w-20 h-2 bg-slate-200 rounded\">\n                              <div \n                                className={`h-2 rounded ${colors[level as keyof typeof colors]}`}\n                                style={{ width: `${percentage}%` }}\n                              />\n                            </div>\n                            <span className=\"text-sm font-bold text-slate-900 w-12 text-right\">\n                              {count}\n                            </span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Project Analysis Table */}\n            <Card data-testid=\"card-project-analysis-table\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-between\">\n                  <span className=\"flex items-center\">\n                    <BarChart3 className=\"w-5 h-5 mr-2 text-slate-600\" />\n                    Project Performance Analysis\n                  </span>\n                  <Button variant=\"outline\" size=\"sm\" data-testid=\"button-export-analysis\">\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Export Analysis\n                  </Button>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {analysisData.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"overflow-x-auto\">\n                      <table className=\"w-full text-sm\">\n                        <thead>\n                          <tr className=\"border-b\">\n                            <th className=\"text-left py-2\">Project</th>\n                            <th className=\"text-left py-2\">Total Cost</th>\n                            <th className=\"text-left py-2\">Efficiency</th>\n                            <th className=\"text-left py-2\">Risk Level</th>\n                            <th className=\"text-left py-2\">Trend</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {analysisData.map((item, index) => (\n                            <tr key={index} className=\"border-b hover:bg-slate-50\">\n                              <td className=\"py-3\">\n                                <div>\n                                  <p className=\"font-medium text-slate-900\">{item?.project.name}</p>\n                                  <p className=\"text-xs text-slate-500\">{item?.project.client}</p>\n                                </div>\n                              </td>\n                              <td className=\"py-3\">\n                                <span className=\"font-medium\">\n                                  ${(item?.costAnalysis?.totalCost || 0).toLocaleString()}\n                                </span>\n                              </td>\n                              <td className=\"py-3\">\n                                <div className=\"flex items-center space-x-2\">\n                                  <span className=\"text-sm font-medium\">\n                                    {item?.costAnalysis?.overallScore || 0}/100\n                                  </span>\n                                  <Badge \n                                    variant={\n                                      item?.costAnalysis?.efficiency === 'excellent' ? 'default' :\n                                      item?.costAnalysis?.efficiency === 'good' ? 'secondary' : 'outline'\n                                    }\n                                    className=\"text-xs\"\n                                  >\n                                    {item?.costAnalysis?.efficiency}\n                                  </Badge>\n                                </div>\n                              </td>\n                              <td className=\"py-3\">\n                                <Badge \n                                  variant={\n                                    item?.riskAssessment?.riskLevel === 'low' ? 'default' :\n                                    item?.riskAssessment?.riskLevel === 'medium' ? 'secondary' :\n                                    item?.riskAssessment?.riskLevel === 'high' ? 'destructive' : 'destructive'\n                                  }\n                                  className=\"text-xs capitalize\"\n                                >\n                                  {item?.riskAssessment?.riskLevel}\n                                </Badge>\n                              </td>\n                              <td className=\"py-3\">\n                                <div className=\"flex items-center space-x-1\">\n                                  {item?.costTrends?.trendDirection === 'increasing' ? (\n                                    <TrendingUp className=\"w-4 h-4 text-red-500\" />\n                                  ) : item?.costTrends?.trendDirection === 'decreasing' ? (\n                                    <TrendingDown className=\"w-4 h-4 text-green-500\" />\n                                  ) : (\n                                    <div className=\"w-4 h-4\" />\n                                  )}\n                                  <span className=\"text-xs text-slate-500 capitalize\">\n                                    {item?.costTrends?.trendDirection || 'stable'}\n                                  </span>\n                                </div>\n                              </td>\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12\">\n                    <BarChart3 className=\"w-12 h-12 text-slate-400 mx-auto mb-4\" />\n                    <h3 className=\"text-lg font-medium text-slate-900 mb-2\">No analysis data available</h3>\n                    <p className=\"text-slate-600 mb-4\">\n                      Create projects with takeoff data to see AI-powered cost analysis and insights.\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </>\n        )}\n      </div>\n    </Layout>\n  );\n}","size_bytes":19862},"client/src/pages/settings.tsx":{"content":"import { useState } from \"react\";\nimport Layout from \"@/components/layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Settings as SettingsIcon, \n  User, \n  Bell, \n  Eye, \n  Database, \n  Zap,\n  Shield,\n  Palette,\n  Save\n} from \"lucide-react\";\n\nexport default function Settings() {\n  const { toast } = useToast();\n  const [settings, setSettings] = useState({\n    // Profile Settings\n    fullName: \"John Constructor\",\n    email: \"john@construction.com\",\n    company: \"ABC Construction LLC\",\n    phone: \"+1 (555) 123-4567\",\n    \n    // Notification Settings\n    emailNotifications: true,\n    pushNotifications: true,\n    takeoffCompleted: true,\n    projectUpdates: true,\n    \n    // Display Settings\n    theme: \"light\",\n    language: \"en\",\n    currency: \"USD\",\n    units: \"imperial\", // imperial or metric\n    \n    // AI Settings\n    autoProcessDrawings: true,\n    confidenceThreshold: 0.85,\n    aiSuggestions: true,\n    \n    // Security Settings\n    twoFactorAuth: false,\n    sessionTimeout: 30, // minutes\n  });\n\n  const handleSave = () => {\n    // In a real app, this would save to the backend\n    toast({\n      title: \"Settings Saved\",\n      description: \"Your preferences have been updated successfully.\",\n    });\n  };\n\n  const handleReset = () => {\n    // Reset to defaults\n    setSettings({\n      fullName: \"John Constructor\",\n      email: \"john@construction.com\", \n      company: \"ABC Construction LLC\",\n      phone: \"+1 (555) 123-4567\",\n      emailNotifications: true,\n      pushNotifications: true,\n      takeoffCompleted: true,\n      projectUpdates: true,\n      theme: \"light\",\n      language: \"en\",\n      currency: \"USD\",\n      units: \"imperial\",\n      autoProcessDrawings: true,\n      confidenceThreshold: 0.85,\n      aiSuggestions: true,\n      twoFactorAuth: false,\n      sessionTimeout: 30,\n    });\n    \n    toast({\n      title: \"Settings Reset\",\n      description: \"All settings have been reset to defaults.\",\n    });\n  };\n\n  return (\n    <Layout>\n      <div className=\"bg-white border-b border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900 flex items-center gap-2\">\n              <SettingsIcon className=\"w-6 h-6\" />\n              Settings\n            </h1>\n            <p className=\"text-slate-600 mt-1\">Manage your account preferences and application settings</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handleReset}>\n              Reset to Defaults\n            </Button>\n            <Button onClick={handleSave} className=\"bg-blueprint-600 hover:bg-blueprint-700\">\n              <Save className=\"w-4 h-4 mr-2\" />\n              Save Changes\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 max-w-6xl\">\n          \n          {/* Catalog Management */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"w-5 h-5\" />\n                Product Catalog\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"text-sm text-slate-600\">\n                Manage your product SKUs, trade classes, and pricing information.\n              </p>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div className=\"p-3 bg-slate-50 rounded-lg\">\n                  <p className=\"font-medium text-slate-900\">Trade Classes</p>\n                  <p className=\"text-slate-500\">8 classes configured</p>\n                </div>\n                <div className=\"p-3 bg-slate-50 rounded-lg\">\n                  <p className=\"font-medium text-slate-900\">Product SKUs</p>\n                  <p className=\"text-slate-500\">156+ items available</p>\n                </div>\n              </div>\n              <div className=\"text-xs text-slate-500 bg-blue-50 p-3 rounded-lg\">\n                <strong>Note:</strong> Catalog management is now integrated into individual projects. \n                Access pricing and SKU management through the \"Pricing\" and \"SKUs\" tabs in any project detail page.\n              </div>\n            </CardContent>\n          </Card>\n          \n          {/* Profile Settings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <User className=\"w-5 h-5\" />\n                Profile Information\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"fullName\">Full Name</Label>\n                <Input\n                  id=\"fullName\"\n                  value={settings.fullName}\n                  onChange={(e) => setSettings({...settings, fullName: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"email\">Email Address</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={settings.email}\n                  onChange={(e) => setSettings({...settings, email: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"company\">Company</Label>\n                <Input\n                  id=\"company\"\n                  value={settings.company}\n                  onChange={(e) => setSettings({...settings, company: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"phone\">Phone Number</Label>\n                <Input\n                  id=\"phone\"\n                  value={settings.phone}\n                  onChange={(e) => setSettings({...settings, phone: e.target.value})}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Notification Settings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Bell className=\"w-5 h-5\" />\n                Notifications\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>Email Notifications</Label>\n                  <p className=\"text-sm text-muted-foreground\">Receive updates via email</p>\n                </div>\n                <Switch\n                  checked={settings.emailNotifications}\n                  onCheckedChange={(checked) => setSettings({...settings, emailNotifications: checked})}\n                />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>Push Notifications</Label>\n                  <p className=\"text-sm text-muted-foreground\">Browser push notifications</p>\n                </div>\n                <Switch\n                  checked={settings.pushNotifications}\n                  onCheckedChange={(checked) => setSettings({...settings, pushNotifications: checked})}\n                />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>Takeoff Completed</Label>\n                  <p className=\"text-sm text-muted-foreground\">When AI processing finishes</p>\n                </div>\n                <Switch\n                  checked={settings.takeoffCompleted}\n                  onCheckedChange={(checked) => setSettings({...settings, takeoffCompleted: checked})}\n                />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>Project Updates</Label>\n                  <p className=\"text-sm text-muted-foreground\">Changes to your projects</p>\n                </div>\n                <Switch\n                  checked={settings.projectUpdates}\n                  onCheckedChange={(checked) => setSettings({...settings, projectUpdates: checked})}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Display Settings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Eye className=\"w-5 h-5\" />\n                Display & Preferences\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <Label>Theme</Label>\n                <Select value={settings.theme} onValueChange={(value) => setSettings({...settings, theme: value})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"light\">Light</SelectItem>\n                    <SelectItem value=\"dark\">Dark</SelectItem>\n                    <SelectItem value=\"system\">System</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Language</Label>\n                <Select value={settings.language} onValueChange={(value) => setSettings({...settings, language: value})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"en\">English</SelectItem>\n                    <SelectItem value=\"es\">Spanish</SelectItem>\n                    <SelectItem value=\"fr\">French</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Currency</Label>\n                <Select value={settings.currency} onValueChange={(value) => setSettings({...settings, currency: value})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"USD\">USD ($)</SelectItem>\n                    <SelectItem value=\"CAD\">CAD ($)</SelectItem>\n                    <SelectItem value=\"EUR\">EUR (â‚¬)</SelectItem>\n                    <SelectItem value=\"GBP\">GBP (Â£)</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Units</Label>\n                <Select value={settings.units} onValueChange={(value) => setSettings({...settings, units: value})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"imperial\">Imperial (ft, in)</SelectItem>\n                    <SelectItem value=\"metric\">Metric (m, cm)</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* AI & Processing Settings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Zap className=\"w-5 h-5\" />\n                AI & Processing\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>Auto-Process Drawings</Label>\n                  <p className=\"text-sm text-muted-foreground\">Automatically start AI processing on upload</p>\n                </div>\n                <Switch\n                  checked={settings.autoProcessDrawings}\n                  onCheckedChange={(checked) => setSettings({...settings, autoProcessDrawings: checked})}\n                />\n              </div>\n              <Separator />\n              <div>\n                <Label>AI Confidence Threshold</Label>\n                <p className=\"text-sm text-muted-foreground mb-2\">Minimum confidence for AI detections (0.1 - 1.0)</p>\n                <Input\n                  type=\"number\"\n                  min=\"0.1\"\n                  max=\"1.0\"\n                  step=\"0.05\"\n                  value={settings.confidenceThreshold}\n                  onChange={(e) => setSettings({...settings, confidenceThreshold: parseFloat(e.target.value)})}\n                />\n              </div>\n              <Separator />\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label>AI Suggestions</Label>\n                  <p className=\"text-sm text-muted-foreground\">Show AI-powered cost optimization tips</p>\n                </div>\n                <Switch\n                  checked={settings.aiSuggestions}\n                  onCheckedChange={(checked) => setSettings({...settings, aiSuggestions: checked})}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Security Settings */}\n          <Card className=\"lg:col-span-2\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Shield className=\"w-5 h-5\" />\n                Security & Privacy\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label>Two-Factor Authentication</Label>\n                    <p className=\"text-sm text-muted-foreground\">Add extra security to your account</p>\n                  </div>\n                  <Switch\n                    checked={settings.twoFactorAuth}\n                    onCheckedChange={(checked) => setSettings({...settings, twoFactorAuth: checked})}\n                  />\n                </div>\n                <div>\n                  <Label>Session Timeout (minutes)</Label>\n                  <p className=\"text-sm text-muted-foreground mb-2\">Auto-logout after inactivity</p>\n                  <Select \n                    value={settings.sessionTimeout.toString()} \n                    onValueChange={(value) => setSettings({...settings, sessionTimeout: parseInt(value)})}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"15\">15 minutes</SelectItem>\n                      <SelectItem value=\"30\">30 minutes</SelectItem>\n                      <SelectItem value=\"60\">1 hour</SelectItem>\n                      <SelectItem value=\"120\">2 hours</SelectItem>\n                      <SelectItem value=\"0\">Never</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n        </div>\n      </div>\n    </Layout>\n  );\n}","size_bytes":15508},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"import * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-slate-100\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-purple-600 transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }","size_bytes":779},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209}},"version":1}